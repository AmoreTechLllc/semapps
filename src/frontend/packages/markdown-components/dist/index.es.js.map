{"version":3,"file":"index.es.js","sources":["../src/MarkdownField.js","../src/MarkdownInput.js","../src/useLoadLinks.js"],"sourcesContent":["import React from 'react';\nimport { LargeLabel } from '@semapps/archipelago-layout';\nimport Markdown from 'markdown-to-jsx';\n\nconst MarkdownField = ({ source, record, overrides = {}, ...rest }) =>\n  record && record[source] ? (\n    <Markdown\n      options={{\n        createElement(type, props, children) {\n          if (props.label) {\n            return (\n              <>\n                <LargeLabel>{props.label}</LargeLabel>\n                {React.createElement(type, props, children)}\n              </>\n            );\n          } else {\n            return React.createElement(type, props, children);\n          }\n        },\n        overrides: {\n          h1: LargeLabel,\n          ...overrides\n        },\n        ...rest\n      }}\n    >\n      {record[source]}\n    </Markdown>\n  ) : null;\n\nMarkdownField.defaultProps = {\n  addLabel: true\n};\n\nexport default MarkdownField;\n","import React, { useState } from 'react';\nimport ReactMde from 'react-mde';\nimport Markdown from 'markdown-to-jsx';\nimport { useInput, InputHelperText, Labeled, required } from 'react-admin';\nimport { FormControl, FormHelperText, makeStyles } from '@material-ui/core';\n\nconst useStyles = makeStyles(theme => ({\n  validationRequired: {\n    '& .MuiFormLabel-root': {\n      color: '#f44336',\n    },\n    '& .mde-text': {\n      outline: '-webkit-focus-ring-color auto 1px',\n      outlineOffset: 0,\n      outlineColor: '#f44336',\n      outlineStyle: 'auto',\n      outlineWidth: 1\n    }\n  },\n}));\n\nconst MarkdownInput = props => {\n  const classes = useStyles();\n  const { validate } = props;\n  const [tab, setTab] = useState('write');\n  const {\n    input: { value, onChange, onBlur },\n    meta: { error, touched }\n  } = useInput(props);\n\n  return (\n    <FormControl fullWidth className={`ra-input-mde ${((error==='ra.validation.required') ? classes.validationRequired : '')}`} >\n      <Labeled {...props} isRequired={validate.toString()!==required.toString()} >\n        <ReactMde\n          value={value}\n          onChange={value => onChange(value)}\n          onTabChange={tab => setTab(tab)}\n          generateMarkdownPreview={async markdown => <Markdown>{markdown}</Markdown>}\n          selectedTab={tab}\n          childProps={{\n            textArea: {onBlur: ()=>onBlur()} \n          }}\n          {...props}\n        />\n      </Labeled>\n      <FormHelperText error={!!error} margin=\"dense\" variant=\"outlined\">\n        <InputHelperText error={error} helperText={props.helperText} touched={error||touched} />\n      </FormHelperText>\n    </FormControl>\n  );\n};\n\nexport default MarkdownInput;\n","import { useDataProvider, useTranslate } from 'react-admin';\n\nconst useLoadLinks = (resourceType, labelProp) => {\n  const dataProvider = useDataProvider();\n  const translate = useTranslate();\n  return async keyword => {\n    if (keyword) {\n      const results = await dataProvider.getList(resourceType, {\n        pagination: {\n          page: 1,\n          perPage: 5\n        },\n        filter: { q: keyword }\n      });\n      if (results.total > 0) {\n        return results.data.map(record => ({\n          preview: record[labelProp],\n          value: `[${record[labelProp]}](/${resourceType}/${encodeURIComponent(record.id)}/show)`\n        }));\n      } else {\n        return [{ preview: translate('ra.navigation.no_results'), value: '[' + keyword }];\n      }\n    }\n    return [{ preview: translate('ra.action.search'), value: '[' + keyword }];\n  };\n};\n\nexport default useLoadLinks;\n"],"names":["MarkdownField","source","record","overrides","rest","React","Markdown","options","createElement","type","props","children","label","LargeLabel","h1","defaultProps","addLabel","useStyles","makeStyles","theme","validationRequired","color","outline","outlineOffset","outlineColor","outlineStyle","outlineWidth","MarkdownInput","classes","validate","useState","tab","setTab","useInput","input","value","onChange","onBlur","meta","error","touched","FormControl","fullWidth","className","Labeled","isRequired","toString","required","ReactMde","onTabChange","generateMarkdownPreview","markdown","selectedTab","childProps","textArea","FormHelperText","margin","variant","InputHelperText","helperText","useLoadLinks","resourceType","labelProp","dataProvider","useDataProvider","translate","useTranslate","keyword","getList","pagination","page","perPage","filter","q","results","total","data","map","preview","encodeURIComponent","id"],"mappings":"m5FAIMA,EAAgB,gBAAGC,IAAAA,OAAQC,IAAAA,WAAQC,UAAAA,aAAY,KAAOC,gBAC1DF,GAAUA,EAAOD,GACfI,gBAACC,GACCC,WACEC,uBAAcC,EAAMC,EAAOC,UACrBD,EAAME,MAENP,gCACEA,gBAACQ,OAAYH,EAAME,OAClBP,EAAMG,cAAcC,EAAMC,EAAOC,IAI/BN,EAAMG,cAAcC,EAAMC,EAAOC,IAG5CR,aACEW,GAAID,GACDV,IAEFC,IAGJF,EAAOD,IAER,MAEND,EAAce,aAAe,CAC3BC,UAAU,GC1BZ,IAAMC,EAAYC,GAAW,SAAAC,SAAU,CACrCC,mBAAoB,wBACM,CACtBC,MAAO,yBAEM,CACbC,QAAS,oCACTC,cAAe,EACfC,aAAc,UACdC,aAAc,OACdC,aAAc,QAKdC,EAAgB,SAAAjB,OACdkB,EAAUX,IACRY,EAAanB,EAAbmB,aACcC,EAAS,YAAxBC,OAAKC,SAIRC,EAASvB,OAFXwB,MAASC,IAAAA,MAAOC,IAAAA,SAAUC,IAAAA,WAC1BC,KAAQC,IAAAA,MAAOC,IAAAA,eAIfnC,gBAACoC,GAAYC,aAAUC,iCAAqC,2BAARJ,EAAoCX,EAAQR,mBAAqB,KACnHf,gBAACuC,OAAYlC,GAAOmC,WAAYhB,EAASiB,aAAaC,EAASD,aAC7DzC,gBAAC2C,KACCb,MAAOA,EACPC,SAAU,SAAAD,UAASC,EAASD,IAC5Bc,YAAa,SAAAlB,UAAOC,EAAOD,IAC3BmB,oEAAyB,WAAMC,4GAAY9C,gBAACC,OAAU6C,qGACtDC,YAAarB,EACbsB,WAAY,CACVC,SAAU,CAACjB,OAAQ,kBAAIA,QAErB3B,KAGRL,gBAACkD,GAAehB,QAASA,EAAOiB,OAAO,QAAQC,QAAQ,YACrDpD,gBAACqD,GAAgBnB,MAAOA,EAAOoB,WAAYjD,EAAMiD,WAAYnB,QAASD,GAAOC,OC5C/EoB,EAAe,SAACC,EAAcC,OAC5BC,EAAeC,IACfC,EAAYC,uDACX,WAAMC,6FACPA,kCACoBJ,EAAaK,QAAQP,EAAc,CACvDQ,WAAY,CACVC,KAAM,EACNC,QAAS,GAEXC,OAAQ,CAAEC,EAAGN,kBALTO,UAOMC,MAAQ,4CACXD,EAAQE,KAAKC,KAAI,SAAA3E,SAAW,CACjC4E,QAAS5E,EAAO4D,GAChB3B,iBAAWjC,EAAO4D,iBAAgBD,cAAgBkB,mBAAmB7E,EAAO8E,mDAGvE,CAAC,CAAEF,QAASb,EAAU,4BAA6B9B,MAAO,IAAMgC,qCAGpE,CAAC,CAAEW,QAASb,EAAU,oBAAqB9B,MAAO,IAAMgC"}