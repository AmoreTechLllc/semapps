{"version":3,"file":"index.cjs.js","sources":["../src/MarkdownField.js","../src/MarkdownInput.js","../src/useLoadLinks.js"],"sourcesContent":["import React from 'react';\nimport Markdown from 'markdown-to-jsx';\n\nconst MarkdownField = ({ source, record, LabelComponent, overrides = {}, ...rest }) =>\n  record && record[source] ? (\n    <Markdown\n      options={{\n        createElement(type, props, children) {\n          if (props.label) {\n            return (\n              <>\n                <LabelComponent>{props.label}</LabelComponent>\n                {React.createElement(type, props, children)}\n              </>\n            );\n          } else {\n            return React.createElement(type, props, children);\n          }\n        },\n        overrides: {\n          h1: LabelComponent,\n          ...overrides\n        },\n        ...rest\n      }}\n    >\n      {record[source]}\n    </Markdown>\n  ) : null;\n\nMarkdownField.defaultProps = {\n  LabelComponent: 'h2'\n};\n\nexport default MarkdownField;\n","import React, { useMemo, useState } from 'react';\nimport ReactMde from 'react-mde';\nimport Markdown from 'markdown-to-jsx';\nimport { useInput, InputHelperText, Labeled, required, useTheme } from 'react-admin';\nimport { FormControl, FormHelperText } from '@mui/material';\nimport { styled } from '@mui/system';\n\nconst StyledFormControl = styled(FormControl)(() => {\n  const [theme] = useTheme();  \n  return ({\n    color: 'blue',\n    '&.validationError': {\n      '& p': {\n        color: theme.palette.error.main\n      },\n      '& .mde-text': {\n        outline: '-webkit-focus-ring-color auto 1px',\n        outlineOffset: 0,\n        outlineColor: theme.palette.error.main,\n        outlineStyle: 'auto',\n        outlineWidth: 1\n      },\n      '& p.MuiFormHelperText-root': {\n        color: theme.palette.error.main\n      }\n    }\n})});\n\nconst MarkdownInput = props => {\n  const { validate } = props;\n  const isRequired = useMemo(\n    () => !!validate && !![].concat(validate).find(v => v.toString() === required().toString()),\n    [validate]\n  );\n  const [tab, setTab] = useState('write');\n  const {\n    field: { value, onChange },\n    fieldState: { isDirty, invalid, error, isTouched }\n  } = useInput(props);\n\n  return (\n    <StyledFormControl fullWidth className={`ra-input-mde ${ invalid ? 'validationError' : ''}`}>\n      <Labeled {...props} isRequired={isRequired}>\n        <ReactMde\n          value={value}\n          onChange={value => onChange(value)}\n          onTabChange={tab => setTab(tab)}\n          generateMarkdownPreview={async markdown => <Markdown>{markdown}</Markdown>}\n          selectedTab={tab}\n          {...props}\n        />\n      </Labeled>\n      <FormHelperText error={isDirty && invalid} margin=\"dense\" variant=\"outlined\">\n        <InputHelperText error={isDirty && invalid && error} helperText={props.helperText} touched={error || isTouched} />\n      </FormHelperText>\n    </StyledFormControl>\n  );\n};\n\nexport default MarkdownInput;\n","import { useDataProvider, useTranslate } from 'react-admin';\n\nconst useLoadLinks = (resourceType, labelProp) => {\n  const dataProvider = useDataProvider();\n  const translate = useTranslate();\n  return async keyword => {\n    if (keyword) {\n      const results = await dataProvider.getList(resourceType, {\n        pagination: {\n          page: 1,\n          perPage: 5\n        },\n        filter: { q: keyword }\n      });\n      if (results.total > 0) {\n        return results.data.map(record => ({\n          preview: record[labelProp],\n          value: `[${record[labelProp]}](/${resourceType}/${encodeURIComponent(record.id)}/show)`\n        }));\n      } else {\n        return [{ preview: translate('ra.navigation.no_results'), value: '[' + keyword }];\n      }\n    }\n    return [{ preview: translate('ra.action.search'), value: '[' + keyword }];\n  };\n};\n\nexport default useLoadLinks;\n"],"names":["MarkdownField","_ref","source","record","LabelComponent","_ref$overrides","overrides","rest","_objectWithoutProperties","_excluded","React","Markdown","options","_objectSpread","createElement","type","props","children","label","h1","defaultProps","StyledFormControl","styled","FormControl","theme","_slicedToArray","useTheme","color","&.validationError","& p","palette","error","main","& .mde-text","outline","outlineOffset","outlineColor","outlineStyle","outlineWidth","& p.MuiFormHelperText-root","validate","isRequired","useMemo","concat","find","v","toString","required","_useState2","useState","tab","setTab","useInput","_useInput$field","_useInput","field","value","onChange","_useInput$fieldState","fieldState","isDirty","invalid","isTouched","fullWidth","className","Labeled","_extends","ReactMde","onTabChange","generateMarkdownPreview","_asyncToGenerator","_regeneratorRuntime","mark","markdown","wrap","_context","prev","next","abrupt","stop","_callee","_x","apply","this","arguments","selectedTab","FormHelperText","margin","variant","InputHelperText","helperText","touched","resourceType","labelProp","dataProvider","useDataProvider","translate","useTranslate","keyword","results","getList","pagination","page","perPage","filter","q","sent","total","data","map","preview","encodeURIComponent","id"],"mappings":"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"}