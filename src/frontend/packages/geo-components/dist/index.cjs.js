"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("react-admin"),n=require("@material-ui/core"),r=require("@material-ui/lab/Autocomplete"),o=require("@material-ui/icons/LocationOn"),a=require("react-router"),u=require("@material-ui/core/CircularProgress"),l=require("react-dom"),i=require("leaflet");require("leaflet.markercluster");var s=require("@material-ui/icons/Close");function c(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var f=c(e),p=c(r),d=c(o),b=c(u),m=c(i),h=c(s),g=function(e){var r=e.record,o=e.basePath,a=t.useResourceDefinition({});return f.default.createElement(f.default.Fragment,null,r.label&&f.default.createElement(n.Typography,{variant:"h5"},r.label),r.description&&f.default.createElement(n.Typography,null,r.description.length>150?r.description.substring(0,150)+"...":r.description),a.hasShow&&f.default.createElement(t.ShowButton,{basePath:o,record:r}),a.hasEdit&&f.default.createElement(t.EditButton,{basePath:o,record:r}))};function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(){return(x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function E(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,a=[],u=!0,l=!1;try{for(n=n.call(e);!(u=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{u||null==n.return||n.return()}finally{if(l)throw o}}return a}(e,t)||C(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e){return function(e){if(Array.isArray(e))return P(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||C(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){if(e){if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(e,t):void 0}}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var S="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function L(e,t){return e(t={exports:{}},t.exports),t.exports}var I=L((function(e){
// @license MIT
!function(t,n){e.exports?e.exports=n():this.Diacritics=n()}(0,(function(){for(var e={map:{}},t=[{base:" ",letters:" "},{base:"A",letters:"AⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",letters:"Ꜳ"},{base:"AE",letters:"ÆǼǢ"},{base:"AO",letters:"Ꜵ"},{base:"AU",letters:"Ꜷ"},{base:"AV",letters:"ꜸꜺ"},{base:"AY",letters:"Ꜽ"},{base:"B",letters:"BⒷＢḂḄḆɃƂƁ"},{base:"C",letters:"CⒸＣĆĈĊČÇḈƇȻꜾ"},{base:"D",letters:"DⒹＤḊĎḌḐḒḎĐƋƊƉꝹ"},{base:"DZ",letters:"ǱǄ"},{base:"Dz",letters:"ǲǅ"},{base:"E",letters:"EⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎ"},{base:"F",letters:"FⒻＦḞƑꝻ"},{base:"G",letters:"GⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾ"},{base:"H",letters:"HⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",letters:"IⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",letters:"JⒿＪĴɈ"},{base:"K",letters:"KⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",letters:"LⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",letters:"Ǉ"},{base:"Lj",letters:"ǈ"},{base:"M",letters:"MⓂＭḾṀṂⱮƜ"},{base:"N",letters:"NⓃＮǸŃÑṄŇṆŅṊṈȠƝꞐꞤ"},{base:"NJ",letters:"Ǌ"},{base:"Nj",letters:"ǋ"},{base:"O",letters:"OⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OI",letters:"Ƣ"},{base:"OO",letters:"Ꝏ"},{base:"OU",letters:"Ȣ"},{base:"P",letters:"PⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",letters:"QⓆＱꝖꝘɊ"},{base:"R",letters:"RⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",letters:"SⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",letters:"TⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"Th",letters:"Þ"},{base:"TZ",letters:"Ꜩ"},{base:"U",letters:"UⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",letters:"VⓋＶṼṾƲꝞɅ"},{base:"VY",letters:"Ꝡ"},{base:"W",letters:"WⓌＷẀẂŴẆẄẈⱲ"},{base:"X",letters:"XⓍＸẊẌ"},{base:"Y",letters:"YⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",letters:"ZⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",letters:"aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐɑ"},{base:"aa",letters:"ꜳ"},{base:"ae",letters:"æǽǣ"},{base:"ao",letters:"ꜵ"},{base:"au",letters:"ꜷ"},{base:"av",letters:"ꜹꜻ"},{base:"ay",letters:"ꜽ"},{base:"b",letters:"bⓑｂḃḅḇƀƃɓ"},{base:"c",letters:"cⓒｃćĉċčçḉƈȼꜿↄ"},{base:"d",letters:"dⓓｄḋďḍḑḓḏđƌɖɗꝺ"},{base:"dz",letters:"ǳǆ"},{base:"e",letters:"eⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇɛǝ"},{base:"f",letters:"fⓕｆḟƒꝼ"},{base:"ff",letters:"ﬀ"},{base:"fi",letters:"ﬁ"},{base:"fl",letters:"ﬂ"},{base:"ffi",letters:"ﬃ"},{base:"ffl",letters:"ﬄ"},{base:"g",letters:"gⓖｇǵĝḡğġǧģǥɠꞡᵹꝿ"},{base:"h",letters:"hⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",letters:"ƕ"},{base:"i",letters:"iⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",letters:"jⓙｊĵǰɉ"},{base:"k",letters:"kⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",letters:"lⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇ"},{base:"lj",letters:"ǉ"},{base:"m",letters:"mⓜｍḿṁṃɱɯ"},{base:"n",letters:"nñnⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥлԉ"},{base:"nj",letters:"ǌ"},{base:"o",letters:"߀oⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿɔꝋꝍɵ"},{base:"oe",letters:"Œœ"},{base:"oi",letters:"ƣ"},{base:"ou",letters:"ȣ"},{base:"oo",letters:"ꝏ"},{base:"p",letters:"pⓟｐṕṗƥᵽꝑꝓꝕ"},{base:"q",letters:"qⓠｑɋꝗꝙ"},{base:"r",letters:"rⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",letters:"sⓢｓßśṥŝṡšṧṣṩșşȿꞩꞅẛ"},{base:"ss",letters:"ß"},{base:"t",letters:"tⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"th",letters:"þ"},{base:"tz",letters:"ꜩ"},{base:"u",letters:"uⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",letters:"vⓥｖṽṿʋꝟʌ"},{base:"vy",letters:"ꝡ"},{base:"w",letters:"wⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",letters:"xⓧｘẋẍ"},{base:"y",letters:"yⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",letters:"zⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],n=0,r=t.length;n<r;n++)for(var o=t[n].letters.split(""),a=0,u=o.length;a<u;a++)e.map[o[a]]=t[n].base;return e.clean=function(t){if(!t||!t.length||t.length<1)return"";for(var n,r="",o=t.split(""),a=0,u=o.length;a<u;a++)r+=(n=o[a])in e.map?e.map[n]:n;return r},e}))})).clean,T=/[.*+?^${}()|[\]\\]/g,A=/[a-z0-9_]/i,z=/\s+/;var k=function(e,t,n){var r,o;return o={insideWords:!1,findAllOccurrences:!1,requireMatchAll:!1},r=(r=n)||{},Object.keys(r).forEach((function(e){o[e]=!!r[e]})),n=o,e=I(e),(t=I(t)).trim().split(z).filter((function(e){return e.length>0})).reduce((function(t,r){var o,a,u=r.length,l=!n.insideWords&&A.test(r[0])?"\\b":"",i=new RegExp(l+r.replace(T,"\\$&"),"i");if(o=i.exec(e),n.requireMatchAll&&null===o)return e="",[];for(;o&&(a=o.index,t.push([a,a+u]),e=e.slice(0,a)+new Array(u+1).join(" ")+e.slice(a+u),n.findAllOccurrences);)o=i.exec(e);return t}),[]).sort((function(e,t){return e[0]-t[0]}))},M=/^\s+|\s+$/g,R=/^[-+]0x[0-9a-f]+$/i,N=/^0b[01]+$/i,_=/^0o[0-7]+$/i,D=parseInt,B="object"==typeof S&&S&&S.Object===Object&&S,H="object"==typeof self&&self&&self.Object===Object&&self,q=B||H||Function("return this")(),F=Object.prototype.toString,U=Math.max,W=Math.min,Z=function(){return q.Date.now()};function $(e,t,n){var r,o,a,u,l,i,s=0,c=!1,f=!1,p=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function d(t){var n=r,a=o;return r=o=void 0,s=t,u=e.apply(a,n)}function b(e){return s=e,l=setTimeout(h,t),c?d(e):u}function m(e){var n=e-i;return void 0===i||n>=t||n<0||f&&e-s>=a}function h(){var e=Z();if(m(e))return g(e);l=setTimeout(h,function(e){var n=t-(e-i);return f?W(n,a-(e-s)):n}(e))}function g(e){return l=void 0,p&&r?d(e):(r=o=void 0,u)}function y(){var e=Z(),n=m(e);if(r=arguments,o=this,i=e,n){if(void 0===l)return b(i);if(f)return l=setTimeout(h,t),d(i)}return void 0===l&&(l=setTimeout(h,t)),u}return t=V(t)||0,G(n)&&(c=!!n.leading,a=(f="maxWait"in n)?U(V(n.maxWait)||0,t):a,p="trailing"in n?!!n.trailing:p),y.cancel=function(){void 0!==l&&clearTimeout(l),s=0,r=i=o=l=void 0},y.flush=function(){return void 0===l?u:g(Z())},y}function G(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function V(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==F.call(e)}(e))return NaN;if(G(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=G(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(M,"");var n=N.test(e);return n||_.test(e)?D(e.slice(2),n?2:8):R.test(e)?NaN:+e}var J=function(e,t,n){var r=!0,o=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return G(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),$(e,t,{leading:r,maxWait:t,trailing:o})},Q=["mapboxConfig","record","resource","source","label","basePath","parse","optionText","helperText"],Y=n.makeStyles((function(e){return{icon:{color:e.palette.text.secondary,marginRight:e.spacing(2)}}})),X=function(e,t){return e.place_name?e.place_name:"string"==typeof t?e[t]:"function"==typeof t?t(e):void 0},K=function(r){var o=r.mapboxConfig;r.record;var a=r.resource,u=r.source,l=r.label;r.basePath;var i=r.parse,s=r.optionText,c=r.helperText,b=E(r,Q);if(!o)throw new Error("@semapps/geo-components : No mapbox configuration");if(!o.access_token)throw new Error("@semapps/geo-components : No access token in mapbox configuration");var m=Y(),h=t.useLocale(),g=t.useTranslate(),y=w(e.useState(""),2),O=y[0],C=y[1],P=w(e.useState([]),2),S=P[0],L=P[1],I=t.useInput(v({resource:a,source:u},b)),T=I.input,A=T.value,z=T.onChange,M=T.onBlur,R=T.onFocus,N=I.isRequired,_=I.meta,D=_.error,B=_.submitError,H=_.touched,q=e.useMemo((function(){return J((function(e,t){var n=new URL("https://api.mapbox.com/geocoding/v5/mapbox.places/".concat(e,".json"));o.language||(o.language=h),Object.entries(o).forEach((function(e){var t=w(e,2),r=t[0],o=t[1];Array.isArray(o)?o=o.join(","):"boolean"==typeof o&&(o=o?"true":"false"),n.searchParams.set(r,o)})),fetch(n.toString()).then((function(e){return e.json()})).then((function(e){return t(e)}))}),200)}),[o,h]);return e.useEffect((function(){O&&O!==X(A,s)&&q(O,(function(e){return L(e.features)}))}),[A,O,q]),f.default.createElement(p.default,{autoComplete:!0,value:A||null,options:A?[A].concat(j(S)):S,filterSelectedOptions:!0,filterOptions:function(e){return e},getOptionLabel:function(e){return X(e,s)},getOptionSelected:function(e,t){return X(e,s)===X(t,s)},onChange:function(e,t){t&&i&&(t=i(t)),z(t),L([])},onInputChange:function(e,t){return C(t)},noOptionsText:g("ra.navigation.no_results"),renderInput:function(e){return e.inputProps.autoComplete="new-password",f.default.createElement(n.TextField,x({},e,{inputProps:v(v({},e.inputProps),{},{onBlur:function(t){M(t),e.inputProps.onBlur&&e.inputProps.onBlur(t)},onFocus:function(t){R(t),e.inputProps.onFocus&&e.inputProps.onFocus(t)}}),label:""!==l&&!1!==l&&f.default.createElement(t.FieldTitle,{label:l,source:u,resource:a,isRequired:N}),error:!(!H||!D&&!B),helperText:f.default.createElement(t.InputHelperText,{touched:H,error:D||B,helperText:c})},b))},renderOption:function(e){var t=k(e.text,O),r=function(e,t){var n=[];return 0===t.length?n.push({text:e,highlight:!1}):t[0][0]>0&&n.push({text:e.slice(0,t[0][0]),highlight:!1}),t.forEach((function(r,o){var a=r[0],u=r[1];n.push({text:e.slice(a,u),highlight:!0}),o===t.length-1?u<e.length&&n.push({text:e.slice(u,e.length),highlight:!1}):u<t[o+1][0]&&n.push({text:e.slice(u,t[o+1][0]),highlight:!1})})),n}(e.text,t);return f.default.createElement(n.Grid,{container:!0,alignItems:"center"},f.default.createElement(n.Grid,{item:!0},f.default.createElement(d.default,{className:m.icon})),f.default.createElement(n.Grid,{item:!0,xs:!0},"string"==typeof r?r:r.map((function(e,t){return f.default.createElement("span",{key:t,style:{fontWeight:e.highlight?700:400}},e.text)})),f.default.createElement(n.Typography,{variant:"body2",color:"textSecondary"},e.place_name)))}})};function ee(t,n){const r=e.useRef(n);e.useEffect((function(){n!==r.current&&null!=t.attributionControl&&(null!=r.current&&t.attributionControl.removeAttribution(r.current),null!=n&&t.attributionControl.addAttribution(n)),r.current=n}),[t,n])}K.defaultProps={variant:"filled",margin:"dense"};const te=e.createContext(null),ne=te.Provider;function re(){const t=e.useContext(te);if(null==t)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return t}function oe(t){function n(n,r){const{instance:o,context:a}=t(n).current;return e.useImperativeHandle(r,()=>o),null==n.children?null:f.default.createElement(ne,{value:a},n.children)}return e.forwardRef(n)}function ae(t){function n(n,r){const[o,a]=e.useState(!1),{instance:u}=t(n,a).current;e.useImperativeHandle(r,()=>u),e.useEffect((function(){o&&u.update()}),[u,o,n.children]);const i=u._contentNode;return i?l.createPortal(n.children,i):null}return e.forwardRef(n)}function ue(t){function n(n,r){const{instance:o}=t(n).current;return e.useImperativeHandle(r,()=>o),null}return e.forwardRef(n)}function le(t){return function(n){const r=re(),o=t(n,r),{instance:a}=o.current,u=e.useRef(n.position),{position:l}=n;return e.useEffect((function(){return a.addTo(r.map),function(){a.remove()}}),[r.map,a]),e.useEffect((function(){null!=l&&l!==u.current&&(a.setPosition(l),u.current=l)}),[a,l]),o}}function ie(t,n){const r=e.useRef();e.useEffect((function(){return null!=n&&t.instance.on(n),r.current=n,function(){null!=r.current&&t.instance.off(r.current),r.current=null}}),[t,n])}function se(e,t){const n=e.pane??t.pane;return n?{...e,pane:n}:e}function ce(e,t){return function(n,r){const o=re(),a=e(se(n,o),o);return ee(o.map,n.attribution),ie(a.current,n.eventHandlers),t(a.current,o,n,r),a}}function fe(e){return e.split(" ").filter(Boolean)}function pe(e,t){fe(t).forEach(t=>{i.DomUtil.addClass(e,t)})}function de(e,t){fe(t).forEach(t=>{i.DomUtil.removeClass(e,t)})}function be(t,n){return null==n?function(n,r){return e.useRef(t(n,r))}:function(r,o){const a=e.useRef(t(r,o)),u=e.useRef(r),{instance:l}=a.current;return e.useEffect((function(){u.current!==r&&(n(l,r,u.current),u.current=r)}),[l,r,o]),a}}function me(t,n){e.useEffect((function(){return(n.layerContainer??n.map).addLayer(t.instance),function(){var e;null==(e=n.layerContainer)||e.removeLayer(t.instance),n.map.removeLayer(t.instance)}}),[n,t])}function he(e){return function(t){const n=re(),r=e(se(t,n),n);return ee(n.map,t.attribution),ie(r.current,t.eventHandlers),me(r.current,n),r}}function ge(t,n){const r=e.useRef();e.useEffect((function(){if(n.pathOptions!==r.current){const e=n.pathOptions??{};t.instance.setStyle(e),r.current=e}}),[t,n])}function ye(e){return function(t){const n=re(),r=e(se(t,n),n);return ie(r.current,t.eventHandlers),me(r.current,n),ge(r.current,t),r}}function ve(e,t){return oe(he(be(e,t)))}function Oe(e,t){return ae(ce(be(e),t))}function xe(e,t){return oe(ye(be(e,t)))}function Ee(e,t){return ue(he(be(e,t)))}function we(e,t,n){const{opacity:r,zIndex:o}=t;null!=r&&r!==n.opacity&&e.setOpacity(r),null!=o&&o!==n.zIndex&&e.setZIndex(o)}var je=Object.freeze({__proto__:null,useAttribution:ee,updateCircle:function(e,t,n){t.center!==n.center&&e.setLatLng(t.center),null!=t.radius&&t.radius!==n.radius&&e.setRadius(t.radius)},createContainerComponent:oe,createDivOverlayComponent:ae,createLeafComponent:ue,CONTEXT_VERSION:1,LeafletContext:te,LeafletProvider:ne,useLeafletContext:re,createControlHook:le,createDivOverlayHook:ce,addClassName:pe,removeClassName:de,updateClassName:function(e,t,n){null!=e&&n!==t&&(null!=t&&t.length>0&&de(e,t),null!=n&&n.length>0&&pe(e,n))},createElementHook:be,useEventHandlers:ie,createControlComponent:function(e){return ue(le(be((function(t,n){return{instance:e(t),context:n}}))))},createLayerComponent:ve,createOverlayComponent:Oe,createPathComponent:xe,createTileLayerComponent:Ee,updateGridLayer:we,createLayerHook:he,useLayerLifecycle:me,updateMediaOverlay:function(e,t,n){t.bounds instanceof i.LatLngBounds&&t.bounds!==n.bounds&&e.setBounds(t.bounds),null!=t.opacity&&t.opacity!==n.opacity&&e.setOpacity(t.opacity),null!=t.zIndex&&t.zIndex!==n.zIndex&&e.setZIndex(t.zIndex)},withPane:se,createPathHook:ye,usePathOptions:ge});function Ce(t){const n=re().map;return e.useEffect((function(){return n.on(t),function(){n.off(t)}}),[n,t]),n}function Pe(){return(Pe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Se({children:t,className:n,id:r,placeholder:o,style:a,whenCreated:u,...l}){const s=e.useRef(null),c=function(t,n){const[r,o]=e.useState(null);return e.useEffect(()=>{if(null!==t.current&&null===r){const e=new i.Map(t.current,n);null!=n.center&&null!=n.zoom?e.setView(n.center,n.zoom):null!=n.bounds&&e.fitBounds(n.bounds,n.boundsOptions),null!=n.whenReady&&e.whenReady(n.whenReady),o(e)}},[t,r,n]),r}(s,l),p=e.useRef(!1);e.useEffect(()=>{null!=c&&!1===p.current&&null!=u&&(p.current=!0,u(c))},[c,u]);const[d]=e.useState({className:n,id:r,style:a}),b=e.useMemo(()=>c?{__version:1,map:c}:null,[c]),m=b?f.default.createElement(ne,{value:b},t):o??null;return f.default.createElement("div",Pe({},d,{ref:s}),m)}const Le=ve((function({position:e,...t},n){const r=new i.Marker(e,t);return{instance:r,context:{...n,overlayContainer:r}}}),(function(e,t,n){t.position!==n.position&&e.setLatLng(t.position),null!=t.icon&&t.icon!==n.icon&&e.setIcon(t.icon),null!=t.zIndexOffset&&t.zIndexOffset!==n.zIndexOffset&&e.setZIndexOffset(t.zIndexOffset),null!=t.opacity&&t.opacity!==n.opacity&&e.setOpacity(t.opacity),null!=e.dragging&&t.draggable!==n.draggable&&(!0===t.draggable?e.dragging.enable():e.dragging.disable())})),Ie=xe((function({positions:e,...t},n){const r=new i.Polyline(e,t);return{instance:r,context:{...n,overlayContainer:r}}}),(function(e,t,n){t.positions!==n.positions&&e.setLatLngs(t.positions)})),Te=Oe((function(e,t){return{instance:new i.Popup(e,t.overlayContainer),context:t}}),(function(t,n,r,o){const{onClose:a,onOpen:u,position:l}=r;e.useEffect((function(){const{instance:e}=t;function r(t){t.popup===e&&(e.update(),o(!0),null==u||u())}function i(t){t.popup===e&&(o(!1),null==a||a())}return n.map.on({popupopen:r,popupclose:i}),null==n.overlayContainer?(null!=l&&e.setLatLng(l),e.openOn(n.map)):n.overlayContainer.bindPopup(e),function(){var t;n.map.off({popupopen:r,popupclose:i}),null==(t=n.overlayContainer)||t.unbindPopup(),n.map.removeLayer(e)}}),[t,n,o,a,u,l])})),Ae=Ee((function({url:e,...t},n){return{instance:new i.TileLayer(e,se(t,n)),context:n}}),we);var ze,ke=L((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=(n=m.default)&&n.__esModule?n:{default:n};function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var u,l=e[Symbol.iterator]();!(r=(u=l.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=(0,je.createPathComponent)((function(e,t){e.children;var n=s(e,["children"]),o={},u={};Object.entries(n).forEach((function(e){var t=l(e,2),n=t[0],r=t[1];return n.startsWith("on")?u[n]=r:o[n]=r}));var i=new r.default.markerClusterGroup(o);return Object.entries(u).forEach((function(e){var t=l(e,2),n=t[0],r=t[1],o="cluster".concat(n.substring(2).toLowerCase());i.on(o,r)})),{instance:i,context:a(a({},t),{},{layerContainer:i})}}));t.default=c})),Me=(ze=ke)&&ze.__esModule&&Object.prototype.hasOwnProperty.call(ze,"default")?ze.default:ze,Re=function(){var e=a.useHistory(),t=new URLSearchParams(e.location.search);return Ce({moveend:function(n){t.set("lat",n.target.getCenter().lat),t.set("lng",n.target.getCenter().lng),e.replace({pathname:e.location.pathname,search:"?"+t.toString()})},zoomend:function(n){t.set("zoom",n.target.getZoom()),e.replace({pathname:e.location.pathname,search:"?"+t.toString()})}}),null},Ne=["latitude","longitude","label","description","popupContent","height","center","zoom","groupClusters","boundToMarkers","connectMarkers"],_e=n.makeStyles((function(){return{loading:{zIndex:1e3,position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center"},closeButton:{position:"absolute",zIndex:1400,top:0,right:0}}})),De=function(r){var o,u=r.latitude,l=r.longitude,i=r.label,s=r.description,c=r.popupContent,p=r.height,d=r.center,m=r.zoom,g=r.groupClusters,y=r.boundToMarkers,O=r.connectMarkers,j=E(r,Ne),C=t.useListContext(),P=C.ids,S=C.data,L=C.basePath,I=C.loading,T=n.useMediaQuery((function(e){return e.breakpoints.down("xs")}),{noSsr:!0}),A=w(e.useState(null),2),z=A[0],k=A[1],M=w(e.useState(null),2),R=M[0],N=M[1],_=_e(),D=new URLSearchParams(a.useLocation().search);d=D.has("lat")&&D.has("lng")?[D.get("lat"),D.get("lng")]:d,m=D.has("zoom")?D.get("zoom"):m;var B=P.map((function(e){return v(v({},S[e]),{},{latitude:u&&u(S[e]),longitude:l&&l(S[e]),label:i&&i(S[e]),description:s&&s(S[e])})})).filter((function(e){return e.latitude&&e.longitude})),H=y&&B.length>0?B.map((function(e){return[e.latitude,e.longitude]})):void 0;if(y&&!H)return null;var q=B.map((function(e,t){var n=f.default.createElement(f.default.Fragment,{key:t},f.default.createElement(Le,{position:[e.latitude,e.longitude],eventHandlers:T?{click:function(){R.setView([e.latitude,e.longitude]),k(e)}}:void 0},!T&&f.default.createElement(Te,null,f.default.createElement(c,{record:e,basePath:L}))),O&&o&&f.default.createElement(Ie,{positions:[[o.latitude,o.longitude],[e.latitude,e.longitude]]}));return o=e,n}));return f.default.createElement(Se,x({style:{height:p},center:y?void 0:d,zoom:y?void 0:m,bounds:H,whenCreated:N},j),f.default.createElement(Ae,{attribution:'© <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),I&&f.default.createElement(n.Box,{alignItems:"center",className:_.loading},f.default.createElement(b.default,{size:60,thickness:6})),g?f.default.createElement(Me,{showCoverageOnHover:!1},q):q,f.default.createElement(Re,null),f.default.createElement(n.Drawer,{anchor:"bottom",open:!!z,onClose:function(){return k(null)}},f.default.createElement(n.Box,{p:1,position:"relative"},f.default.createElement(n.IconButton,{onClick:function(){return k(null)},className:_.closeButton},f.default.createElement(h.default,null)),z&&f.default.createElement(c,{record:z,basePath:L}))))};De.defaultProps={height:700,center:[47,2.213749],zoom:6,groupClusters:!0,connectMarkers:!1,scrollWheelZoom:!1,popupContent:g};var Be=["record","latitude","longitude","address","height","addLabel","typographyProps"],He=n.makeStyles((function(e){return{address:{marginTop:e.spacing(2),marginBottom:e.spacing(1)}}})),qe=function(e){var t=e.record,r=e.latitude,o=e.longitude,a=e.address,u=e.height;e.addLabel;var l=e.typographyProps,i=E(e,Be);He();var s=[r(t),o(t)];return s[0]&&s[1]?f.default.createElement(n.Box,null,a&&f.default.createElement(n.Box,{mt:1,mb:1},f.default.createElement(n.Typography,l,a(t))),f.default.createElement(Se,x({style:{height:u},center:s},i),f.default.createElement(Ae,{attribution:'© <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),f.default.createElement(Le,{position:s}))):null};qe.defaultProps={height:400,zoom:11,addLabel:!0},exports.DefaultPopupContent=g,exports.LocationInput=K,exports.MapField=qe,exports.MapList=De,exports.QueryStringUpdater=Re,exports.extractContext=function(e,t){var n=e.find((function(e){return e.id.startsWith(t+".")}));if(n)return n.text};
//# sourceMappingURL=index.cjs.js.map
