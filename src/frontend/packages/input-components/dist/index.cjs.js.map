{"version":3,"file":"index.cjs.js","sources":["../src/OptionRenderer.js","../src/ImageInput.js","../src/MultiLinesInput.js","../src/MultiServerAutocompleteArrayInput.js","../src/MultiServerAutocompleteInput.js","../src/ReferenceArrayInput.js","../src/ReferenceInput.js"],"sourcesContent":["import React from 'react';\nimport { useRecordContext } from 'react-admin';\n\nconst OptionRenderer = ({ optionText, dataServers }) => {\n  const record = useRecordContext();    \n  const server = dataServers && Object.values(dataServers).find(server => record.id.startsWith(server.baseUrl));\n  return (\n    <span>\n      {record[optionText]}\n      {server && (\n        <em className=\"serverName\" style={{ color: 'grey' }}>\n          &nbsp;({server.name})\n        </em>\n      )}\n    </span>\n  );\n};\n\nexport default OptionRenderer;\n","import React from 'react';\nimport { ImageInput as RaImageInput, useRecordContext, RecordContextProvider } from 'react-admin';\n\nconst ImageInput = ({ source, ...rest }) => {\n  const record = useRecordContext();\n  const modifiedRecord = record && record[source] && typeof record[source] === 'string' \n    ? { ...record, [source]: { src: record[source] } }\n    : record;\n\n  return (\n    <RecordContextProvider value={modifiedRecord}>\n      <RaImageInput source={source} {...rest} />\n    </RecordContextProvider>\n  );\n};\n\nexport default ImageInput;\n","import React from 'react';\nimport { TextInput } from 'react-admin';\n\nconst MultiLinesInput = props => (\n  <TextInput\n    multiline\n    minRows={2}\n    format={value => (value ? (Array.isArray(value) ? value.join('\\n') : value) : '')}\n    parse={value => value.split(/\\r?\\n/)}\n    {...props}\n  />\n);\n\nexport default MultiLinesInput;\n","import React, { useCallback } from 'react';\nimport { AutocompleteArrayInput } from 'react-admin';\nimport { useDataServers } from '@semapps/semantic-data-provider';\nimport OptionRenderer from './OptionRenderer';\n\nconst MultiServerAutocompleteArrayInput = ({ optionText, ...rest }) => {\n  const dataServers = useDataServers();\n  const matchSuggestion = useCallback(\n    (filterValue, choice) => choice[optionText].toLowerCase().match(filterValue.toLowerCase()),\n    [optionText]\n  );\n  return (\n    <AutocompleteArrayInput\n      matchSuggestion={matchSuggestion}\n      optionText={<OptionRenderer optionText={optionText} dataServers={dataServers} />}\n      inputText={choice => choice[optionText]}\n      {...rest}\n    />\n  );\n};\n\nexport default MultiServerAutocompleteArrayInput;\n","import React, { useCallback } from 'react';\nimport { AutocompleteInput } from 'react-admin';\nimport { useDataServers } from '@semapps/semantic-data-provider';\n\nconst MultiServerAutocompleteInput = ({ optionText, ...rest }) => {\n  const dataServers = useDataServers();\n  // We cannot use OptionRenderer like MultiServerAutocompleteArrayInput because there is a bug with AutocompleteInput\n  const optionTextWithServerName = useCallback(\n    record => {\n      if (record && dataServers) {\n        const server = Object.values(dataServers).find(server => record.id.startsWith(server.baseUrl));\n        return record[optionText] + (server ? ` (${server.name})` : '');\n      }\n    },\n    [optionText, dataServers]\n  );\n  return <AutocompleteInput optionText={optionTextWithServerName} {...rest} />;\n};\n\nexport default MultiServerAutocompleteInput;\n","import React from 'react';\nimport { ReferenceArrayInput as RaReferenceArrayInput, useResourceContext, useRecordContext } from 'react-admin';\n\nconst ReferenceArrayInput = props => {\n  const resource = useResourceContext({});\n  let record = useRecordContext();\n  if (record && record[props.source]) {\n    let value = record[props.source];\n    // if the linked field value is not an array, turns it into an array.\n    // Necessary as JSON-LD are sometimes arrays, sometimes not (when there is one value)\n    // and the ReferenceArrayInput component only accept arrays\n    if (!Array.isArray(value)) value = [value];\n    // If a format prop was defined, apply it to the array\n    if (props.format) value = props.format(value);\n    // If the values are objects with @id field, turn it to a simple string\n    value = value.map(v => (typeof v === 'object' ? v.id || v['@id'] : v));\n    record[props.source] = value;\n  }\n  return (\n    <RaReferenceArrayInput\n      {...props}\n      resource={resource}\n      record={record}\n    />\n  );\n};\n\nexport default ReferenceArrayInput;","import React from 'react';\nimport { ReferenceInput as RaReferenceInput, useResourceContext } from 'react-admin';\n\nconst ReferenceInput = props => {\n  const resource = useResourceContext({});\n  return (\n    <RaReferenceInput\n      {...props}\n      resource={resource}\n      format={value => {\n        // If there is no value, return immediately\n        if (!value) return value;\n        // If a format prop was defined, apply it\n        if (props.format) value = props.format(value);\n        // If the value is an object with an @id field, return the uri\n        return typeof value === 'object' ? value.id || value['@id'] : value;\n      }}\n    />\n  );\n};\n\nexport default ReferenceInput;\n"],"names":["OptionRenderer","_ref","optionText","dataServers","record","useRecordContext","server","Object","values","find","id","startsWith","baseUrl","React","createElement","className","style","color","name","source","rest","_objectWithoutProperties","_excluded","modifiedRecord","_defineProperty","src","RecordContextProvider","value","RaImageInput","ImageInput","_extends","props","TextInput","multiline","minRows","format","Array","isArray","join","parse","split","useDataServers","matchSuggestion","useCallback","filterValue","choice","toLowerCase","match","AutocompleteArrayInput","inputText","optionTextWithServerName","AutocompleteInput","resource","useResourceContext","map","v","_typeof","RaReferenceArrayInput","RaReferenceInput"],"mappings":"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"}