"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("react-admin"),n=require("@material-ui/core/styles"),r=require("crypto"),o=require("rdf-canonize-native"),a=require("https"),i=require("http"),s=require("zlib"),l=require("stream"),c=require("util"),u=require("url"),d=require("web-streams-polyfill/ponyfill/es2018");function p(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var f=p(e),h=p(r),y=p(o),g=p(a),v=p(i),m=p(s),b=p(l),w=p(d);function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e,t,n,r,o,a,i){try{var s=e[a](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function I(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){S(a,r,o,i,s,"next",e)}function s(e){S(a,r,o,i,s,"throw",e)}i(void 0)}))}}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(){return(k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function N(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,a=[],i=!0,s=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){s=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(s)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var E=class e{constructor(e,t=new Map,n=0){this.prefix=e,this._existing=t,this.counter=n}clone(){const{prefix:t,_existing:n,counter:r}=this;return new e(t,new Map(n),r)}getId(e){const t=e&&this._existing.get(e);if(t)return t;const n=this.prefix+this.counter;return this.counter++,e&&this._existing.set(e,n),n}hasId(e){return this._existing.has(e)}getOldIds(){return[...this._existing.keys()]}},T=class{constructor(e){this.md=h.default.createHash(e)}update(e){this.md.update(e,"utf8")}digest(){return this.md.digest("hex")}},R=class{constructor(e){this.current=e.sort(),this.done=!1,this.dir=new Map;for(let t=0;t<e.length;++t)this.dir.set(e[t],!0)}hasNext(){return!this.done}next(){const{current:e,dir:t}=this,n=e.slice();let r=null,o=0;const a=e.length;for(let n=0;n<a;++n){const i=e[n],s=t.get(i);(null===r||i>r)&&(s&&n>0&&i>e[n-1]||!s&&n<a-1&&i>e[n+1])&&(r=i,o=n)}if(null===r)this.done=!0;else{const n=t.get(r)?o-1:o+1;e[o]=e[n],e[n]=r;for(const n of e)n>r&&t.set(n,!t.get(n))}return n}};const L="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",D="http://www.w3.org/2001/XMLSchema#string",P={eoln:/(?:\r\n)|(?:\n)|(?:\r)/g};P.empty=new RegExp("^[ \\t]*$"),P.quad=new RegExp('^[ \\t]*(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9])(?:(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9-·̀-ͯ‿-⁀.])*(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9-·̀-ͯ‿-⁀]))?))[ \\t]+(?:<([^:]+:[^>]*)>)[ \\t]+(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9])(?:(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9-·̀-ͯ‿-⁀.])*(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9-·̀-ͯ‿-⁀]))?)|(?:"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"(?:(?:\\^\\^(?:<([^:]+:[^>]*)>))|(?:@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*)))?))[ \\t]*(?:\\.|(?:(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9])(?:(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9-·̀-ͯ‿-⁀.])*(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9-·̀-ͯ‿-⁀]))?))[ \\t]*\\.))[ \\t]*$');var _=class e{static parse(e){const t=[],n={},r=e.split(P.eoln);let o=0;for(const e of r){if(o++,P.empty.test(e))continue;const r=e.match(P.quad);if(null===r)throw new Error("N-Quads parse error on line "+o+".");const a={subject:null,predicate:null,object:null,graph:null};if(void 0!==r[1]?a.subject={termType:"NamedNode",value:r[1]}:a.subject={termType:"BlankNode",value:r[2]},a.predicate={termType:"NamedNode",value:r[3]},void 0!==r[4]?a.object={termType:"NamedNode",value:r[4]}:void 0!==r[5]?a.object={termType:"BlankNode",value:r[5]}:(a.object={termType:"Literal",value:void 0,datatype:{termType:"NamedNode"}},void 0!==r[7]?a.object.datatype.value=r[7]:void 0!==r[8]?(a.object.datatype.value=L,a.object.language=r[8]):a.object.datatype.value=D,a.object.value=r[6].replace(U,(function(e,t,n,r){if(t)switch(t){case"t":return"\t";case"b":return"\b";case"n":return"\n";case"r":return"\r";case"f":return"\f";case'"':return'"';case"'":return"'";case"\\":return"\\"}if(n)return String.fromCharCode(parseInt(n,16));if(r)throw new Error("Unsupported U escape")}))),void 0!==r[9]?a.graph={termType:"NamedNode",value:r[9]}:void 0!==r[10]?a.graph={termType:"BlankNode",value:r[10]}:a.graph={termType:"DefaultGraph",value:""},a.graph.value in n){let e=!0;const r=n[a.graph.value];for(const t of r)if(B(t,a)){e=!1;break}e&&(r.push(a),t.push(a))}else n[a.graph.value]=[a],t.push(a)}return t}static serialize(t){Array.isArray(t)||(t=e.legacyDatasetToQuads(t));const n=[];for(const r of t)n.push(e.serializeQuad(r));return n.sort().join("")}static serializeQuad(e){const t=e.subject,n=e.predicate,r=e.object,o=e.graph;let a="";return"NamedNode"===t.termType?a+=`<${t.value}>`:a+=""+t.value,a+=` <${n.value}> `,"NamedNode"===r.termType?a+=`<${r.value}>`:"BlankNode"===r.termType?a+=r.value:(a+=`"${function(e){return e.replace(M,(function(e){switch(e){case'"':return'\\"';case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r"}}))}(r.value)}"`,r.datatype.value===L?r.language&&(a+="@"+r.language):r.datatype.value!==D&&(a+=`^^<${r.datatype.value}>`)),"NamedNode"===o.termType?a+=` <${o.value}>`:"BlankNode"===o.termType&&(a+=" "+o.value),a+=" .\n",a}static legacyDatasetToQuads(e){const t=[],n={"blank node":"BlankNode",IRI:"NamedNode",literal:"Literal"};for(const r in e){e[r].forEach(e=>{const o={};for(const t in e){const r=e[t],a={termType:n[r.type],value:r.value};"Literal"===a.termType&&(a.datatype={termType:"NamedNode"},"datatype"in r&&(a.datatype.value=r.datatype),"language"in r?("datatype"in r||(a.datatype.value=L),a.language=r.language):"datatype"in r||(a.datatype.value=D)),o[t]=a}o.graph="@default"===r?{termType:"DefaultGraph",value:""}:{termType:r.startsWith("_:")?"BlankNode":"NamedNode",value:r},t.push(o)})}return t}};function B(e,t){return e.subject.termType===t.subject.termType&&e.object.termType===t.object.termType&&(e.subject.value===t.subject.value&&e.predicate.value===t.predicate.value&&e.object.value===t.object.value&&("Literal"!==e.object.termType||e.object.datatype.termType===t.object.datatype.termType&&e.object.language===t.object.language&&e.object.datatype.value===t.object.datatype.value))}const M=/["\\\n\r]/g;const U=/(?:\\([tbnrf"'\\]))|(?:\\u([0-9A-Fa-f]{4}))|(?:\\U([0-9A-Fa-f]{8}))/g;var q=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new E("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}async main(e){this.quads=e;for(const t of e)this._addBlankNodeQuadInfo({quad:t,component:t.subject}),this._addBlankNodeQuadInfo({quad:t,component:t.object}),this._addBlankNodeQuadInfo({quad:t,component:t.graph});const t=new Map,n=[...this.blankNodeInfo.keys()];let r=0;for(const e of n)++r%100==0&&await this._yield(),await this._hashAndTrackBlankNode({id:e,hashToBlankNodes:t});const o=[...t.keys()].sort(),a=[];for(const e of o){const n=t.get(e);if(n.length>1){a.push(n);continue}const r=n[0];this.canonicalIssuer.getId(r)}for(const e of a){const t=[];for(const n of e){if(this.canonicalIssuer.hasId(n))continue;const e=new E("_:b");e.getId(n);const r=await this.hashNDegreeQuads(n,e);t.push(r)}t.sort(z);for(const e of t){const t=e.issuer.getOldIds();for(const e of t)this.canonicalIssuer.getId(e)}}const i=[];for(const e of this.quads){const t={...e};t.subject=this._useCanonicalId({component:t.subject}),t.object=this._useCanonicalId({component:t.object}),t.graph=this._useCanonicalId({component:t.graph}),i.push(_.serializeQuad(t))}return i.sort(),i.join("")}async hashFirstDegreeQuads(e){const t=[],n=this.blankNodeInfo.get(e),r=n.quads;for(const n of r){const r={subject:null,predicate:n.predicate,object:null,graph:null};r.subject=this.modifyFirstDegreeComponent(e,n.subject,"subject"),r.object=this.modifyFirstDegreeComponent(e,n.object,"object"),r.graph=this.modifyFirstDegreeComponent(e,n.graph,"graph"),t.push(_.serializeQuad(r))}t.sort();const o=new T(this.hashAlgorithm);for(const e of t)o.update(e);return n.hash=await o.digest(),n.hash}async hashRelatedBlankNode(e,t,n,r){let o;o=this.canonicalIssuer.hasId(e)?this.canonicalIssuer.getId(e):n.hasId(e)?n.getId(e):this.blankNodeInfo.get(e).hash;const a=new T(this.hashAlgorithm);return a.update(r),"g"!==r&&a.update(this.getRelatedPredicate(t)),a.update(o),a.digest()}async hashNDegreeQuads(e,t){const n=new T(this.hashAlgorithm),r=await this.createHashToRelated(e,t),o=[...r.keys()].sort();for(const e of o){n.update(e);let o,a="";const i=new R(r.get(e));let s=0;for(;i.hasNext();){const e=i.next();++s%3==0&&await this._yield();let n=t.clone(),r="";const l=[];let c=!1;for(const t of e)if(this.canonicalIssuer.hasId(t)?r+=this.canonicalIssuer.getId(t):(n.hasId(t)||l.push(t),r+=n.getId(t)),0!==a.length&&r>a){c=!0;break}if(!c){for(const e of l){const t=await this.hashNDegreeQuads(e,n);if(r+=n.getId(e),r+=`<${t.hash}>`,n=t.issuer,0!==a.length&&r>a){c=!0;break}}c||(0===a.length||r<a)&&(a=r,o=n)}}n.update(a),t=o}return{hash:await n.digest(),issuer:t}}modifyFirstDegreeComponent(e,t){return"BlankNode"!==t.termType?t:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return`<${e.predicate.value}>`}async createHashToRelated(e,t){const n=new Map,r=this.blankNodeInfo.get(e).quads;let o=0;for(const a of r)++o%100==0&&await this._yield(),await Promise.all([this._addRelatedBlankNodeHash({quad:a,component:a.subject,position:"s",id:e,issuer:t,hashToRelated:n}),this._addRelatedBlankNodeHash({quad:a,component:a.object,position:"o",id:e,issuer:t,hashToRelated:n}),this._addRelatedBlankNodeHash({quad:a,component:a.graph,position:"g",id:e,issuer:t,hashToRelated:n})]);return n}async _hashAndTrackBlankNode({id:e,hashToBlankNodes:t}){const n=await this.hashFirstDegreeQuads(e),r=t.get(n);r?r.push(e):t.set(n,[e])}_addBlankNodeQuadInfo({quad:e,component:t}){if("BlankNode"!==t.termType)return;const n=t.value,r=this.blankNodeInfo.get(n);r?r.quads.add(e):this.blankNodeInfo.set(n,{quads:new Set([e]),hash:null})}async _addRelatedBlankNodeHash({quad:e,component:t,position:n,id:r,issuer:o,hashToRelated:a}){if("BlankNode"!==t.termType||t.value===r)return;const i=t.value,s=await this.hashRelatedBlankNode(i,e,o,n),l=a.get(s);l?l.push(i):a.set(s,[i])}_useCanonicalId({component:e}){return"BlankNode"!==e.termType||e.value.startsWith(this.canonicalIssuer.prefix)?e:{termType:"BlankNode",value:this.canonicalIssuer.getId(e.value)}}async _yield(){return new Promise(e=>setImmediate(e))}};function z(e,t){return e.hash<t.hash?-1:e.hash>t.hash?1:0}var F=class extends q{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(e,t,n){return"BlankNode"!==t.termType?t:"graph"===n?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return e.predicate.value}async createHashToRelated(e,t){const n=new Map,r=this.blankNodeInfo.get(e).quads;let o=0;for(const a of r){let r,i;if("BlankNode"===a.subject.termType&&a.subject.value!==e)i=a.subject.value,r="p";else{if("BlankNode"!==a.object.termType||a.object.value===e)continue;i=a.object.value,r="r"}++o%100==0&&await this._yield();const s=await this.hashRelatedBlankNode(i,a,t,r),l=n.get(s);l?l.push(i):n.set(s,[i])}return n}},J=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new E("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}main(e){this.quads=e;for(const t of e)this._addBlankNodeQuadInfo({quad:t,component:t.subject}),this._addBlankNodeQuadInfo({quad:t,component:t.object}),this._addBlankNodeQuadInfo({quad:t,component:t.graph});const t=new Map,n=[...this.blankNodeInfo.keys()];for(const e of n)this._hashAndTrackBlankNode({id:e,hashToBlankNodes:t});const r=[...t.keys()].sort(),o=[];for(const e of r){const n=t.get(e);if(n.length>1){o.push(n);continue}const r=n[0];this.canonicalIssuer.getId(r)}for(const e of o){const t=[];for(const n of e){if(this.canonicalIssuer.hasId(n))continue;const e=new E("_:b");e.getId(n);const r=this.hashNDegreeQuads(n,e);t.push(r)}t.sort(H);for(const e of t){const t=e.issuer.getOldIds();for(const e of t)this.canonicalIssuer.getId(e)}}const a=[];for(const e of this.quads){const t={...e};t.subject=this._useCanonicalId({component:t.subject}),t.object=this._useCanonicalId({component:t.object}),t.graph=this._useCanonicalId({component:t.graph}),a.push(_.serializeQuad(t))}return a.sort(),a.join("")}hashFirstDegreeQuads(e){const t=[],n=this.blankNodeInfo.get(e),r=n.quads;for(const n of r){const r={subject:null,predicate:n.predicate,object:null,graph:null};r.subject=this.modifyFirstDegreeComponent(e,n.subject,"subject"),r.object=this.modifyFirstDegreeComponent(e,n.object,"object"),r.graph=this.modifyFirstDegreeComponent(e,n.graph,"graph"),t.push(_.serializeQuad(r))}t.sort();const o=new T(this.hashAlgorithm);for(const e of t)o.update(e);return n.hash=o.digest(),n.hash}hashRelatedBlankNode(e,t,n,r){let o;o=this.canonicalIssuer.hasId(e)?this.canonicalIssuer.getId(e):n.hasId(e)?n.getId(e):this.blankNodeInfo.get(e).hash;const a=new T(this.hashAlgorithm);return a.update(r),"g"!==r&&a.update(this.getRelatedPredicate(t)),a.update(o),a.digest()}hashNDegreeQuads(e,t){const n=new T(this.hashAlgorithm),r=this.createHashToRelated(e,t),o=[...r.keys()].sort();for(const e of o){n.update(e);let o,a="";const i=new R(r.get(e));for(;i.hasNext();){const e=i.next();let n=t.clone(),r="";const s=[];let l=!1;for(const t of e)if(this.canonicalIssuer.hasId(t)?r+=this.canonicalIssuer.getId(t):(n.hasId(t)||s.push(t),r+=n.getId(t)),0!==a.length&&r>a){l=!0;break}if(!l){for(const e of s){const t=this.hashNDegreeQuads(e,n);if(r+=n.getId(e),r+=`<${t.hash}>`,n=t.issuer,0!==a.length&&r>a){l=!0;break}}l||(0===a.length||r<a)&&(a=r,o=n)}}n.update(a),t=o}return{hash:n.digest(),issuer:t}}modifyFirstDegreeComponent(e,t){return"BlankNode"!==t.termType?t:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return`<${e.predicate.value}>`}createHashToRelated(e,t){const n=new Map,r=this.blankNodeInfo.get(e).quads;for(const o of r)this._addRelatedBlankNodeHash({quad:o,component:o.subject,position:"s",id:e,issuer:t,hashToRelated:n}),this._addRelatedBlankNodeHash({quad:o,component:o.object,position:"o",id:e,issuer:t,hashToRelated:n}),this._addRelatedBlankNodeHash({quad:o,component:o.graph,position:"g",id:e,issuer:t,hashToRelated:n});return n}_hashAndTrackBlankNode({id:e,hashToBlankNodes:t}){const n=this.hashFirstDegreeQuads(e),r=t.get(n);r?r.push(e):t.set(n,[e])}_addBlankNodeQuadInfo({quad:e,component:t}){if("BlankNode"!==t.termType)return;const n=t.value,r=this.blankNodeInfo.get(n);r?r.quads.add(e):this.blankNodeInfo.set(n,{quads:new Set([e]),hash:null})}_addRelatedBlankNodeHash({quad:e,component:t,position:n,id:r,issuer:o,hashToRelated:a}){if("BlankNode"!==t.termType||t.value===r)return;const i=t.value,s=this.hashRelatedBlankNode(i,e,o,n),l=a.get(s);l?l.push(i):a.set(s,[i])}_useCanonicalId({component:e}){return"BlankNode"!==e.termType||e.value.startsWith(this.canonicalIssuer.prefix)?e:{termType:"BlankNode",value:this.canonicalIssuer.getId(e.value)}}};function H(e,t){return e.hash<t.hash?-1:e.hash>t.hash?1:0}var $=class extends J{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(e,t,n){return"BlankNode"!==t.termType?t:"graph"===n?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return e.predicate.value}createHashToRelated(e,t){const n=new Map,r=this.blankNodeInfo.get(e).quads;for(const o of r){let r,a;if("BlankNode"===o.subject.termType&&o.subject.value!==e)a=o.subject.value,r="p";else{if("BlankNode"!==o.object.termType||o.object.value===e)continue;a=o.object.value,r="r"}const i=this.hashRelatedBlankNode(a,o,t,r),s=n.get(i);s?s.push(a):n.set(i,[a])}return n}};let V;try{V=y.default}catch(e){}const G={};var W=G;G.NQuads=_,G.IdentifierIssuer=E,G._rdfCanonizeNative=function(e){return e&&(V=e),V},G.canonize=async function(e,t){if(Array.isArray(e)||(e=G.NQuads.legacyDatasetToQuads(e)),t.useNative){if(!V)throw new Error("rdf-canonize-native not available");return new Promise((n,r)=>V.canonize(e,t,(e,t)=>e?r(e):n(t)))}if("URDNA2015"===t.algorithm)return new q(t).main(e);if("URGNA2012"===t.algorithm)return new F(t).main(e);if(!("algorithm"in t))throw new Error("No RDF Dataset Canonicalization algorithm specified.");throw new Error("Invalid RDF Dataset Canonicalization algorithm: "+t.algorithm)},G._canonizeSync=function(e,t){if(Array.isArray(e)||(e=G.NQuads.legacyDatasetToQuads(e)),t.useNative){if(V)return V.canonizeSync(e,t);throw new Error("rdf-canonize-native not available")}if("URDNA2015"===t.algorithm)return new J(t).main(e);if("URGNA2012"===t.algorithm)return new $(t).main(e);if(!("algorithm"in t))throw new Error("No RDF Dataset Canonicalization algorithm specified.");throw new Error("Invalid RDF Dataset Canonicalization algorithm: "+t.algorithm)};var Z=W;const K={};var Q=K;K.isArray=Array.isArray,K.isBoolean=e=>"boolean"==typeof e||"[object Boolean]"===Object.prototype.toString.call(e),K.isDouble=e=>K.isNumber(e)&&(-1!==String(e).indexOf(".")||Math.abs(e)>=1e21),K.isEmptyObject=e=>K.isObject(e)&&0===Object.keys(e).length,K.isNumber=e=>"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e),K.isNumeric=e=>!isNaN(parseFloat(e))&&isFinite(e),K.isObject=e=>"[object Object]"===Object.prototype.toString.call(e),K.isString=e=>"string"==typeof e||"[object String]"===Object.prototype.toString.call(e),K.isUndefined=e=>void 0===e;const X={};var Y=X;X.isSubject=e=>{if(Q.isObject(e)&&!("@value"in e||"@set"in e||"@list"in e)){return Object.keys(e).length>1||!("@id"in e)}return!1},X.isSubjectReference=e=>Q.isObject(e)&&1===Object.keys(e).length&&"@id"in e,X.isValue=e=>Q.isObject(e)&&"@value"in e,X.isList=e=>Q.isObject(e)&&"@list"in e,X.isGraph=e=>Q.isObject(e)&&"@graph"in e&&1===Object.keys(e).filter(e=>"@id"!==e&&"@index"!==e).length,X.isSimpleGraph=e=>X.isGraph(e)&&!("@id"in e),X.isBlankNode=e=>!!Q.isObject(e)&&("@id"in e?0===e["@id"].indexOf("_:"):0===Object.keys(e).length||!("@value"in e||"@set"in e||"@list"in e));var ee=class extends Error{constructor(e="An unspecified JSON-LD error occurred.",t="jsonld.Error",n={}){super(e),this.name=t,this.message=e,this.details=n}};const te=Z.IdentifierIssuer,ne=/(?:<[^>]*?>|"[^"]*?"|[^,])+/g,re=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,oe=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g,ae={accept:"application/ld+json, application/json"},ie={};var se=ie;ie.IdentifierIssuer=te,ie.clone=function(e){if(e&&"object"==typeof e){let t;if(Q.isArray(e)){t=[];for(let n=0;n<e.length;++n)t[n]=ie.clone(e[n])}else if(e instanceof Map){t=new Map;for(const[n,r]of e)t.set(n,ie.clone(r))}else if(e instanceof Set){t=new Set;for(const n of e)t.add(ie.clone(n))}else if(Q.isObject(e)){t={};for(const n in e)t[n]=ie.clone(e[n])}else t=e.toString();return t}return e},ie.asArray=function(e){return Array.isArray(e)?e:[e]},ie.buildHeaders=(e={})=>{if(Object.keys(e).some(e=>"accept"===e.toLowerCase()))throw new RangeError('Accept header may not be specified; only "'+ae.accept+'" is supported.');return Object.assign({Accept:ae.accept},e)},ie.parseLinkHeader=e=>{const t={},n=e.match(ne);for(let e=0;e<n.length;++e){let r=n[e].match(re);if(!r)continue;const o={target:r[1]},a=r[2];for(;r=oe.exec(a);)o[r[1]]=void 0===r[2]?r[3]:r[2];const i=o.rel||"";Array.isArray(t[i])?t[i].push(o):t.hasOwnProperty(i)?t[i]=[t[i],o]:t[i]=o}return t},ie.validateTypeValue=(e,t)=>{if(!(Q.isString(e)||Q.isArray(e)&&e.every(e=>Q.isString(e)))){if(t&&Q.isObject(e))switch(Object.keys(e).length){case 0:return;case 1:if("@default"in e&&ie.asArray(e["@default"]).every(e=>Q.isString(e)))return}throw new ee('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, an empty object, or a default object.',"jsonld.SyntaxError",{code:"invalid type value",value:e})}},ie.hasProperty=(e,t)=>{if(e.hasOwnProperty(t)){const n=e[t];return!Q.isArray(n)||n.length>0}return!1},ie.hasValue=(e,t,n)=>{if(ie.hasProperty(e,t)){let r=e[t];const o=Y.isList(r);if(Q.isArray(r)||o){o&&(r=r["@list"]);for(let e=0;e<r.length;++e)if(ie.compareValues(n,r[e]))return!0}else if(!Q.isArray(n))return ie.compareValues(n,r)}return!1},ie.addValue=(e,t,n,r)=>{if("propertyIsArray"in(r=r||{})||(r.propertyIsArray=!1),"valueIsArray"in r||(r.valueIsArray=!1),"allowDuplicate"in r||(r.allowDuplicate=!0),"prependValue"in r||(r.prependValue=!1),r.valueIsArray)e[t]=n;else if(Q.isArray(n)){0===n.length&&r.propertyIsArray&&!e.hasOwnProperty(t)&&(e[t]=[]),r.prependValue&&(n=n.concat(e[t]),e[t]=[]);for(let o=0;o<n.length;++o)ie.addValue(e,t,n[o],r)}else if(e.hasOwnProperty(t)){const o=!r.allowDuplicate&&ie.hasValue(e,t,n);Q.isArray(e[t])||o&&!r.propertyIsArray||(e[t]=[e[t]]),o||(r.prependValue?e[t].unshift(n):e[t].push(n))}else e[t]=r.propertyIsArray?[n]:n},ie.getValues=(e,t)=>[].concat(e[t]||[]),ie.removeProperty=(e,t)=>{delete e[t]},ie.removeValue=(e,t,n,r)=>{"propertyIsArray"in(r=r||{})||(r.propertyIsArray=!1);const o=ie.getValues(e,t).filter(e=>!ie.compareValues(e,n));0===o.length?ie.removeProperty(e,t):1!==o.length||r.propertyIsArray?e[t]=o:e[t]=o[0]},ie.relabelBlankNodes=(e,t)=>function e(t,n){if(Q.isArray(n))for(let r=0;r<n.length;++r)n[r]=e(t,n[r]);else if(Y.isList(n))n["@list"]=e(t,n["@list"]);else if(Q.isObject(n)){Y.isBlankNode(n)&&(n["@id"]=t.getId(n["@id"]));const r=Object.keys(n).sort();for(let o=0;o<r.length;++o){const a=r[o];"@id"!==a&&(n[a]=e(t,n[a]))}}return n}((t=t||{}).issuer||new te("_:b"),e),ie.compareValues=(e,t)=>e===t||(!(!Y.isValue(e)||!Y.isValue(t)||e["@value"]!==t["@value"]||e["@type"]!==t["@type"]||e["@language"]!==t["@language"]||e["@index"]!==t["@index"])||!!(Q.isObject(e)&&"@id"in e&&Q.isObject(t)&&"@id"in t)&&e["@id"]===t["@id"]),ie.compareShortestLeast=(e,t)=>e.length<t.length?-1:t.length<e.length?1:e===t?0:e<t?-1:1;const le="http://www.w3.org/1999/02/22-rdf-syntax-ns#",ce="http://www.w3.org/2001/XMLSchema#";var ue={LINK_HEADER_REL:"http://www.w3.org/ns/json-ld#context",LINK_HEADER_CONTEXT:"http://www.w3.org/ns/json-ld#context",RDF:le,RDF_LIST:le+"List",RDF_FIRST:le+"first",RDF_REST:le+"rest",RDF_NIL:le+"nil",RDF_TYPE:le+"type",RDF_PLAIN_LITERAL:le+"PlainLiteral",RDF_XML_LITERAL:le+"XMLLiteral",RDF_JSON_LITERAL:le+"JSON",RDF_OBJECT:le+"object",RDF_LANGSTRING:le+"langString",XSD:ce,XSD_BOOLEAN:ce+"boolean",XSD_DOUBLE:ce+"double",XSD_INTEGER:ce+"integer",XSD_STRING:ce+"string"},de=class{constructor(){this._requests={}}wrapLoader(e){const t=this;return t._loader=e,function(){return t.add.apply(t,arguments)}}async add(e){let t=this._requests[e];if(t)return Promise.resolve(t);t=this._requests[e]=this._loader(e);try{return await t}finally{delete this._requests[e]}}};const pe={};var fe=pe;pe.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},pe.parse=(e,t)=>{const n={},r=pe.parsers[t||"full"],o=r.regex.exec(e);let a=r.keys.length;for(;a--;)n[r.keys[a]]=void 0===o[a]?null:o[a];return("https"===n.scheme&&"443"===n.port||"http"===n.scheme&&"80"===n.port)&&(n.href=n.href.replace(":"+n.port,""),n.authority=n.authority.replace(":"+n.port,""),n.port=null),n.normalizedPath=pe.removeDotSegments(n.path),n},pe.prependBase=(e,t)=>{if(null===e)return t;if(pe.isAbsolute(t))return t;e&&!Q.isString(e)||(e=pe.parse(e||""));const n=pe.parse(t),r={protocol:e.protocol||""};if(null!==n.authority)r.authority=n.authority,r.path=n.path,r.query=n.query;else if(r.authority=e.authority,""===n.path)r.path=e.path,null!==n.query?r.query=n.query:r.query=e.query;else{if(0===n.path.indexOf("/"))r.path=n.path;else{let t=e.path;t=t.substr(0,t.lastIndexOf("/")+1),(t.length>0||e.authority)&&"/"!==t.substr(-1)&&(t+="/"),t+=n.path,r.path=t}r.query=n.query}""!==n.path&&(r.path=pe.removeDotSegments(r.path));let o=r.protocol;return null!==r.authority&&(o+="//"+r.authority),o+=r.path,null!==r.query&&(o+="?"+r.query),null!==n.fragment&&(o+="#"+n.fragment),""===o&&(o="./"),o},pe.removeBase=(e,t)=>{if(null===e)return t;e&&!Q.isString(e)||(e=pe.parse(e||""));let n="";if(""!==e.href?n+=(e.protocol||"")+"//"+(e.authority||""):t.indexOf("//")&&(n+="//"),0!==t.indexOf(n))return t;const r=pe.parse(t.substr(n.length)),o=e.normalizedPath.split("/"),a=r.normalizedPath.split("/"),i=r.fragment||r.query?0:1;for(;o.length>0&&a.length>i&&o[0]===a[0];)o.shift(),a.shift();let s="";if(o.length>0){o.pop();for(let e=0;e<o.length;++e)s+="../"}return s+=a.join("/"),null!==r.query&&(s+="?"+r.query),null!==r.fragment&&(s+="#"+r.fragment),""===s&&(s="./"),s},pe.removeDotSegments=e=>{if(0===e.length)return"";const t=e.split("/"),n=[];for(;t.length>0;){const e=t.shift(),r=0===t.length;"."!==e?".."!==e?n.push(e):(n.pop(),r&&n.push("")):r&&n.push("")}return"/"===e[0]&&n.length>0&&""!==n[0]&&n.unshift(""),1===n.length&&""===n[0]?"/":n.join("/")};const he=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^\s]*$/;pe.isAbsolute=e=>Q.isString(e)&&he.test(e),pe.isRelative=e=>Q.isString(e);var ye="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function ge(e,t){return e(t={exports:{}},t.exports),t.exports}var ve=function(e){if(!/^data:/i.test(e))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');const t=(e=e.replace(/\r?\n/g,"")).indexOf(",");if(-1===t||t<=4)throw new TypeError("malformed data: URI");const n=e.substring(5,t).split(";");let r="",o=!1;const a=n[0]||"text/plain";let i=a;for(let e=1;e<n.length;e++)"base64"===n[e]?o=!0:(i+=";"+n[e],0===n[e].indexOf("charset=")&&(r=n[e].substring(8)));n[0]||r.length||(i+=";charset=US-ASCII",r="US-ASCII");const s=o?"base64":"ascii",l=unescape(e.substring(t+1)),c=Buffer.from(l,s);return c.type=a,c.typeFull=i,c.charset=r,c};const{Readable:me}=b.default,be=new WeakMap;class we{constructor(e=[],t={}){let n=0;const r=e.map(e=>{let t;return t=e instanceof Buffer?e:ArrayBuffer.isView(e)?Buffer.from(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?Buffer.from(e):e instanceof we?e:Buffer.from("string"==typeof e?e:String(e)),n+=t.length||t.size||0,t}),o=void 0===t.type?"":String(t.type).toLowerCase();be.set(this,{type:/[^\u0020-\u007E]/.test(o)?"":o,size:n,parts:r})}get size(){return be.get(this).size}get type(){return be.get(this).type}async text(){return Buffer.from(await this.arrayBuffer()).toString()}async arrayBuffer(){const e=new Uint8Array(this.size);let t=0;for await(const n of this.stream())e.set(n,t),t+=n.length;return e.buffer}stream(){return me.from(async function*(e){for(const t of e)"stream"in t?yield*t.stream():yield t}(be.get(this).parts))}slice(e=0,t=this.size,n=""){const{size:r}=this;let o=e<0?Math.max(r+e,0):Math.min(e,r),a=t<0?Math.max(r+t,0):Math.min(t,r);const i=Math.max(a-o,0),s=be.get(this).parts.values(),l=[];let c=0;for(const e of s){const t=ArrayBuffer.isView(e)?e.byteLength:e.size;if(o&&t<=o)o-=t,a-=t;else{const n=e.slice(o,Math.min(t,a));if(l.push(n),c+=ArrayBuffer.isView(n)?n.byteLength:n.size,o=0,c>=i)break}}const u=new we([],{type:String(n).toLowerCase()});return Object.assign(be.get(u),{size:i,parts:l}),u}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](e){return e&&"object"==typeof e&&"function"==typeof e.stream&&0===e.stream.length&&"function"==typeof e.constructor&&/^(Blob|File)$/.test(e[Symbol.toStringTag])}}Object.defineProperties(we.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});var xe=we;class je extends Error{constructor(e,t){super(e),Error.captureStackTrace(this,this.constructor),this.type=t}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}}class Se extends je{constructor(e,t,n){super(e,t),n&&(this.code=this.errno=n.code,this.erroredSysCall=n.syscall)}}const Ie=Symbol.toStringTag,Oe=e=>"object"==typeof e&&"function"==typeof e.append&&"function"==typeof e.delete&&"function"==typeof e.get&&"function"==typeof e.getAll&&"function"==typeof e.has&&"function"==typeof e.set&&"function"==typeof e.sort&&"URLSearchParams"===e[Ie],ke=e=>"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&"function"==typeof e.constructor&&/^(Blob|File)$/.test(e[Ie]);function Ne(e){return"object"==typeof e&&"function"==typeof e.append&&"function"==typeof e.set&&"function"==typeof e.get&&"function"==typeof e.getAll&&"function"==typeof e.delete&&"function"==typeof e.keys&&"function"==typeof e.values&&"function"==typeof e.entries&&"function"==typeof e.constructor&&"FormData"===e[Ie]}const Ce="-".repeat(2),Ae=Buffer.byteLength("\r\n"),Ee=e=>`${Ce}${e}${Ce}${"\r\n".repeat(2)}`;function Te(e,t,n){let r="";return r+=`${Ce}${e}\r\n`,r+=`Content-Disposition: form-data; name="${t}"`,ke(n)&&(r+=`; filename="${n.name}"\r\n`,r+="Content-Type: "+(n.type||"application/octet-stream")),`${r}${"\r\n".repeat(2)}`}const Re=Symbol("Body internals");class Le{constructor(e,{size:t=0}={}){let n=null;null===e?e=null:Oe(e)?e=Buffer.from(e.toString()):ke(e)||Buffer.isBuffer(e)||(c.types.isAnyArrayBuffer(e)?e=Buffer.from(e):ArrayBuffer.isView(e)?e=Buffer.from(e.buffer,e.byteOffset,e.byteLength):e instanceof b.default||(Ne(e)?(n="NodeFetchFormDataBoundary"+r.randomBytes(8).toString("hex"),e=b.default.Readable.from(async function*(e,t){for(const[n,r]of e)yield Te(t,n,r),ke(r)?yield*r.stream():yield r,yield"\r\n";yield Ee(t)}(e,n))):e=Buffer.from(String(e)))),this[Re]={body:e,boundary:n,disturbed:!1,error:null},this.size=t,e instanceof b.default&&e.on("error",e=>{const t=e instanceof je?e:new Se(`Invalid response body while trying to fetch ${this.url}: ${e.message}`,"system",e);this[Re].error=t})}get body(){return this[Re].body}get bodyUsed(){return this[Re].disturbed}async arrayBuffer(){const{buffer:e,byteOffset:t,byteLength:n}=await De(this);return e.slice(t,t+n)}async blob(){const e=this.headers&&this.headers.get("content-type")||this[Re].body&&this[Re].body.type||"",t=await this.buffer();return new xe([t],{type:e})}async json(){const e=await De(this);return JSON.parse(e.toString())}async text(){return(await De(this)).toString()}buffer(){return De(this)}}async function De(e){if(e[Re].disturbed)throw new TypeError("body used already for: "+e.url);if(e[Re].disturbed=!0,e[Re].error)throw e[Re].error;let{body:t}=e;if(null===t)return Buffer.alloc(0);if(ke(t)&&(t=t.stream()),Buffer.isBuffer(t))return t;if(!(t instanceof b.default))return Buffer.alloc(0);const n=[];let r=0;try{for await(const o of t){if(e.size>0&&r+o.length>e.size){const n=new Se(`content size at ${e.url} over limit: ${e.size}`,"max-size");throw t.destroy(n),n}r+=o.length,n.push(o)}}catch(t){throw t instanceof je?t:new Se(`Invalid response body while trying to fetch ${e.url}: ${t.message}`,"system",t)}if(!0!==t.readableEnded&&!0!==t._readableState.ended)throw new Se("Premature close of server response while trying to fetch "+e.url);try{return n.every(e=>"string"==typeof e)?Buffer.from(n.join("")):Buffer.concat(n,r)}catch(t){throw new Se(`Could not create Buffer from response body for ${e.url}: ${t.message}`,"system",t)}}Object.defineProperties(Le.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}});const Pe=(e,t)=>{let n,r,{body:o}=e;if(e.bodyUsed)throw new Error("cannot clone body after it is used");return o instanceof b.default&&"function"!=typeof o.getBoundary&&(n=new l.PassThrough({highWaterMark:t}),r=new l.PassThrough({highWaterMark:t}),o.pipe(n),o.pipe(r),e[Re].body=n,o=r),o},_e=(e,t)=>null===e?null:"string"==typeof e?"text/plain;charset=UTF-8":Oe(e)?"application/x-www-form-urlencoded;charset=UTF-8":ke(e)?e.type||null:Buffer.isBuffer(e)||c.types.isAnyArrayBuffer(e)||ArrayBuffer.isView(e)?null:e&&"function"==typeof e.getBoundary?"multipart/form-data;boundary="+e.getBoundary():Ne(e)?"multipart/form-data; boundary="+t[Re].boundary:e instanceof b.default?null:"text/plain;charset=UTF-8",Be=e=>{const{body:t}=e;return null===t?0:ke(t)?t.size:Buffer.isBuffer(t)?t.length:t&&"function"==typeof t.getLengthSync?t.hasKnownLength&&t.hasKnownLength()?t.getLengthSync():null:Ne(t)?function(e,t){let n=0;for(const[r,o]of e)n+=Buffer.byteLength(Te(t,r,o)),ke(o)?n+=o.size:n+=Buffer.byteLength(String(o)),n+=Ae;return n+=Buffer.byteLength(Ee(t)),n}(e[Re].boundary):null},Me="function"==typeof v.default.validateHeaderName?v.default.validateHeaderName:e=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(e)){const t=new TypeError(`Header name must be a valid HTTP token [${e}]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),t}},Ue="function"==typeof v.default.validateHeaderValue?v.default.validateHeaderValue:(e,t)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(t)){const t=new TypeError(`Invalid character in header content ["${e}"]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_CHAR"}),t}};class qe extends URLSearchParams{constructor(e){let t=[];if(e instanceof qe){const n=e.raw();for(const[e,r]of Object.entries(n))t.push(...r.map(t=>[e,t]))}else if(null==e);else{if("object"!=typeof e||c.types.isBoxedPrimitive(e))throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");{const n=e[Symbol.iterator];if(null==n)t.push(...Object.entries(e));else{if("function"!=typeof n)throw new TypeError("Header pairs must be iterable");t=[...e].map(e=>{if("object"!=typeof e||c.types.isBoxedPrimitive(e))throw new TypeError("Each header pair must be an iterable object");return[...e]}).map(e=>{if(2!==e.length)throw new TypeError("Each header pair must be a name/value tuple");return[...e]})}}}return t=t.length>0?t.map(([e,t])=>(Me(e),Ue(e,String(t)),[String(e).toLowerCase(),String(t)])):void 0,super(t),new Proxy(this,{get(e,t,n){switch(t){case"append":case"set":return(e,r)=>(Me(e),Ue(e,String(r)),URLSearchParams.prototype[t].call(n,String(e).toLowerCase(),String(r)));case"delete":case"has":case"getAll":return e=>(Me(e),URLSearchParams.prototype[t].call(n,String(e).toLowerCase()));case"keys":return()=>(e.sort(),new Set(URLSearchParams.prototype.keys.call(e)).keys());default:return Reflect.get(e,t,n)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(e){const t=this.getAll(e);if(0===t.length)return null;let n=t.join(", ");return/^content-encoding$/i.test(e)&&(n=n.toLowerCase()),n}forEach(e){for(const t of this.keys())e(this.get(t),t)}*values(){for(const e of this.keys())yield this.get(e)}*entries(){for(const e of this.keys())yield[e,this.get(e)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((e,t)=>(e[t]=this.getAll(t),e),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((e,t)=>{const n=this.getAll(t);return e[t]="host"===t?n[0]:n.length>1?n:n[0],e},{})}}Object.defineProperties(qe.prototype,["get","entries","forEach","values"].reduce((e,t)=>(e[t]={enumerable:!0},e),{}));const ze=new Set([301,302,303,307,308]),Fe=e=>ze.has(e),Je=Symbol("Response internals");class He extends Le{constructor(e=null,t={}){super(e,t);const n=t.status||200,r=new qe(t.headers);if(null!==e&&!r.has("Content-Type")){const t=_e(e);t&&r.append("Content-Type",t)}this[Je]={url:t.url,status:n,statusText:t.statusText||"",headers:r,counter:t.counter,highWaterMark:t.highWaterMark}}get url(){return this[Je].url||""}get status(){return this[Je].status}get ok(){return this[Je].status>=200&&this[Je].status<300}get redirected(){return this[Je].counter>0}get statusText(){return this[Je].statusText}get headers(){return this[Je].headers}get highWaterMark(){return this[Je].highWaterMark}clone(){return new He(Pe(this,this.highWaterMark),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size})}static redirect(e,t=302){if(!Fe(t))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new He(null,{headers:{location:new URL(e).toString()},status:t})}get[Symbol.toStringTag](){return"Response"}}Object.defineProperties(He.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});const $e=Symbol("Request internals"),Ve=e=>"object"==typeof e&&"object"==typeof e[$e];class Ge extends Le{constructor(e,t={}){let n;Ve(e)?n=new URL(e.url):(n=new URL(e),e={});let r=t.method||e.method||"GET";if(r=r.toUpperCase(),(null!=t.body||Ve(e))&&null!==e.body&&("GET"===r||"HEAD"===r))throw new TypeError("Request with GET/HEAD method cannot have body");const o=t.body?t.body:Ve(e)&&null!==e.body?Pe(e):null;super(o,{size:t.size||e.size||0});const a=new qe(t.headers||e.headers||{});if(null!==o&&!a.has("Content-Type")){const e=_e(o,this);e&&a.append("Content-Type",e)}let i=Ve(e)?e.signal:null;if("signal"in t&&(i=t.signal),null!==i&&("object"!=typeof(s=i)||"AbortSignal"!==s[Ie]))throw new TypeError("Expected signal to be an instanceof AbortSignal");var s;this[$e]={method:r,redirect:t.redirect||e.redirect||"follow",headers:a,parsedURL:n,signal:i},this.follow=void 0===t.follow?void 0===e.follow?20:e.follow:t.follow,this.compress=void 0===t.compress?void 0===e.compress||e.compress:t.compress,this.counter=t.counter||e.counter||0,this.agent=t.agent||e.agent,this.highWaterMark=t.highWaterMark||e.highWaterMark||16384,this.insecureHTTPParser=t.insecureHTTPParser||e.insecureHTTPParser||!1}get method(){return this[$e].method}get url(){return u.format(this[$e].parsedURL)}get headers(){return this[$e].headers}get redirect(){return this[$e].redirect}get signal(){return this[$e].signal}clone(){return new Ge(this)}get[Symbol.toStringTag](){return"Request"}}Object.defineProperties(Ge.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}});class We extends je{constructor(e,t="aborted"){super(e,t)}}const Ze=new Set(["data:","http:","https:"]);async function Ke(e,t){return new Promise((n,r)=>{const o=new Ge(e,t),a=(e=>{const{parsedURL:t}=e[$e],n=new qe(e[$e].headers);n.has("Accept")||n.set("Accept","*/*");let r=null;if(null===e.body&&/^(post|put)$/i.test(e.method)&&(r="0"),null!==e.body){const t=Be(e);"number"!=typeof t||Number.isNaN(t)||(r=String(t))}r&&n.set("Content-Length",r),n.has("User-Agent")||n.set("User-Agent","node-fetch"),e.compress&&!n.has("Accept-Encoding")&&n.set("Accept-Encoding","gzip,deflate,br");let{agent:o}=e;"function"==typeof o&&(o=o(t)),n.has("Connection")||o||n.set("Connection","close");const a=(e=>{if(e.search)return e.search;const t=e.href.length-1,n=e.hash||("#"===e.href[t]?"#":"");return"?"===e.href[t-n.length]?"?":""})(t);return{path:t.pathname+a,pathname:t.pathname,hostname:t.hostname,protocol:t.protocol,port:t.port,hash:t.hash,search:t.search,query:t.query,href:t.href,method:e.method,headers:n[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:e.insecureHTTPParser,agent:o}})(o);if(!Ze.has(a.protocol))throw new TypeError(`node-fetch cannot load ${e}. URL scheme "${a.protocol.replace(/:$/,"")}" is not supported.`);if("data:"===a.protocol){const e=ve(o.url),t=new He(e,{headers:{"Content-Type":e.typeFull}});return void n(t)}const i=("https:"===a.protocol?g.default:v.default).request,{signal:s}=o;let c=null;const u=()=>{const e=new We("The operation was aborted.");r(e),o.body&&o.body instanceof b.default.Readable&&o.body.destroy(e),c&&c.body&&c.body.emit("error",e)};if(s&&s.aborted)return void u();const d=()=>{u(),f()},p=i(a);s&&s.addEventListener("abort",d);const f=()=>{p.abort(),s&&s.removeEventListener("abort",d)};p.on("error",e=>{r(new Se(`request to ${o.url} failed, reason: ${e.message}`,"system",e)),f()}),p.on("response",e=>{p.setTimeout(0);const a=function(e=[]){return new qe(e.reduce((e,t,n,r)=>(n%2==0&&e.push(r.slice(n,n+2)),e),[]).filter(([e,t])=>{try{return Me(e),Ue(e,String(t)),!0}catch{return!1}}))}(e.rawHeaders);if(Fe(e.statusCode)){const i=a.get("Location"),s=null===i?null:new URL(i,o.url);switch(o.redirect){case"error":return r(new Se("uri requested responds with a redirect, redirect mode is set to error: "+o.url,"no-redirect")),void f();case"manual":if(null!==s)try{a.set("Location",s)}catch(e){r(e)}break;case"follow":{if(null===s)break;if(o.counter>=o.follow)return r(new Se("maximum redirect reached at: "+o.url,"max-redirect")),void f();const a={headers:new qe(o.headers),follow:o.follow,counter:o.counter+1,agent:o.agent,compress:o.compress,method:o.method,body:o.body,signal:o.signal,size:o.size};return 303!==e.statusCode&&o.body&&t.body instanceof b.default.Readable?(r(new Se("Cannot follow redirect with body being a readable stream","unsupported-redirect")),void f()):(303!==e.statusCode&&(301!==e.statusCode&&302!==e.statusCode||"POST"!==o.method)||(a.method="GET",a.body=void 0,a.headers.delete("content-length")),n(Ke(new Ge(s,a))),void f())}}}e.once("end",()=>{s&&s.removeEventListener("abort",d)});let i=l.pipeline(e,new l.PassThrough,e=>{r(e)});process.version<"v12.10"&&e.on("aborted",d);const u={url:o.url,status:e.statusCode,statusText:e.statusMessage,headers:a,size:o.size,counter:o.counter,highWaterMark:o.highWaterMark},h=a.get("Content-Encoding");if(!o.compress||"HEAD"===o.method||null===h||204===e.statusCode||304===e.statusCode)return c=new He(i,u),void n(c);const y={flush:m.default.Z_SYNC_FLUSH,finishFlush:m.default.Z_SYNC_FLUSH};if("gzip"===h||"x-gzip"===h)return i=l.pipeline(i,m.default.createGunzip(y),e=>{r(e)}),c=new He(i,u),void n(c);if("deflate"!==h&&"x-deflate"!==h){if("br"===h)return i=l.pipeline(i,m.default.createBrotliDecompress(),e=>{r(e)}),c=new He(i,u),void n(c);c=new He(i,u),n(c)}else{l.pipeline(e,new l.PassThrough,e=>{r(e)}).once("data",e=>{i=8==(15&e[0])?l.pipeline(i,m.default.createInflate(),e=>{r(e)}):l.pipeline(i,m.default.createInflateRaw(),e=>{r(e)}),c=new He(i,u),n(c)})}}),((e,{body:t})=>{null===t?e.end():ke(t)?t.stream().pipe(e):Buffer.isBuffer(t)?(e.write(t),e.end()):t.pipe(e)})(p,o)})}const Qe=new WeakMap,Xe=new WeakMap;function Ye(e){const t=Qe.get(e);return console.assert(null!=t,"'this' is expected an Event object, but got",e),t}function et(e){null==e.passiveListener?e.event.cancelable&&(e.canceled=!0,"function"==typeof e.event.preventDefault&&e.event.preventDefault()):"undefined"!=typeof console&&"function"==typeof console.error&&console.error("Unable to preventDefault inside passive event listener invocation.",e.passiveListener)}function tt(e,t){Qe.set(this,{eventTarget:e,event:t,eventPhase:2,currentTarget:e,canceled:!1,stopped:!1,immediateStopped:!1,passiveListener:null,timeStamp:t.timeStamp||Date.now()}),Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});const n=Object.keys(t);for(let e=0;e<n.length;++e){const t=n[e];t in this||Object.defineProperty(this,t,nt(t))}}function nt(e){return{get(){return Ye(this).event[e]},set(t){Ye(this).event[e]=t},configurable:!0,enumerable:!0}}function rt(e){return{value(){const t=Ye(this).event;return t[e].apply(t,arguments)},configurable:!0,enumerable:!0}}function ot(e){if(null==e||e===Object.prototype)return tt;let t=Xe.get(e);return null==t&&(t=function(e,t){const n=Object.keys(t);if(0===n.length)return e;function r(t,n){e.call(this,t,n)}r.prototype=Object.create(e.prototype,{constructor:{value:r,configurable:!0,writable:!0}});for(let o=0;o<n.length;++o){const a=n[o];if(!(a in e.prototype)){const e="function"==typeof Object.getOwnPropertyDescriptor(t,a).value;Object.defineProperty(r.prototype,a,e?rt(a):nt(a))}}return r}(ot(Object.getPrototypeOf(e)),e),Xe.set(e,t)),t}function at(e){return Ye(e).immediateStopped}function it(e,t){Ye(e).passiveListener=t}tt.prototype={get type(){return Ye(this).event.type},get target(){return Ye(this).eventTarget},get currentTarget(){return Ye(this).currentTarget},composedPath(){const e=Ye(this).currentTarget;return null==e?[]:[e]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return Ye(this).eventPhase},stopPropagation(){const e=Ye(this);e.stopped=!0,"function"==typeof e.event.stopPropagation&&e.event.stopPropagation()},stopImmediatePropagation(){const e=Ye(this);e.stopped=!0,e.immediateStopped=!0,"function"==typeof e.event.stopImmediatePropagation&&e.event.stopImmediatePropagation()},get bubbles(){return Boolean(Ye(this).event.bubbles)},get cancelable(){return Boolean(Ye(this).event.cancelable)},preventDefault(){et(Ye(this))},get defaultPrevented(){return Ye(this).canceled},get composed(){return Boolean(Ye(this).event.composed)},get timeStamp(){return Ye(this).timeStamp},get srcElement(){return Ye(this).eventTarget},get cancelBubble(){return Ye(this).stopped},set cancelBubble(e){if(!e)return;const t=Ye(this);t.stopped=!0,"boolean"==typeof t.event.cancelBubble&&(t.event.cancelBubble=!0)},get returnValue(){return!Ye(this).canceled},set returnValue(e){e||et(Ye(this))},initEvent(){}},Object.defineProperty(tt.prototype,"constructor",{value:tt,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.Event&&(Object.setPrototypeOf(tt.prototype,window.Event.prototype),Xe.set(window.Event.prototype,tt));const st=new WeakMap;function lt(e){return null!==e&&"object"==typeof e}function ct(e){const t=st.get(e);if(null==t)throw new TypeError("'this' is expected an EventTarget object, but got another value.");return t}function ut(e,t){Object.defineProperty(e,"on"+t,function(e){return{get(){let t=ct(this).get(e);for(;null!=t;){if(3===t.listenerType)return t.listener;t=t.next}return null},set(t){"function"==typeof t||lt(t)||(t=null);const n=ct(this);let r=null,o=n.get(e);for(;null!=o;)3===o.listenerType?null!==r?r.next=o.next:null!==o.next?n.set(e,o.next):n.delete(e):r=o,o=o.next;if(null!==t){const o={listener:t,listenerType:3,passive:!1,once:!1,next:null};null===r?n.set(e,o):r.next=o}},configurable:!0,enumerable:!0}}(t))}function dt(e){function t(){pt.call(this)}t.prototype=Object.create(pt.prototype,{constructor:{value:t,configurable:!0,writable:!0}});for(let n=0;n<e.length;++n)ut(t.prototype,e[n]);return t}function pt(){if(!(this instanceof pt)){if(1===arguments.length&&Array.isArray(arguments[0]))return dt(arguments[0]);if(arguments.length>0){const e=new Array(arguments.length);for(let t=0;t<arguments.length;++t)e[t]=arguments[t];return dt(e)}throw new TypeError("Cannot call a class as a function")}st.set(this,new Map)}pt.prototype={addEventListener(e,t,n){if(null==t)return;if("function"!=typeof t&&!lt(t))throw new TypeError("'listener' should be a function or an object.");const r=ct(this),o=lt(n),a=(o?Boolean(n.capture):Boolean(n))?1:2,i={listener:t,listenerType:a,passive:o&&Boolean(n.passive),once:o&&Boolean(n.once),next:null};let s=r.get(e);if(void 0===s)return void r.set(e,i);let l=null;for(;null!=s;){if(s.listener===t&&s.listenerType===a)return;l=s,s=s.next}l.next=i},removeEventListener(e,t,n){if(null==t)return;const r=ct(this),o=(lt(n)?Boolean(n.capture):Boolean(n))?1:2;let a=null,i=r.get(e);for(;null!=i;){if(i.listener===t&&i.listenerType===o)return void(null!==a?a.next=i.next:null!==i.next?r.set(e,i.next):r.delete(e));a=i,i=i.next}},dispatchEvent(e){if(null==e||"string"!=typeof e.type)throw new TypeError('"event.type" should be a string.');const t=ct(this),n=e.type;let r=t.get(n);if(null==r)return!0;const o=function(e,t){return new(ot(Object.getPrototypeOf(t)))(e,t)}(this,e);let a=null;for(;null!=r;){if(r.once?null!==a?a.next=r.next:null!==r.next?t.set(n,r.next):t.delete(n):a=r,it(o,r.passive?r.listener:null),"function"==typeof r.listener)try{r.listener.call(this,o)}catch(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e)}else 3!==r.listenerType&&"function"==typeof r.listener.handleEvent&&r.listener.handleEvent(o);if(at(o))break;r=r.next}return it(o,null),function(e,t){Ye(e).eventPhase=t}(o,0),function(e,t){Ye(e).currentTarget=t}(o,null),!o.defaultPrevented}},Object.defineProperty(pt.prototype,"constructor",{value:pt,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.EventTarget&&Object.setPrototypeOf(pt.prototype,window.EventTarget.prototype);class ft extends pt{constructor(){throw super(),new TypeError("AbortSignal cannot be constructed directly")}get aborted(){const e=ht.get(this);if("boolean"!=typeof e)throw new TypeError("Expected 'this' to be an 'AbortSignal' object, but got "+(null===this?"null":typeof this));return e}}ut(ft.prototype,"abort");const ht=new WeakMap;Object.defineProperties(ft.prototype,{aborted:{enumerable:!0}}),"function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(ft.prototype,Symbol.toStringTag,{configurable:!0,value:"AbortSignal"});class yt{constructor(){gt.set(this,function(){const e=Object.create(ft.prototype);return pt.call(e),ht.set(e,!1),e}())}get signal(){return vt(this)}abort(){var e;e=vt(this),!1===ht.get(e)&&(ht.set(e,!0),e.dispatchEvent({type:"abort"}))}}const gt=new WeakMap;function vt(e){const t=gt.get(e);if(null==t)throw new TypeError("Expected 'this' to be an 'AbortController' object, but got "+(null===e?"null":typeof e));return t}Object.defineProperties(yt.prototype,{signal:{enumerable:!0},abort:{enumerable:!0}}),"function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(yt.prototype,Symbol.toStringTag,{configurable:!0,value:"AbortController"});var mt,bt=Object.freeze({__proto__:null,default:yt,AbortController:yt,AbortSignal:ft}),wt=ge((function(e,t){e.exports=function(){
/*! MIT License © Sindre Sorhus */
const e={},t=e=>"undefined"!=typeof self&&self&&e in self?self:"undefined"!=typeof window&&window&&e in window?window:void 0!==ye&&ye&&e in ye?ye:"undefined"!=typeof globalThis&&globalThis?globalThis:void 0,n=["Headers","Request","Response","ReadableStream","fetch","AbortController","FormData"];for(const r of n)Object.defineProperty(e,r,{get(){const e=t(r),n=e&&e[r];return"function"==typeof n?n.bind(e):n}});const r=e=>null!==e&&"object"==typeof e,o="function"==typeof e.AbortController,a="function"==typeof e.ReadableStream,i="function"==typeof e.FormData,s=(t,n)=>{const r=new e.Headers(t||{}),o=n instanceof e.Headers,a=new e.Headers(n||{});for(const[e,t]of a)o&&"undefined"===t||void 0===t?r.delete(e):r.set(e,t);return r},l=(...e)=>{let t={},n={};for(const o of e){if(Array.isArray(o))Array.isArray(t)||(t=[]),t=[...t,...o];else if(r(o)){for(let[e,n]of Object.entries(o))r(n)&&e in t&&(n=l(t[e],n)),t={...t,[e]:n};r(o.headers)&&(n=s(n,o.headers))}t.headers=n}return t},c=["get","post","put","patch","head","delete"],u={json:"application/json",text:"text/*",formData:"multipart/form-data",arrayBuffer:"*/*",blob:"*/*"},d=[413,429,503],p=Symbol("stop");class f extends Error{constructor(e){super(e.statusText||String(0===e.status||e.status?e.status:"Unknown response error")),this.name="HTTPError",this.response=e}}class h extends Error{constructor(e){super("Request timed out"),this.name="TimeoutError",this.request=e}}const y=e=>new Promise(t=>setTimeout(t,e)),g=e=>c.includes(e)?e.toUpperCase():e,v={limit:2,methods:["get","put","head","delete","options","trace"],statusCodes:[408,413,429,500,502,503,504],afterStatusCodes:d},m=(e={})=>{if("number"==typeof e)return{...v,limit:e};if(e.methods&&!Array.isArray(e.methods))throw new Error("retry.methods must be an array");if(e.statusCodes&&!Array.isArray(e.statusCodes))throw new Error("retry.statusCodes must be an array");return{...v,...e,afterStatusCodes:d}};class b{constructor(t,n={}){if(this._retryCount=0,this._input=t,this._options={credentials:this._input.credentials||"same-origin",...n,headers:s(this._input.headers,n.headers),hooks:l({beforeRequest:[],beforeRetry:[],afterResponse:[]},n.hooks),method:g(n.method||this._input.method),prefixUrl:String(n.prefixUrl||""),retry:m(n.retry),throwHttpErrors:!1!==n.throwHttpErrors,timeout:void 0===n.timeout?1e4:n.timeout,fetch:n.fetch||e.fetch},"string"!=typeof this._input&&!(this._input instanceof URL||this._input instanceof e.Request))throw new TypeError("`input` must be a string, URL, or Request");if(this._options.prefixUrl&&"string"==typeof this._input){if(this._input.startsWith("/"))throw new Error("`input` must not begin with a slash when using `prefixUrl`");this._options.prefixUrl.endsWith("/")||(this._options.prefixUrl+="/"),this._input=this._options.prefixUrl+this._input}if(o&&(this.abortController=new e.AbortController,this._options.signal&&this._options.signal.addEventListener("abort",()=>{this.abortController.abort()}),this._options.signal=this.abortController.signal),this.request=new e.Request(this._input,this._options),this._options.searchParams){const t="?"+new URLSearchParams(this._options.searchParams).toString(),n=this.request.url.replace(/(?:\?.*?)?(?=#|$)/,t);!(i&&this._options.body instanceof e.FormData||this._options.body instanceof URLSearchParams)||this._options.headers&&this._options.headers["content-type"]||this.request.headers.delete("content-type"),this.request=new e.Request(new e.Request(n,this.request),this._options)}void 0!==this._options.json&&(this._options.body=JSON.stringify(this._options.json),this.request.headers.set("content-type","application/json"),this.request=new e.Request(this.request,{body:this._options.body}));const r=async()=>{if(this._options.timeout>2147483647)throw new RangeError("The `timeout` option cannot be greater than 2147483647");await y(1);let t=await this._fetch();for(const n of this._options.hooks.afterResponse){const r=await n(this.request,this._options,this._decorateResponse(t.clone()));r instanceof e.Response&&(t=r)}if(this._decorateResponse(t),!t.ok&&this._options.throwHttpErrors)throw new f(t);if(this._options.onDownloadProgress){if("function"!=typeof this._options.onDownloadProgress)throw new TypeError("The `onDownloadProgress` option must be a function");if(!a)throw new Error("Streams are not supported in your environment. `ReadableStream` is missing.");return this._stream(t.clone(),this._options.onDownloadProgress)}return t},c=this._options.retry.methods.includes(this.request.method.toLowerCase())?this._retry(r):r();for(const[e,t]of Object.entries(u))c[e]=async()=>{this.request.headers.set("accept",this.request.headers.get("accept")||t);const r=(await c).clone();if("json"===e){if(204===r.status)return"";if(n.parseJson)return n.parseJson(await r.text())}return r[e]()};return c}_calculateRetryDelay(e){if(this._retryCount++,this._retryCount<this._options.retry.limit&&!(e instanceof h)){if(e instanceof f){if(!this._options.retry.statusCodes.includes(e.response.status))return 0;const t=e.response.headers.get("Retry-After");if(t&&this._options.retry.afterStatusCodes.includes(e.response.status)){let e=Number(t);return Number.isNaN(e)?e=Date.parse(t)-Date.now():e*=1e3,void 0!==this._options.retry.maxRetryAfter&&e>this._options.retry.maxRetryAfter?0:e}if(413===e.response.status)return 0}return.3*2**(this._retryCount-1)*1e3}return 0}_decorateResponse(e){return this._options.parseJson&&(e.json=async()=>this._options.parseJson(await e.text())),e}async _retry(e){try{return await e()}catch(t){const n=Math.min(this._calculateRetryDelay(t),2147483647);if(0!==n&&this._retryCount>0){await y(n);for(const e of this._options.hooks.beforeRetry)if(await e({request:this.request,options:this._options,error:t,retryCount:this._retryCount})===p)return;return this._retry(e)}if(this._options.throwHttpErrors)throw t}}async _fetch(){for(const e of this._options.hooks.beforeRequest){const t=await e(this.request,this._options);if(t instanceof Request){this.request=t;break}if(t instanceof Response)return t}return!1===this._options.timeout?this._options.fetch(this.request.clone()):((e,t,n)=>new Promise((r,o)=>{const a=setTimeout(()=>{t&&t.abort(),o(new h(e))},n.timeout);n.fetch(e).then(r).catch(o).then(()=>{clearTimeout(a)})}))(this.request.clone(),this.abortController,this._options)}_stream(t,n){const r=Number(t.headers.get("content-length"))||0;let o=0;return new e.Response(new e.ReadableStream({start(e){const a=t.body.getReader();n&&n({percent:0,transferredBytes:0,totalBytes:r},new Uint8Array),async function t(){const{done:i,value:s}=await a.read();i?e.close():(n&&(o+=s.byteLength,n({percent:0===r?0:o/r,transferredBytes:o,totalBytes:r},s)),e.enqueue(s),t())}()}}))}}const w=(...e)=>{for(const t of e)if((!r(t)||Array.isArray(t))&&void 0!==t)throw new TypeError("The `options` argument must be an object");return l({},...e)},x=e=>{const t=(t,n)=>new b(t,w(e,n));for(const n of c)t[n]=(t,r)=>new b(t,w(e,r,{method:n}));return t.HTTPError=f,t.TimeoutError=h,t.create=e=>x(w(e)),t.extend=t=>x(w(e,t)),t.stop=p,t};return x()}()})),xt=(mt=bt)&&mt.default||mt,jt=wt;if(ye.fetch||(ye.fetch=(e,t)=>Ke(e,{highWaterMark:1e7,...t})),ye.Headers||(ye.Headers=Ke.Headers),ye.Request||(ye.Request=Ke.Request),ye.Response||(ye.Response=Ke.Response),ye.AbortController||(ye.AbortController=xt),!ye.ReadableStream)try{ye.ReadableStream=w.default}catch(pa){}var St=jt;
/*!
 * Copyright (c) 2020 Digital Bazaar, Inc. All rights reserved.
 */const It={Accept:"application/ld+json, application/json"},Ot=St.create({headers:It}),kt=new Set(["get","post","push","patch","head","delete"]);async function Nt(e,t,n){let r;try{r=await e.apply(t,n)}catch(e){return async function(e){if(!e.response)throw"Failed to fetch"===e.message&&(e.message=e.message+". Possible CORS error."),e;e.status=e.response.status;const t=e.response.headers.get("content-type");if(t&&t.includes("json")){const t=await e.response.json();e.message=t.message||e.message,e.data=t}throw e}(e)}const{parseBody:o=!0}=n[1]||{};if(o){const e=r.headers.get("content-type");e&&e.includes("json")&&(r.data=await r.json())}return r}var Ct={httpClient:new Proxy(Ot,{apply:Nt,get(e,t){const n=e[t];return kt.has(t)?async function(){return Nt(n,this,arguments)}:n}}),ky:St,DEFAULT_HEADERS:It};const{parseLinkHeader:At,buildHeaders:Et}=se,{LINK_HEADER_CONTEXT:Tt}=ue,{prependBase:Rt}=fe,{httpClient:Lt}=Ct;var Dt=({secure:e,strictSSL:t=!0,maxRedirects:n=-1,headers:r={},httpAgent:o,httpsAgent:a}={strictSSL:!0,maxRedirects:-1,headers:{}})=>{"user-agent"in(r=Et(r))||(r=Object.assign({},r,{"user-agent":"jsonld.js"}));const i=v.default;return(new de).wrapLoader((function(s){return async function s(l,c){const u=l.startsWith("http:"),d=l.startsWith("https:");if(!u&&!d)throw new ee('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:l});if(e&&!d)throw new ee('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:l});let p=null;if(null!==p)return p;let f=null;const{res:h,body:y}=await async function({url:e,headers:t,strictSSL:n,httpAgent:r,httpsAgent:o}){try{const a={headers:t,redirect:"manual"};e.startsWith("https:")?a.agent=o||new g.default.Agent({rejectUnauthorized:n}):r&&(a.agent=r);const i=await Lt.get(e,a);return{res:i,body:i.data}}catch(t){if(t.response)return{res:t.response,body:null};throw new ee("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:e,cause:t})}}({url:l,headers:r,strictSSL:t,httpAgent:o,httpsAgent:a});p={contextUrl:null,documentUrl:l,document:y||null};const v=i.STATUS_CODES[h.status];if(h.status>=400)throw new ee(`URL "${l}" could not be dereferenced: ${v}`,"jsonld.InvalidUrl",{code:"loading document failed",url:l,httpStatusCode:h.status});const m=h.headers.get("link"),b=h.headers.get("content-type");if(m&&"application/ld+json"!==b){const e=At(m),t=e[Tt];if(Array.isArray(t))throw new ee("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:l});t&&(p.contextUrl=t.target),f=e.alternate,f&&"application/ld+json"==f.type&&!(b||"").match(/^application\/(\w*\+)?json$/)&&h.headers.set("location",Rt(l,f.target))}const w=h.headers.get("location");if((f||h.status>=300&&h.status<400)&&w){if(c.length===n)throw new ee("URL could not be dereferenced; there were too many redirects.","jsonld.TooManyRedirects",{code:"loading document failed",url:l,httpStatusCode:h.status,redirects:c});if(-1!==c.indexOf(l))throw new ee("URL could not be dereferenced; infinite redirection was detected.","jsonld.InfiniteRedirectDetected",{code:"recursive context inclusion",url:l,httpStatusCode:h.status,redirects:c});return c.push(l),s(w,c)}return c.push(l),p}(s,[])}))};const Pt={};var _t=Pt;Pt.setupDocumentLoaders=function(e){e.documentLoaders.node=Dt,e.useDocumentLoader("node")},Pt.setupGlobals=function(e){};var Bt=Mt;function Mt(e){var t=this;if(t instanceof Mt||(t=new Mt),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var n=0,r=arguments.length;n<r;n++)t.push(arguments[n]);return t}function Ut(e,t,n){var r=t===e.head?new Ft(n,null,t,e):new Ft(n,t,t.next,e);return null===r.next&&(e.tail=r),null===r.prev&&(e.head=r),e.length++,r}function qt(e,t){e.tail=new Ft(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function zt(e,t){e.head=new Ft(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Ft(e,t,n,r){if(!(this instanceof Ft))return new Ft(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}Mt.Node=Ft,Mt.create=Mt,Mt.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},Mt.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},Mt.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},Mt.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)qt(this,arguments[e]);return this.length},Mt.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)zt(this,arguments[e]);return this.length},Mt.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},Mt.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},Mt.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;null!==n;r++)e.call(t,n.value,r,this),n=n.next},Mt.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;null!==n;r--)e.call(t,n.value,r,this),n=n.prev},Mt.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},Mt.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},Mt.prototype.map=function(e,t){t=t||this;for(var n=new Mt,r=this.head;null!==r;)n.push(e.call(t,r.value,this)),r=r.next;return n},Mt.prototype.mapReverse=function(e,t){t=t||this;for(var n=new Mt,r=this.tail;null!==r;)n.push(e.call(t,r.value,this)),r=r.prev;return n},Mt.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var o=0;null!==r;o++)n=e(n,r.value,o),r=r.next;return n},Mt.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var o=this.length-1;null!==r;o--)n=e(n,r.value,o),r=r.prev;return n},Mt.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},Mt.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},Mt.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new Mt;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=0,o=this.head;null!==o&&r<e;r++)o=o.next;for(;null!==o&&r<t;r++,o=o.next)n.push(o.value);return n},Mt.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new Mt;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=this.length,o=this.tail;null!==o&&r>t;r--)o=o.prev;for(;null!==o&&r>e;r--,o=o.prev)n.push(o.value);return n},Mt.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var r=0,o=this.head;null!==o&&r<e;r++)o=o.next;var a=[];for(r=0;o&&r<t;r++)a.push(o.value),o=this.removeNode(o);null===o&&(o=this.tail),o!==this.head&&o!==this.tail&&(o=o.prev);for(r=0;r<n.length;r++)o=Ut(this,o,n[r]);return a},Mt.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};try{!function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}(Mt)}catch(e){}const Jt=Symbol("max"),Ht=Symbol("length"),$t=Symbol("lengthCalculator"),Vt=Symbol("allowStale"),Gt=Symbol("maxAge"),Wt=Symbol("dispose"),Zt=Symbol("noDisposeOnSet"),Kt=Symbol("lruList"),Qt=Symbol("cache"),Xt=Symbol("updateAgeOnGet"),Yt=()=>1;const en=(e,t,n)=>{const r=e[Qt].get(t);if(r){const t=r.value;if(tn(e,t)){if(rn(e,r),!e[Vt])return}else n&&(e[Xt]&&(r.value.now=Date.now()),e[Kt].unshiftNode(r));return t.value}},tn=(e,t)=>{if(!t||!t.maxAge&&!e[Gt])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[Gt]&&n>e[Gt]},nn=e=>{if(e[Ht]>e[Jt])for(let t=e[Kt].tail;e[Ht]>e[Jt]&&null!==t;){const n=t.prev;rn(e,t),t=n}},rn=(e,t)=>{if(t){const n=t.value;e[Wt]&&e[Wt](n.key,n.value),e[Ht]-=n.length,e[Qt].delete(n.key),e[Kt].removeNode(t)}};class on{constructor(e,t,n,r,o){this.key=e,this.value=t,this.length=n,this.now=r,this.maxAge=o||0}}const an=(e,t,n,r)=>{let o=n.value;tn(e,o)&&(rn(e,n),e[Vt]||(o=void 0)),o&&t.call(r,o.value,o.key,e)};var sn=class{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[Jt]=e.max||1/0;const t=e.length||Yt;if(this[$t]="function"!=typeof t?Yt:t,this[Vt]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[Gt]=e.maxAge||0,this[Wt]=e.dispose,this[Zt]=e.noDisposeOnSet||!1,this[Xt]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[Jt]=e||1/0,nn(this)}get max(){return this[Jt]}set allowStale(e){this[Vt]=!!e}get allowStale(){return this[Vt]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[Gt]=e,nn(this)}get maxAge(){return this[Gt]}set lengthCalculator(e){"function"!=typeof e&&(e=Yt),e!==this[$t]&&(this[$t]=e,this[Ht]=0,this[Kt].forEach(e=>{e.length=this[$t](e.value,e.key),this[Ht]+=e.length})),nn(this)}get lengthCalculator(){return this[$t]}get length(){return this[Ht]}get itemCount(){return this[Kt].length}rforEach(e,t){t=t||this;for(let n=this[Kt].tail;null!==n;){const r=n.prev;an(this,e,n,t),n=r}}forEach(e,t){t=t||this;for(let n=this[Kt].head;null!==n;){const r=n.next;an(this,e,n,t),n=r}}keys(){return this[Kt].toArray().map(e=>e.key)}values(){return this[Kt].toArray().map(e=>e.value)}reset(){this[Wt]&&this[Kt]&&this[Kt].length&&this[Kt].forEach(e=>this[Wt](e.key,e.value)),this[Qt]=new Map,this[Kt]=new Bt,this[Ht]=0}dump(){return this[Kt].map(e=>!tn(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[Kt]}set(e,t,n){if((n=n||this[Gt])&&"number"!=typeof n)throw new TypeError("maxAge must be a number");const r=n?Date.now():0,o=this[$t](t,e);if(this[Qt].has(e)){if(o>this[Jt])return rn(this,this[Qt].get(e)),!1;const a=this[Qt].get(e).value;return this[Wt]&&(this[Zt]||this[Wt](e,a.value)),a.now=r,a.maxAge=n,a.value=t,this[Ht]+=o-a.length,a.length=o,this.get(e),nn(this),!0}const a=new on(e,t,o,r,n);return a.length>this[Jt]?(this[Wt]&&this[Wt](e,t),!1):(this[Ht]+=a.length,this[Kt].unshift(a),this[Qt].set(e,this[Kt].head),nn(this),!0)}has(e){if(!this[Qt].has(e))return!1;const t=this[Qt].get(e).value;return!tn(this,t)}get(e){return en(this,e,!0)}peek(e){return en(this,e,!1)}pop(){const e=this[Kt].tail;return e?(rn(this,e),e.value):null}del(e){rn(this,this[Qt].get(e))}load(e){this.reset();const t=Date.now();for(let n=e.length-1;n>=0;n--){const r=e[n],o=r.e||0;if(0===o)this.set(r.k,r.v);else{const e=o-t;e>0&&this.set(r.k,r.v,e)}}}prune(){this[Qt].forEach((e,t)=>en(this,t,!1))}};var ln=class{constructor({document:e}){this.document=e,this.cache=new sn({max:10})}getProcessed(e){return this.cache.get(e)}setProcessed(e,t){this.cache.set(e,t)}};const{isArray:cn,isObject:un,isString:dn}=Q,{asArray:pn}=se,{prependBase:fn}=fe;var hn=class{constructor({sharedCache:e}){this.perOpCache=new Map,this.sharedCache=e}async resolve({activeCtx:e,context:t,documentLoader:n,base:r,cycles:o=new Set}){t&&un(t)&&t["@context"]&&(t=t["@context"]),t=pn(t);const a=[];for(const i of t){if(dn(i)){let t=this._get(i);t||(t=await this._resolveRemoteContext({activeCtx:e,url:i,documentLoader:n,base:r,cycles:o})),cn(t)?a.push(...t):a.push(t);continue}if(null===i){a.push(new ln({document:null}));continue}un(i)||yn(t);const s=JSON.stringify(i);let l=this._get(s);l||(l=new ln({document:i}),this._cacheResolvedContext({key:s,resolved:l,tag:"static"})),a.push(l)}return a}_get(e){let t=this.perOpCache.get(e);if(!t){const n=this.sharedCache.get(e);n&&(t=n.get("static"),t&&this.perOpCache.set(e,t))}return t}_cacheResolvedContext({key:e,resolved:t,tag:n}){if(this.perOpCache.set(e,t),void 0!==n){let r=this.sharedCache.get(e);r||(r=new Map,this.sharedCache.set(e,r)),r.set(n,t)}return t}async _resolveRemoteContext({activeCtx:e,url:t,documentLoader:n,base:r,cycles:o}){t=fn(r,t);const{context:a,remoteDoc:i}=await this._fetchContext({activeCtx:e,url:t,documentLoader:n,cycles:o});(function e({context:t,base:n}){if(!t)return;const r=t["@context"];if(dn(r))return void(t["@context"]=fn(n,r));if(cn(r)){for(let t=0;t<r.length;++t){const o=r[t];dn(o)?r[t]=fn(n,o):un(o)&&e({context:{"@context":o},base:n})}return}if(!un(r))return;for(const t in r)e({context:r[t],base:n})})({context:a,base:r=i.documentUrl||t});const s=await this.resolve({activeCtx:e,context:a,documentLoader:n,base:r,cycles:o});return this._cacheResolvedContext({key:t,resolved:s,tag:i.tag}),s}async _fetchContext({activeCtx:e,url:t,documentLoader:n,cycles:r}){if(r.size>10)throw new ee("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"json-ld-1.0"===e.processingMode?"loading remote context failed":"context overflow",max:10});if(r.has(t))throw new ee("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"json-ld-1.0"===e.processingMode?"recursive context inclusion":"context overflow",url:t});let o,a;r.add(t);try{a=await n(t),o=a.document||null,dn(o)&&(o=JSON.parse(o))}catch(e){throw new ee("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:t,cause:e})}if(!un(o))throw new ee("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:t});return o="@context"in o?{"@context":o["@context"]}:{"@context":{}},a.contextUrl&&(cn(o["@context"])||(o["@context"]=[o["@context"]]),o["@context"].push(a.contextUrl)),{context:o,remoteDoc:a}}};function yn(e){throw new ee("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:e})}var gn=Z.NQuads;const{isArray:vn,isObject:mn,isString:bn,isUndefined:wn}=Q,{isAbsolute:xn,isRelative:jn,prependBase:Sn}=fe,{asArray:In,compareShortestLeast:On}=se,kn=new Map,Nn=/^@[a-zA-Z]+$/,Cn={};var An=Cn;function En(e,t,n,r,o,a){if(null===t||!bn(t)||Cn.isKeyword(t))return t;if(t.match(Nn))return null;if(r&&r.hasOwnProperty(t)&&!0!==o.get(t)&&Cn.createTermDefinition({activeCtx:e,localCtx:r,term:t,defined:o,options:a}),(n=n||{}).vocab){const n=e.mappings.get(t);if(null===n)return null;if(mn(n)&&"@id"in n)return n["@id"]}const i=t.indexOf(":");if(i>0){const n=t.substr(0,i),s=t.substr(i+1);if("_"===n||0===s.indexOf("//"))return t;r&&r.hasOwnProperty(n)&&Cn.createTermDefinition({activeCtx:e,localCtx:r,term:n,defined:o,options:a});const l=e.mappings.get(n);if(l&&l._prefix)return l["@id"]+s;if(xn(t))return t}if(n.vocab&&"@vocab"in e)return e["@vocab"]+t;if(n.base&&"@base"in e){if(e["@base"])return Sn(Sn(a.base,e["@base"]),t)}else if(n.base)return Sn(a.base,t);return t}Cn.process=async({activeCtx:e,localCtx:t,options:n,propagate:r=!0,overrideProtected:o=!1,cycles:a=new Set})=>{mn(t)&&"@context"in t&&vn(t["@context"])&&(t=t["@context"]);if(0===In(t).length)return e;const i=await n.contextResolver.resolve({activeCtx:e,context:t,documentLoader:n.documentLoader,base:n.base});mn(i[0].document)&&"boolean"==typeof i[0].document["@propagate"]&&(r=i[0].document["@propagate"]);let s=e;r||s.previousContext||(s=s.clone(),s.previousContext=e);for(const r of i){let{document:i}=r;if(e=s,null===i){if(!o&&0!==Object.keys(e.protected).length){const o=n&&n.protectedMode||"error";if("error"===o)throw new ee("Tried to nullify a context with protected terms outside of a term definition.","jsonld.SyntaxError",{code:"invalid context nullification"});if("warn"===o){console.warn("WARNING: invalid context nullification");const t=r.getProcessed(e);if(t){s=e=t;continue}const o=e;s=e=Cn.getInitialContext(n).clone();for(const[t,n]of Object.entries(o.protected))n&&(e.mappings[t]=se.clone(o.mappings[t]));e.protected=se.clone(o.protected),r.setProcessed(o,s);continue}throw new ee("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:t,protectedMode:o})}s=e=Cn.getInitialContext(n).clone();continue}const l=r.getProcessed(e);if(l){s=e=l;continue}if(mn(i)&&"@context"in i&&(i=i["@context"]),!mn(i))throw new ee("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:i});s=s.clone();const c=new Map;if("@version"in i){if(1.1!==i["@version"])throw new ee("Unsupported JSON-LD version: "+i["@version"],"jsonld.UnsupportedVersion",{code:"invalid @version value",context:i});if(e.processingMode&&"json-ld-1.0"===e.processingMode)throw new ee("@version: "+i["@version"]+" not compatible with "+e.processingMode,"jsonld.ProcessingModeConflict",{code:"processing mode conflict",context:i});s.processingMode="json-ld-1.1",s["@version"]=i["@version"],c.set("@version",!0)}if(s.processingMode=s.processingMode||e.processingMode,"@base"in i){let e=i["@base"];if(null===e||xn(e));else{if(!jn(e))throw new ee('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI, a relative IRI, or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:i});e=Sn(s["@base"],e)}s["@base"]=e,c.set("@base",!0)}if("@vocab"in i){const e=i["@vocab"];if(null===e)delete s["@vocab"];else{if(!bn(e))throw new ee('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:i});if(!xn(e)&&Cn.processingMode(s,1))throw new ee('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:i});s["@vocab"]=En(s,e,{vocab:!0,base:!0},void 0,void 0,n)}c.set("@vocab",!0)}if("@language"in i){const e=i["@language"];if(null===e)delete s["@language"];else{if(!bn(e))throw new ee('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:i});s["@language"]=e.toLowerCase()}c.set("@language",!0)}if("@direction"in i){const t=i["@direction"];if("json-ld-1.0"===e.processingMode)throw new ee("Invalid JSON-LD syntax; @direction not compatible with "+e.processingMode,"jsonld.SyntaxError",{code:"invalid context member",context:i});if(null===t)delete s["@direction"];else{if("ltr"!==t&&"rtl"!==t)throw new ee('Invalid JSON-LD syntax; the value of "@direction" in a @context must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:i});s["@direction"]=t}c.set("@direction",!0)}if("@propagate"in i){const n=i["@propagate"];if("json-ld-1.0"===e.processingMode)throw new ee("Invalid JSON-LD syntax; @propagate not compatible with "+e.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:i});if("boolean"!=typeof n)throw new ee("Invalid JSON-LD syntax; @propagate value must be a boolean.","jsonld.SyntaxError",{code:"invalid @propagate value",context:t});c.set("@propagate",!0)}if("@import"in i){const r=i["@import"];if("json-ld-1.0"===e.processingMode)throw new ee("Invalid JSON-LD syntax; @import not compatible with "+e.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:i});if(!bn(r))throw new ee("Invalid JSON-LD syntax; @import must be a string.","jsonld.SyntaxError",{code:"invalid @import value",context:t});const o=await n.contextResolver.resolve({activeCtx:e,context:r,documentLoader:n.documentLoader,base:n.base});if(1!==o.length)throw new ee("Invalid JSON-LD syntax; @import must reference a single context.","jsonld.SyntaxError",{code:"invalid remote context",context:t});const a=o[0].getProcessed(e);if(a)i=a;else{const n=o[0].document;if("@import"in n)throw new ee("Invalid JSON-LD syntax: imported context must not include @import.","jsonld.SyntaxError",{code:"invalid context entry",context:t});for(const e in n)i.hasOwnProperty(e)||(i[e]=n[e]);o[0].setProcessed(e,i)}c.set("@import",!0)}c.set("@protected",i["@protected"]||!1);for(const e in i)if(Cn.createTermDefinition({activeCtx:s,localCtx:i,term:e,defined:c,options:n,overrideProtected:o}),mn(i[e])&&"@context"in i[e]){const t=i[e]["@context"];let r=!0;if(bn(t)){const e=Sn(n.base,t);a.has(e)?r=!1:a.add(e)}if(r)try{await Cn.process({activeCtx:s.clone(),localCtx:i[e]["@context"],overrideProtected:!0,options:n,cycles:a})}catch(t){throw new ee("Invalid JSON-LD syntax; invalid scoped context.","jsonld.SyntaxError",{code:"invalid scoped context",context:i[e]["@context"],term:e})}}r.setProcessed(e,s)}return s},Cn.createTermDefinition=({activeCtx:e,localCtx:t,term:n,defined:r,options:o,overrideProtected:a=!1})=>{if(r.has(n)){if(r.get(n))return;throw new ee("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:t,term:n})}let i;if(r.set(n,!1),t.hasOwnProperty(n)&&(i=t[n]),"@type"===n&&mn(i)&&"@set"===(i["@container"]||"@set")&&Cn.processingMode(e,1.1)){const e=["@container","@id","@protected"],r=Object.keys(i);if(0===r.length||r.some(t=>!e.includes(t)))throw new ee("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:t,term:n})}else{if(Cn.isKeyword(n))throw new ee("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:t,term:n});if(n.match(Nn))return void console.warn('WARNING: terms beginning with "@" are reserved for future use and ignored',{term:n});if(""===n)throw new ee("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:t})}const s=e.mappings.get(n);e.mappings.has(n)&&e.mappings.delete(n);let l=!1;if((bn(i)||null===i)&&(l=!0,i={"@id":i}),!mn(i))throw new ee("Invalid JSON-LD syntax; @context term values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:t});const c={};e.mappings.set(n,c),c.reverse=!1;const u=["@container","@id","@language","@reverse","@type"];Cn.processingMode(e,1.1)&&u.push("@context","@direction","@index","@nest","@prefix","@protected");for(const e in i)if(!u.includes(e))throw new ee("Invalid JSON-LD syntax; a term definition must not contain "+e,"jsonld.SyntaxError",{code:"invalid term definition",context:t});const d=n.indexOf(":");if(c._termHasColon=d>0,"@reverse"in i){if("@id"in i)throw new ee("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});if("@nest"in i)throw new ee("Invalid JSON-LD syntax; a @reverse term definition must not contain @nest.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});const a=i["@reverse"];if(!bn(a))throw new ee("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(!Cn.isKeyword(a)&&a.match(Nn))return console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{reverse:a}),void(s?e.mappings.set(n,s):e.mappings.delete(n));const l=En(e,a,{vocab:!0,base:!1},t,r,o);if(!xn(l))throw new ee("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});c["@id"]=l,c.reverse=!0}else if("@id"in i){let a=i["@id"];if(a&&!bn(a))throw new ee("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(null===a)c["@id"]=null;else{if(!Cn.isKeyword(a)&&a.match(Nn))return console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{id:a}),void(s?e.mappings.set(n,s):e.mappings.delete(n));if(a!==n){if(a=En(e,a,{vocab:!0,base:!1},t,r,o),!xn(a)&&!Cn.isKeyword(a))throw new ee("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(n.match(/(?::[^:])|\//)){if(En(e,n,{vocab:!0,base:!1},t,new Map(r).set(n,!0),o)!==a)throw new ee("Invalid JSON-LD syntax; term in form of IRI must expand to definition.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t})}c["@id"]=a,c._prefix=l&&!c._termHasColon&&a.match(/[:\/\?#\[\]@]$/)}}}if(!("@id"in c))if(c._termHasColon){const a=n.substr(0,d);if(t.hasOwnProperty(a)&&Cn.createTermDefinition({activeCtx:e,localCtx:t,term:a,defined:r,options:o}),e.mappings.has(a)){const t=n.substr(d+1);c["@id"]=e.mappings.get(a)["@id"]+t}else c["@id"]=n}else if("@type"===n)c["@id"]=n;else{if(!("@vocab"in e))throw new ee("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t,term:n});c["@id"]=e["@vocab"]+n}if((!0===i["@protected"]||!0===r.get("@protected")&&!1!==i["@protected"])&&(e.protected[n]=!0,c.protected=!0),r.set(n,!0),"@type"in i){let n=i["@type"];if(!bn(n))throw new ee("Invalid JSON-LD syntax; an @context @type value must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if("@json"===n||"@none"===n){if(Cn.processingMode(e,1))throw new ee(`Invalid JSON-LD syntax; an @context @type value must not be "${n}" in JSON-LD 1.0 mode.`,"jsonld.SyntaxError",{code:"invalid type mapping",context:t})}else if("@id"!==n&&"@vocab"!==n){if(n=En(e,n,{vocab:!0,base:!1},t,r,o),!xn(n))throw new ee("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if(0===n.indexOf("_:"))throw new ee("Invalid JSON-LD syntax; an @context @type value must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:t})}c["@type"]=n}if("@container"in i){const n=bn(i["@container"])?[i["@container"]]:i["@container"]||[],r=["@list","@set","@index","@language"];let o=!0;const a=n.includes("@set");if(Cn.processingMode(e,1.1)){if(r.push("@graph","@id","@type"),n.includes("@list")){if(1!==n.length)throw new ee("Invalid JSON-LD syntax; @context @container with @list must have no other values","jsonld.SyntaxError",{code:"invalid container mapping",context:t})}else if(n.includes("@graph")){if(n.some(e=>"@graph"!==e&&"@id"!==e&&"@index"!==e&&"@set"!==e))throw new ee("Invalid JSON-LD syntax; @context @container with @graph must have no other values other than @id, @index, and @set","jsonld.SyntaxError",{code:"invalid container mapping",context:t})}else o&=n.length<=(a?2:1);if(n.includes("@type")&&(c["@type"]=c["@type"]||"@id",!["@id","@vocab"].includes(c["@type"])))throw new ee("Invalid JSON-LD syntax; container: @type requires @type to be @id or @vocab.","jsonld.SyntaxError",{code:"invalid type mapping",context:t})}else o&=!vn(i["@container"]),o&=n.length<=1;if(o&=n.every(e=>r.includes(e)),o&=!(a&&n.includes("@list")),!o)throw new ee("Invalid JSON-LD syntax; @context @container value must be one of the following: "+r.join(", "),"jsonld.SyntaxError",{code:"invalid container mapping",context:t});if(c.reverse&&!n.every(e=>["@index","@set"].includes(e)))throw new ee("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});c["@container"]=n}if("@index"in i){if(!("@container"in i)||!c["@container"].includes("@index"))throw new ee(`Invalid JSON-LD syntax; @index without @index in @container: "${i["@index"]}" on term "${n}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:t});if(!bn(i["@index"])||0===i["@index"].indexOf("@"))throw new ee(`Invalid JSON-LD syntax; @index must expand to an IRI: "${i["@index"]}" on term "${n}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:t});c["@index"]=i["@index"]}if("@context"in i&&(c["@context"]=i["@context"]),"@language"in i&&!("@type"in i)){let e=i["@language"];if(null!==e&&!bn(e))throw new ee("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:t});null!==e&&(e=e.toLowerCase()),c["@language"]=e}if("@prefix"in i){if(n.match(/:|\//))throw new ee("Invalid JSON-LD syntax; @context @prefix used on a compact IRI term","jsonld.SyntaxError",{code:"invalid term definition",context:t});if(Cn.isKeyword(c["@id"]))throw new ee("Invalid JSON-LD syntax; keywords may not be used as prefixes","jsonld.SyntaxError",{code:"invalid term definition",context:t});if("boolean"!=typeof i["@prefix"])throw new ee("Invalid JSON-LD syntax; @context value for @prefix must be boolean","jsonld.SyntaxError",{code:"invalid @prefix value",context:t});c._prefix=!0===i["@prefix"]}if("@direction"in i){const e=i["@direction"];if(null!==e&&"ltr"!==e&&"rtl"!==e)throw new ee('Invalid JSON-LD syntax; @direction value must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:t});c["@direction"]=e}if("@nest"in i){const e=i["@nest"];if(!bn(e)||"@nest"!==e&&0===e.indexOf("@"))throw new ee("Invalid JSON-LD syntax; @context @nest value must be a string which is not a keyword other than @nest.","jsonld.SyntaxError",{code:"invalid @nest value",context:t});c["@nest"]=e}// disallow aliasing @context and @preserve
const p=c["@id"];if("@context"===p||"@preserve"===p)throw new ee("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:t});if(s&&s.protected&&!a&&(e.protected[n]=!0,c.protected=!0,!function e(t,n){if(!t||"object"!=typeof t||!n||"object"!=typeof n)return t===n;const r=Array.isArray(t);if(r!==Array.isArray(n))return!1;if(r){if(t.length!==n.length)return!1;for(let r=0;r<t.length;++r)if(!e(t[r],n[r]))return!1;return!0}const o=Object.keys(t),a=Object.keys(n);if(o.length!==a.length)return!1;for(const r in t){let o=t[r],a=n[r];if("@container"===r&&Array.isArray(o)&&Array.isArray(a)&&(o=o.slice().sort(),a=a.slice().sort()),!e(o,a))return!1}return!0}(s,c))){const e=o&&o.protectedMode||"error";if("error"===e)throw new ee(`Invalid JSON-LD syntax; tried to redefine "${n}" which is a protected term.`,"jsonld.SyntaxError",{code:"protected term redefinition",context:t,term:n});if("warn"===e)return void console.warn("WARNING: protected term redefinition",{term:n});throw new ee("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:t,term:n,protectedMode:e})}},Cn.expandIri=(e,t,n,r)=>En(e,t,n,void 0,void 0,r),Cn.getInitialContext=e=>{const t=JSON.stringify({processingMode:e.processingMode}),n=kn.get(t);if(n)return n;const r={processingMode:e.processingMode,mappings:new Map,inverse:null,getInverse:function(){const e=this;if(e.inverse)return e.inverse;const t=e.inverse={},n=e.fastCurieMap={},r={},i=(e["@language"]||"@none").toLowerCase(),s=e["@direction"],l=e.mappings,c=[...l.keys()].sort(On);for(const e of c){const o=l.get(e);if(null===o)continue;let c=o["@container"]||"@none";if(c=[].concat(c).sort().join(""),null===o["@id"])continue;const u=In(o["@id"]);for(const l of u){let u=t[l];const d=Cn.isKeyword(l);if(u)d||o._termHasColon||r[l].push(e);else if(t[l]=u={},!d&&!o._termHasColon){r[l]=[e];const t={iri:l,terms:r[l]};l[0]in n?n[l[0]].push(t):n[l[0]]=[t]}if(u[c]||(u[c]={"@language":{},"@type":{},"@any":{}}),u=u[c],a(e,u["@any"],"@none"),o.reverse)a(e,u["@type"],"@reverse");else if("@none"===o["@type"])a(e,u["@any"],"@none"),a(e,u["@language"],"@none"),a(e,u["@type"],"@none");else if("@type"in o)a(e,u["@type"],o["@type"]);else if("@language"in o&&"@direction"in o){const t=o["@language"],n=o["@direction"];a(e,u["@language"],t&&n?`${t}_${n}`.toLowerCase():t?t.toLowerCase():n?"_"+n:"@null")}else"@language"in o?a(e,u["@language"],(o["@language"]||"@null").toLowerCase()):"@direction"in o?o["@direction"]?a(e,u["@language"],"_"+o["@direction"]):a(e,u["@language"],"@none"):s?(a(e,u["@language"],"_"+s),a(e,u["@language"],"@none"),a(e,u["@type"],"@none")):(a(e,u["@language"],i),a(e,u["@language"],"@none"),a(e,u["@type"],"@none"))}}for(const e in n)o(n,e,1);return t},clone:function(){const e={};e.mappings=se.clone(this.mappings),e.clone=this.clone,e.inverse=null,e.getInverse=this.getInverse,e.protected=se.clone(this.protected),this.previousContext&&(e.previousContext=this.previousContext.clone());e.revertToPreviousContext=this.revertToPreviousContext,"@base"in this&&(e["@base"]=this["@base"]);"@language"in this&&(e["@language"]=this["@language"]);"@vocab"in this&&(e["@vocab"]=this["@vocab"]);return e},revertToPreviousContext:function(){if(!this.previousContext)return this;return this.previousContext.clone()},protected:{}};return 1e4===kn.size&&kn.clear(),kn.set(t,r),r;function o(e,t,n){const r=e[t],a=e[t]={};let i,s;for(const e of r)i=e.iri,s=n>=i.length?"":i[n],s in a?a[s].push(e):a[s]=[e];for(const e in a)""!==e&&o(a,e,n+1)}function a(e,t,n){t.hasOwnProperty(n)||(t[n]=e)}},Cn.getContextValue=(e,t,n)=>{if(null===t){if("@context"===n)return;return null}if(e.mappings.has(t)){const r=e.mappings.get(t);if(wn(n))return r;if(r.hasOwnProperty(n))return r[n]}return"@language"===n&&n in e||"@direction"===n&&n in e?e[n]:"@context"!==n?null:void 0},Cn.processingMode=(e,t)=>t.toString()>="1.1"?!e.processingMode||e.processingMode>="json-ld-"+t.toString():"json-ld-1.0"===e.processingMode,Cn.isKeyword=e=>{if(!bn(e)||"@"!==e[0])return!1;switch(e){case"@base":case"@container":case"@context":case"@default":case"@direction":case"@embed":case"@explicit":case"@graph":case"@id":case"@included":case"@index":case"@json":case"@language":case"@list":case"@nest":case"@none":case"@omitDefault":case"@prefix":case"@preserve":case"@protected":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@version":case"@vocab":return!0}return!1};const{isArray:Tn,isObject:Rn,isEmptyObject:Ln,isString:Dn,isUndefined:Pn}=Q,{isList:_n,isValue:Bn,isGraph:Mn,isSubject:Un}=Y,{expandIri:qn,getContextValue:zn,isKeyword:Fn,process:Jn,processingMode:Hn}=An,{isAbsolute:$n}=fe,{addValue:Vn,asArray:Gn,getValues:Wn,validateTypeValue:Zn}=se,Kn={};var Qn=Kn;const Xn=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/;function Yn({activeCtx:e,activeProperty:t,value:n,options:r}){if(null==n)return null;const o=qn(e,t,{vocab:!0},r);if("@id"===o)return qn(e,n,{base:!0},r);if("@type"===o)return qn(e,n,{vocab:!0,base:!0},r);const a=zn(e,t,"@type");if(("@id"===a||"@graph"===o)&&Dn(n))return{"@id":qn(e,n,{base:!0},r)};if("@vocab"===a&&Dn(n))return{"@id":qn(e,n,{vocab:!0,base:!0},r)};if(Fn(o))return n;const i={};if(a&&!["@id","@vocab","@none"].includes(a))i["@type"]=a;else if(Dn(n)){const n=zn(e,t,"@language");null!==n&&(i["@language"]=n);const r=zn(e,t,"@direction");null!==r&&(i["@direction"]=r)}return["boolean","number","string"].includes(typeof n)||(n=n.toString()),i["@value"]=n,i}function er(e,t,n,r){const o=[],a=Object.keys(t).sort();for(const i of a){const a=qn(e,i,{vocab:!0},r);let s=t[i];Tn(s)||(s=[s]);for(const e of s){if(null===e)continue;if(!Dn(e))throw new ee("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:t});const r={"@value":e};"@none"!==a&&(r["@language"]=i.toLowerCase()),n&&(r["@direction"]=n),o.push(r)}}return o}async function tr({activeCtx:e,options:t,activeProperty:n,value:r,expansionMap:o,asGraph:a,indexKey:i,propertyIndex:s}){const l=[],c=Object.keys(r).sort(),u="@type"===i;for(let d of c){if(u){const n=zn(e,d,"@context");Pn(n)||(e=await Jn({activeCtx:e,localCtx:n,propagate:!1,options:t}))}let c,p=r[d];Tn(p)||(p=[p]),p=await Kn.expand({activeCtx:e,activeProperty:n,element:p,options:t,insideList:!1,insideIndex:!0,expansionMap:o}),c=s?"@none"===d?"@none":Yn({activeCtx:e,activeProperty:i,value:d,options:t}):qn(e,d,{vocab:!0},t),"@id"===i?d=qn(e,d,{base:!0},t):u&&(d=c);for(let e of p){if(a&&!Mn(e)&&(e={"@graph":[e]}),"@type"===i)"@none"===c||(e["@type"]?e["@type"]=[d].concat(e["@type"]):e["@type"]=[d]);else{if(Bn(e)&&!["@language","@type","@index"].includes(i))throw new ee(`Invalid JSON-LD syntax; Attempt to add illegal key to value object: "${i}".`,"jsonld.SyntaxError",{code:"invalid value object",value:e});s?"@none"!==c&&Vn(e,s,c,{propertyIsArray:!0,prependValue:!0}):"@none"===c||i in e||(e[i]=d)}l.push(e)}}return l}Kn.expand=async({activeCtx:e,activeProperty:t=null,element:n,options:r={},insideList:o=!1,insideIndex:a=!1,typeScopedContext:i=null,expansionMap:s=(()=>{})})=>{if(null==n)return null;if("@default"===t&&(r=Object.assign({},r,{isFrame:!1})),!Tn(n)&&!Rn(n)){if(!o&&(null===t||"@graph"===qn(e,t,{vocab:!0},r))){const a=await s({unmappedValue:n,activeCtx:e,activeProperty:t,options:r,insideList:o});return void 0===a?null:a}return Yn({activeCtx:e,activeProperty:t,value:n,options:r})}if(Tn(n)){let l=[];const c=zn(e,t,"@container")||[];o=o||c.includes("@list");for(let c=0;c<n.length;++c){let u=await Kn.expand({activeCtx:e,activeProperty:t,element:n[c],options:r,expansionMap:s,insideIndex:a,typeScopedContext:i});o&&Tn(u)&&(u={"@list":u}),null===u&&(u=await s({unmappedValue:n[c],activeCtx:e,activeProperty:t,parent:n,index:c,options:r,expandedParent:l,insideList:o}),void 0===u)||(Tn(u)?l=l.concat(u):l.push(u))}return l}const l=qn(e,t,{vocab:!0},r),c=zn(e,t,"@context");i=i||(e.previousContext?e:null);let u=Object.keys(n).sort(),d=!a;if(d&&i&&u.length<=2&&!u.includes("@context"))for(const t of u){const n=qn(i,t,{vocab:!0},r);if("@value"===n){d=!1,e=i;break}if("@id"===n&&1===u.length){d=!1;break}}d&&(e=e.revertToPreviousContext()),Pn(c)||(e=await Jn({activeCtx:e,localCtx:c,propagate:!0,overrideProtected:!0,options:r})),"@context"in n&&(e=await Jn({activeCtx:e,localCtx:n["@context"],options:r})),i=e;let p=null;for(const t of u){if("@type"===qn(e,t,{vocab:!0},r)){p=p||t;const o=n[t],a=Array.isArray(o)?o.length>1?o.slice().sort():o:[o];for(const t of a){const n=zn(i,t,"@context");Pn(n)||(e=await Jn({activeCtx:e,localCtx:n,options:r,propagate:!1}))}}}let f={};await async function e({activeCtx:t,activeProperty:n,expandedActiveProperty:r,element:o,expandedParent:a,options:i={},insideList:s,typeKey:l,typeScopedContext:c,expansionMap:u}){const d=Object.keys(o).sort(),p=[];let f;const h=o[l]&&"@json"===qn(t,Tn(o[l])?o[l][0]:o[l],{vocab:!0},i);for(const e of d){let l,d=o[e];if("@context"===e)continue;let y=qn(t,e,{vocab:!0},i);if((null===y||!$n(y)&&!Fn(y))&&(y=u({unmappedProperty:e,activeCtx:t,activeProperty:n,parent:o,options:i,insideList:s,value:d,expandedParent:a}),void 0===y))continue;if(Fn(y)){if("@reverse"===r)throw new ee("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:d});if(y in a&&"@included"!==y&&"@type"!==y)throw new ee("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:y})}if("@id"===y){if(!Dn(d)){if(!i.isFrame)throw new ee('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:d});if(Rn(d)){if(!Ln(d))throw new ee('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:d})}else{if(!Tn(d))throw new ee('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:d});if(!d.every(e=>Dn(e)))throw new ee('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:d})}}Vn(a,"@id",Gn(d).map(e=>Dn(e)?qn(t,e,{base:!0},i):e),{propertyIsArray:i.isFrame});continue}if("@type"===y){Rn(d)&&(d=Object.fromEntries(Object.entries(d).map(([e,t])=>[qn(c,e,{vocab:!0}),Gn(t).map(e=>qn(c,e,{base:!0,vocab:!0}))]))),Zn(d,i.isFrame),Vn(a,"@type",Gn(d).map(e=>Dn(e)?qn(c,e,{base:!0,vocab:!0},i):e),{propertyIsArray:i.isFrame});continue}if("@included"===y&&Hn(t,1.1)){const e=Gn(await Kn.expand({activeCtx:t,activeProperty:n,element:d,options:i,expansionMap:u}));if(!e.every(e=>Un(e)))throw new ee("Invalid JSON-LD syntax; values of @included must expand to node objects.","jsonld.SyntaxError",{code:"invalid @included value",value:d});Vn(a,"@included",e,{propertyIsArray:!0});continue}if("@graph"===y&&!Rn(d)&&!Tn(d))throw new ee('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:d});if("@value"===y){f=d,h&&Hn(t,1.1)?a["@value"]=d:Vn(a,"@value",d,{propertyIsArray:i.isFrame});continue}if("@language"===y){if(null===d)continue;if(!Dn(d)&&!i.isFrame)throw new ee('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:d});d=Gn(d).map(e=>Dn(e)?e.toLowerCase():e);for(const e of d)Dn(e)&&!e.match(Xn)&&console.warn("@language must be valid BCP47: "+e);Vn(a,"@language",d,{propertyIsArray:i.isFrame});continue}if("@direction"===y){if(!Dn(d)&&!i.isFrame)throw new ee('Invalid JSON-LD syntax; "@direction" value must be a string.',"jsonld.SyntaxError",{code:"invalid base direction",value:d});d=Gn(d);for(const e of d)if(Dn(e)&&"ltr"!==e&&"rtl"!==e)throw new ee('Invalid JSON-LD syntax; "@direction" must be "ltr" or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",value:d});Vn(a,"@direction",d,{propertyIsArray:i.isFrame});continue}if("@index"===y){if(!Dn(d))throw new ee('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:d});Vn(a,"@index",d);continue}if("@reverse"===y){if(!Rn(d))throw new ee('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:d});if(l=await Kn.expand({activeCtx:t,activeProperty:"@reverse",element:d,options:i,expansionMap:u}),"@reverse"in l)for(const e in l["@reverse"])Vn(a,e,l["@reverse"][e],{propertyIsArray:!0});let e=a["@reverse"]||null;for(const t in l){if("@reverse"===t)continue;null===e&&(e=a["@reverse"]={}),Vn(e,t,[],{propertyIsArray:!0});const n=l[t];for(let r=0;r<n.length;++r){const o=n[r];if(Bn(o)||_n(o))throw new ee('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:l});Vn(e,t,o,{propertyIsArray:!0})}}continue}if("@nest"===y){p.push(e);continue}let g=t;const v=zn(t,e,"@context");Pn(v)||(g=await Jn({activeCtx:t,localCtx:v,propagate:!0,overrideProtected:!0,options:i}));const m=zn(g,e,"@container")||[];if(m.includes("@language")&&Rn(d)){const t=zn(g,e,"@direction");l=er(g,d,t,i)}else if(m.includes("@index")&&Rn(d)){const n=m.includes("@graph"),r=zn(g,e,"@index")||"@index",o="@index"!==r&&qn(t,r,{vocab:!0},i);l=await tr({activeCtx:g,options:i,activeProperty:e,value:d,expansionMap:u,asGraph:n,indexKey:r,propertyIndex:o})}else if(m.includes("@id")&&Rn(d)){const t=m.includes("@graph");l=await tr({activeCtx:g,options:i,activeProperty:e,value:d,expansionMap:u,asGraph:t,indexKey:"@id"})}else if(m.includes("@type")&&Rn(d))l=await tr({activeCtx:g.revertToPreviousContext(),options:i,activeProperty:e,value:d,expansionMap:u,asGraph:!1,indexKey:"@type"});else{const o="@list"===y;if(o||"@set"===y){let e=n;o&&"@graph"===r&&(e=null),l=await Kn.expand({activeCtx:g,activeProperty:e,element:d,options:i,insideList:o,expansionMap:u})}else l="@json"===zn(t,e,"@type")?{"@type":"@json","@value":d}:await Kn.expand({activeCtx:g,activeProperty:e,element:d,options:i,insideList:!1,expansionMap:u})}if(null!==l||"@value"===y||(l=u({unmappedValue:d,expandedProperty:y,activeCtx:g,activeProperty:n,parent:o,options:i,insideList:s,key:e,expandedParent:a}),void 0!==l))if("@list"!==y&&!_n(l)&&m.includes("@list")&&(l={"@list":Gn(l)}),m.includes("@graph")&&!m.some(e=>"@id"===e||"@index"===e)&&(l=Gn(l).map(e=>({"@graph":Gn(e)}))),g.mappings.has(e)&&g.mappings.get(e).reverse){const e=a["@reverse"]=a["@reverse"]||{};l=Gn(l);for(let t=0;t<l.length;++t){const n=l[t];if(Bn(n)||_n(n))throw new ee('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:l});Vn(e,y,n,{propertyIsArray:!0})}}else Vn(a,y,l,{propertyIsArray:!0})}if("@value"in a)if("@json"===a["@type"]&&Hn(t,1.1));else if((Rn(f)||Tn(f))&&!i.isFrame)throw new ee('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:f});for(const d of p){const p=Tn(o[d])?o[d]:[o[d]];for(const o of p){if(!Rn(o)||Object.keys(o).some(e=>"@value"===qn(t,e,{vocab:!0},i)))throw new ee("Invalid JSON-LD syntax; nested value must be a node object.","jsonld.SyntaxError",{code:"invalid @nest value",value:o});await e({activeCtx:t,activeProperty:n,expandedActiveProperty:r,element:o,expandedParent:a,options:i,insideList:s,typeScopedContext:c,typeKey:l,expansionMap:u})}}}({activeCtx:e,activeProperty:t,expandedActiveProperty:l,element:n,expandedParent:f,options:r,insideList:o,typeKey:p,typeScopedContext:i,expansionMap:s}),u=Object.keys(f);let h=u.length;if("@value"in f){if("@type"in f&&("@language"in f||"@direction"in f))throw new ee('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and either "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:f});let a=h-1;if("@type"in f&&(a-=1),"@index"in f&&(a-=1),"@language"in f&&(a-=1),"@direction"in f&&(a-=1),0!==a)throw new ee('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and either "@type" or either or both "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:f});const i=null===f["@value"]?[]:Gn(f["@value"]),l=Wn(f,"@type");if(Hn(e,1.1)&&l.includes("@json")&&1===l.length);else if(0===i.length){const a=await s({unmappedValue:f,activeCtx:e,activeProperty:t,element:n,options:r,insideList:o});f=void 0!==a?a:null}else{if(!i.every(e=>Dn(e)||Ln(e))&&"@language"in f)throw new ee("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:f});if(!l.every(e=>$n(e)&&!(Dn(e)&&0===e.indexOf("_:"))||Ln(e)))throw new ee('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:f})}}else if("@type"in f&&!Tn(f["@type"]))f["@type"]=[f["@type"]];else if("@set"in f||"@list"in f){if(h>1&&(2!==h||!("@index"in f)))throw new ee('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:f});"@set"in f&&(f=f["@set"],u=Object.keys(f),h=u.length)}else if(1===h&&"@language"in f){const a=await s(f,{unmappedValue:f,activeCtx:e,activeProperty:t,element:n,options:r,insideList:o});f=void 0!==a?a:null}if(Rn(f)&&!r.keepFreeFloatingNodes&&!o&&(null===t||"@graph"===l)&&(0===h||"@value"in f||"@list"in f||1===h&&"@id"in f)){const a=await s({unmappedValue:f,activeCtx:e,activeProperty:t,element:n,options:r,insideList:o});f=void 0!==a?a:null}return f};const{isKeyword:nr}=An,rr={};var or=rr;rr.createMergedNodeMap=(e,t)=>{const n=(t=t||{}).issuer||new se.IdentifierIssuer("_:b"),r={"@default":{}};return rr.createNodeMap(e,r,"@default",n),rr.mergeNodeMaps(r)},rr.createNodeMap=(e,t,n,r,o,a)=>{if(Q.isArray(e)){for(const o of e)rr.createNodeMap(o,t,n,r,void 0,a);return}if(!Q.isObject(e))return void(a&&a.push(e));if(Y.isValue(e)){if("@type"in e){let t=e["@type"];0===t.indexOf("_:")&&(e["@type"]=t=r.getId(t))}return void(a&&a.push(e))}if(a&&Y.isList(e)){const i=[];return rr.createNodeMap(e["@list"],t,n,r,o,i),void a.push({"@list":i})}if("@type"in e){const t=e["@type"];for(const e of t)0===e.indexOf("_:")&&r.getId(e)}Q.isUndefined(o)&&(o=Y.isBlankNode(e)?r.getId(e["@id"]):e["@id"]),a&&a.push({"@id":o});const i=t[n],s=i[o]=i[o]||{};s["@id"]=o;const l=Object.keys(e).sort();for(let a of l){if("@id"===a)continue;if("@reverse"===a){const a={"@id":o},s=e["@reverse"];for(const e in s){const o=s[e];for(const s of o){let o=s["@id"];Y.isBlankNode(s)&&(o=r.getId(o)),rr.createNodeMap(s,t,n,r,o),se.addValue(i[o],e,a,{propertyIsArray:!0,allowDuplicate:!1})}}continue}if("@graph"===a){o in t||(t[o]={}),rr.createNodeMap(e[a],t,o,r);continue}if("@included"===a){rr.createNodeMap(e[a],t,n,r);continue}if("@type"!==a&&nr(a)){if("@index"===a&&a in s&&(e[a]!==s[a]||e[a]["@id"]!==s[a]["@id"]))throw new ee("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:s});s[a]=e[a];continue}const l=e[a];if(0===a.indexOf("_:")&&(a=r.getId(a)),0!==l.length)for(let e of l)if("@type"===a&&(e=0===e.indexOf("_:")?r.getId(e):e),Y.isSubject(e)||Y.isSubjectReference(e)){if("@id"in e&&!e["@id"])continue;const o=Y.isBlankNode(e)?r.getId(e["@id"]):e["@id"];se.addValue(s,a,{"@id":o},{propertyIsArray:!0,allowDuplicate:!1}),rr.createNodeMap(e,t,n,r,o)}else if(Y.isValue(e))se.addValue(s,a,e,{propertyIsArray:!0,allowDuplicate:!1});else if(Y.isList(e)){const i=[];rr.createNodeMap(e["@list"],t,n,r,o,i),e={"@list":i},se.addValue(s,a,e,{propertyIsArray:!0,allowDuplicate:!1})}else rr.createNodeMap(e,t,n,r,o),se.addValue(s,a,e,{propertyIsArray:!0,allowDuplicate:!1});else se.addValue(s,a,[],{propertyIsArray:!0})}},rr.mergeNodeMapGraphs=e=>{const t={};for(const n of Object.keys(e).sort())for(const r of Object.keys(e[n]).sort()){const o=e[n][r];r in t||(t[r]={"@id":r});const a=t[r];for(const e of Object.keys(o).sort())if(nr(e)&&"@type"!==e)a[e]=se.clone(o[e]);else for(const t of o[e])se.addValue(a,e,se.clone(t),{propertyIsArray:!0,allowDuplicate:!1})}return t},rr.mergeNodeMaps=e=>{const t=e["@default"],n=Object.keys(e).sort();for(const r of n){if("@default"===r)continue;const n=e[r];let o=t[r];o?"@graph"in o||(o["@graph"]=[]):t[r]=o={"@id":r,"@graph":[]};const a=o["@graph"];for(const e of Object.keys(n).sort()){const t=n[e];Y.isSubjectReference(t)||a.push(t)}}return t};const{isSubjectReference:ar}=Y,{createMergedNodeMap:ir}=or,sr={};var lr=sr;sr.flatten=e=>{const t=ir(e),n=[],r=Object.keys(t).sort();for(let e=0;e<r.length;++e){const o=t[r[e]];ar(o)||n.push(o)}return n};const{RDF_LIST:cr,RDF_FIRST:ur,RDF_REST:dr,RDF_NIL:pr,RDF_TYPE:fr,RDF_JSON_LITERAL:hr,XSD_BOOLEAN:yr,XSD_DOUBLE:gr,XSD_INTEGER:vr,XSD_STRING:mr}=ue,br=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/,wr={};var xr=wr;function jr(e,t,n){if(e.termType.endsWith("Node"))return{"@id":e.value};const r={"@value":e.value};if(e.language)r["@language"]=e.language;else{let o=e.datatype.value;if(o||(o=mr),o===hr){o="@json";try{r["@value"]=JSON.parse(r["@value"])}catch(e){throw new ee("JSON literal could not be parsed.","jsonld.InvalidJsonLiteral",{code:"invalid JSON literal",value:r["@value"],cause:e})}}if(t){if(o===yr)"true"===r["@value"]?r["@value"]=!0:"false"===r["@value"]&&(r["@value"]=!1);else if(Q.isNumeric(r["@value"]))if(o===vr){const e=parseInt(r["@value"],10);e.toFixed(0)===r["@value"]&&(r["@value"]=e)}else o===gr&&(r["@value"]=parseFloat(r["@value"]));[yr,vr,gr,mr].includes(o)||(r["@type"]=o)}else if("i18n-datatype"===n&&o.startsWith("https://www.w3.org/ns/i18n#")){const[,e,t]=o.split(/[#_]/);e.length>0&&(r["@language"]=e,e.match(br)||console.warn("@language must be valid BCP47: "+e)),r["@direction"]=t}else o!==mr&&(r["@type"]=o)}return r}wr.fromRDF=async(e,{useRdfType:t=!1,useNativeTypes:n=!1,rdfDirection:r=null})=>{const o={},a={"@default":o},i={};for(const s of e){const e="DefaultGraph"===s.graph.termType?"@default":s.graph.value;e in a||(a[e]={}),"@default"===e||e in o||(o[e]={"@id":e});const l=a[e],c=s.subject.value,u=s.predicate.value,d=s.object;c in l||(l[c]={"@id":c});const p=l[c],f=d.termType.endsWith("Node");if(f&&!(d.value in l)&&(l[d.value]={"@id":d.value}),u===fr&&!t&&f){se.addValue(p,"@type",d.value,{propertyIsArray:!0});continue}const h=jr(d,n,r);if(se.addValue(p,u,h,{propertyIsArray:!0}),f)if(d.value===pr){const e=l[d.value];"usages"in e||(e.usages=[]),e.usages.push({node:p,property:u,value:h})}else d.value in i?i[d.value]=!1:i[d.value]={node:p,property:u,value:h}}for(const e in a){const t=a[e];if(!(pr in t))continue;const n=t[pr];if(n.usages){for(let e of n.usages){let n=e.node,r=e.property,o=e.value;const a=[],s=[];let l=Object.keys(n).length;for(;r===dr&&Q.isObject(i[n["@id"]])&&Q.isArray(n[ur])&&1===n[ur].length&&Q.isArray(n[dr])&&1===n[dr].length&&(3===l||4===l&&Q.isArray(n["@type"])&&1===n["@type"].length&&n["@type"][0]===cr)&&(a.push(n[ur][0]),s.push(n["@id"]),e=i[n["@id"]],n=e.node,r=e.property,o=e.value,l=Object.keys(n).length,Y.isBlankNode(n)););delete o["@id"],o["@list"]=a.reverse();for(const e of s)delete t[e]}delete n.usages}}const s=[],l=Object.keys(o).sort();for(const e of l){const t=o[e];if(e in a){const n=t["@graph"]=[],r=a[e],o=Object.keys(r).sort();for(const e of o){const t=r[e];Y.isSubjectReference(t)||n.push(t)}}Y.isSubjectReference(t)||s.push(t)}return s};const{createNodeMap:Sr}=or,{isKeyword:Ir}=An,{RDF_FIRST:Or,RDF_REST:kr,RDF_NIL:Nr,RDF_TYPE:Cr,RDF_JSON_LITERAL:Ar,RDF_LANGSTRING:Er,XSD_BOOLEAN:Tr,XSD_DOUBLE:Rr,XSD_INTEGER:Lr,XSD_STRING:Dr}=ue,{isAbsolute:Pr}=fe,_r={};var Br=_r;function Mr(e,t,n,r,o){const a=Object.keys(t).sort();for(const i of a){const a=t[i],s=Object.keys(a).sort();for(let t of s){const s=a[t];if("@type"===t)t=Cr;else if(Ir(t))continue;for(const a of s){const s={termType:i.startsWith("_:")?"BlankNode":"NamedNode",value:i};if(!Pr(i))continue;const l={termType:t.startsWith("_:")?"BlankNode":"NamedNode",value:t};if(!Pr(t))continue;if("BlankNode"===l.termType&&!o.produceGeneralizedRdf)continue;const c=Ur(a,r,e,n,o.rdfDirection);c&&e.push({subject:s,predicate:l,object:c,graph:n})}}}}function Ur(e,t,n,r,o){const a={};if(Y.isValue(e)){a.termType="Literal",a.value=void 0,a.datatype={termType:"NamedNode"};let t=e["@value"];const n=e["@type"]||null;if("@json"===n)a.value=function e(t){return null===t||"object"!=typeof t||null!=t.toJSON?JSON.stringify(t):Array.isArray(t)?"["+t.reduce((t,n,r)=>t+(0===r?"":",")+e(void 0===n||"symbol"==typeof n?null:n),"")+"]":"{"+Object.keys(t).sort().reduce((n,r,o)=>{if(void 0===t[r]||"symbol"==typeof t[r])return n;return n+(0===n.length?"":",")+e(r)+":"+e(t[r])},"")+"}"}(t),a.datatype.value=Ar;else if(Q.isBoolean(t))a.value=t.toString(),a.datatype.value=n||Tr;else if(Q.isDouble(t)||n===Rr)Q.isDouble(t)||(t=parseFloat(t)),a.value=t.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),a.datatype.value=n||Rr;else if(Q.isNumber(t))a.value=t.toFixed(0),a.datatype.value=n||Lr;else if("i18n-datatype"===o&&"@direction"in e){const n="https://www.w3.org/ns/i18n#"+(e["@language"]||"")+"_"+e["@direction"];a.datatype.value=n,a.value=t}else"@language"in e?(a.value=t,a.datatype.value=n||Er,a.language=e["@language"]):(a.value=t,a.datatype.value=n||Dr)}else if(Y.isList(e)){const i=function(e,t,n,r,o){const a={termType:"NamedNode",value:Or},i={termType:"NamedNode",value:kr},s={termType:"NamedNode",value:Nr},l=e.pop(),c=l?{termType:"BlankNode",value:t.getId()}:s;let u=c;for(const s of e){const e=Ur(s,t,n,r,o),l={termType:"BlankNode",value:t.getId()};n.push({subject:u,predicate:a,object:e,graph:r}),n.push({subject:u,predicate:i,object:l,graph:r}),u=l}if(l){const e=Ur(l,t,n,r,o);n.push({subject:u,predicate:a,object:e,graph:r}),n.push({subject:u,predicate:i,object:s,graph:r})}return c}(e["@list"],t,n,r,o);a.termType=i.termType,a.value=i.value}else{const t=Q.isObject(e)?e["@id"]:e;a.termType=t.startsWith("_:")?"BlankNode":"NamedNode",a.value=t}return"NamedNode"!==a.termType||Pr(a.value)?a:null}_r.toRDF=(e,t)=>{const n=new se.IdentifierIssuer("_:b"),r={"@default":{}};Sr(e,r,"@default",n);const o=[],a=Object.keys(r).sort();for(const e of a){let a;if("@default"===e)a={termType:"DefaultGraph",value:""};else{if(!Pr(e))continue;a=e.startsWith("_:")?{termType:"BlankNode"}:{termType:"NamedNode"},a.value=e}Mr(o,r[e],a,n,t)}return o};const{isKeyword:qr}=An,{createNodeMap:zr,mergeNodeMapGraphs:Fr}=or,Jr={};var Hr=Jr;function $r(e){const t={};for(const n in e)void 0!==e[n]&&(t["@"+n]=[e[n]]);return[t]}function Vr(e,t,n){for(let r=n.length-1;r>=0;--r){const o=n[r];if(o.graph===t&&o.subject["@id"]===e["@id"])return!0}return!1}function Gr(e,t,n){const r="@"+n;let o=r in e?e[r][0]:t[n];if("embed"===n)if(!0===o)o="@once";else if(!1===o)o="@never";else if("@always"!==o&&"@never"!==o&&"@link"!==o&&"@first"!==o&&"@last"!==o&&"@once"!==o)throw new ee("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:e});return o}function Wr(e){if(!Q.isArray(e)||1!==e.length||!Q.isObject(e[0]))throw new ee("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:e});if("@id"in e[0])for(const t of se.asArray(e[0]["@id"]))if(!Q.isObject(t)&&!fe.isAbsolute(t)||Q.isString(t)&&0===t.indexOf("_:"))throw new ee("Invalid JSON-LD syntax; invalid @id in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:e});if("@type"in e[0])for(const t of se.asArray(e[0]["@type"]))if(!Q.isObject(t)&&!fe.isAbsolute(t)||Q.isString(t)&&0===t.indexOf("_:"))throw new ee("Invalid JSON-LD syntax; invalid @type in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:e})}function Zr(e,t,n,r){let o=!0,a=!1;for(const i in n){let s=!1;const l=se.getValues(t,i),c=0===se.getValues(n,i).length;if("@id"===i){if(Q.isEmptyObject(n["@id"][0]||{})?s=!0:n["@id"].length>=0&&(s=n["@id"].includes(l[0])),!r.requireAll)return s}else if("@type"===i){if(o=!1,c){if(l.length>0)return!1;s=!0}else if(1===n["@type"].length&&Q.isEmptyObject(n["@type"][0]))s=l.length>0;else for(const e of n["@type"])s=!(!Q.isObject(e)||!("@default"in e))||(s||l.some(t=>t===e));if(!r.requireAll)return s}else{if(qr(i))continue;{const t=se.getValues(n,i)[0];let a=!1;if(t&&(Wr([t]),a="@default"in t),o=!1,0===l.length&&a)continue;if(l.length>0&&c)return!1;if(void 0===t){if(l.length>0)return!1;s=!0}else if(Y.isList(t)){const n=t["@list"][0];if(Y.isList(l[0])){const t=l[0]["@list"];Y.isValue(n)?s=t.some(e=>Yr(n,e)):(Y.isSubject(n)||Y.isSubjectReference(n))&&(s=t.some(t=>Xr(e,n,t,r)))}}else s=Y.isValue(t)?l.some(e=>Yr(t,e)):Y.isSubjectReference(t)?l.some(n=>Xr(e,t,n,r)):!!Q.isObject(t)&&l.length>0}}if(!s&&r.requireAll)return!1;a=a||s}return o||a}function Kr(e,t){const n=e.uniqueEmbeds[e.graph],r=n[t],o=r.parent,a=r.property,i={"@id":t};if(Q.isArray(o)){for(let e=0;e<o.length;++e)if(se.compareValues(o[e],i)){o[e]=i;break}}else{const e=Q.isArray(o[a]);se.removeValue(o,a,i,{propertyIsArray:e}),se.addValue(o,a,i,{propertyIsArray:e})}const s=e=>{const t=Object.keys(n);for(const r of t)r in n&&Q.isObject(n[r].parent)&&n[r].parent["@id"]===e&&(delete n[r],s(r))};s(t)}
/**
 * Removes the @preserve keywords from expanded result of framing.
 *
 * @param input the framed, framed output.
 * @param options the framing options used.
 *
 * @return the resulting output.
 */function Qr(e,t,n){Q.isObject(e)?se.addValue(e,t,n,{propertyIsArray:!0}):e.push(n)}function Xr(e,t,n,r){if(!("@id"in n))return!1;const o=e.subjects[n["@id"]];return o&&Zr(e,o,t,r)}function Yr(e,t){const n=t["@value"],r=t["@type"],o=t["@language"],a=e["@value"]?Q.isArray(e["@value"])?e["@value"]:[e["@value"]]:[],i=e["@type"]?Q.isArray(e["@type"])?e["@type"]:[e["@type"]]:[],s=e["@language"]?Q.isArray(e["@language"])?e["@language"]:[e["@language"]]:[];return 0===a.length&&0===i.length&&0===s.length||!(!a.includes(n)&&!Q.isEmptyObject(a[0]))&&(!!(!r&&0===i.length||i.includes(r)||r&&Q.isEmptyObject(i[0]))&&!!(!o&&0===s.length||s.includes(o)||o&&Q.isEmptyObject(s[0])))}Jr.frameMergedOrDefault=(e,t,n)=>{const r={options:n,embedded:!1,graph:"@default",graphMap:{"@default":{}},subjectStack:[],link:{},bnodeMap:{}},o=new se.IdentifierIssuer("_:b");zr(e,r.graphMap,"@default",o),n.merged&&(r.graphMap["@merged"]=Fr(r.graphMap),r.graph="@merged"),r.subjects=r.graphMap[r.graph];const a=[];return Jr.frame(r,Object.keys(r.subjects).sort(),t,a),n.pruneBlankNodeIdentifiers&&(n.bnodesToClear=Object.keys(r.bnodeMap).filter(e=>1===r.bnodeMap[e].length)),// remove @preserve from results
n.link={},function e(t,n){if(Q.isArray(t))return t.map(t=>e(t,n));if(Q.isObject(t)){
// remove @preserve
if("@preserve"in t)return t["@preserve"][0];if(Y.isValue(t))return t;if(Y.isList(t))return t["@list"]=e(t["@list"],n),t;if("@id"in t){const e=t["@id"];if(n.link.hasOwnProperty(e)){const r=n.link[e].indexOf(t);if(-1!==r)return n.link[e][r];n.link[e].push(t)}else n.link[e]=[t]}for(const r in t)"@id"===r&&n.bnodesToClear.includes(t[r])?delete t["@id"]:t[r]=e(t[r],n)}return t}(a,n)},Jr.frame=(e,t,n,r,o=null)=>{Wr(n),n=n[0];const a=e.options,i={embed:Gr(n,a,"embed"),explicit:Gr(n,a,"explicit"),requireAll:Gr(n,a,"requireAll")};e.link.hasOwnProperty(e.graph)||(e.link[e.graph]={});const s=e.link[e.graph],l=function(e,t,n,r){const o={};for(const a of t){const t=e.graphMap[e.graph][a];Zr(e,t,n,r)&&(o[a]=t)}return o}(e,t,n,i),c=Object.keys(l).sort();for(const u of c){const c=l[u];if(null===o?e.uniqueEmbeds={[e.graph]:{}}:e.uniqueEmbeds[e.graph]=e.uniqueEmbeds[e.graph]||{},"@link"===i.embed&&u in s){Qr(r,o,s[u]);continue}const d={"@id":u};if(0===u.indexOf("_:")&&se.addValue(e.bnodeMap,u,d,{propertyIsArray:!0}),s[u]=d,("@first"===i.embed||"@last"===i.embed)&&e.is11)throw new ee("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:n});if(e.embedded||!e.uniqueEmbeds[e.graph].hasOwnProperty(u))if(!e.embedded||"@never"!==i.embed&&!Vr(c,e.graph,e.subjectStack))if(!e.embedded||"@first"!=i.embed&&"@once"!=i.embed||!e.uniqueEmbeds[e.graph].hasOwnProperty(u)){if("@last"===i.embed&&u in e.uniqueEmbeds[e.graph]&&Kr(e,u),e.uniqueEmbeds[e.graph][u]={parent:r,property:o},e.subjectStack.push({subject:c,graph:e.graph}),u in e.graphMap){let t=!1,r=null;"@graph"in n?(r=n["@graph"][0],t=!("@merged"===u||"@default"===u),Q.isObject(r)||(r={})):(t="@merged"!==e.graph,r={}),t&&Jr.frame({...e,graph:u,embedded:!1},Object.keys(e.graphMap[u]).sort(),[r],d,"@graph")}"@included"in n&&Jr.frame({...e,embedded:!1},t,n["@included"],d,"@included");for(const t of Object.keys(c).sort())if(qr(t)){if(d[t]=se.clone(c[t]),"@type"===t)for(const t of c["@type"])0===t.indexOf("_:")&&se.addValue(e.bnodeMap,t,d,{propertyIsArray:!0})}else if(!i.explicit||t in n)for(const r of c[t]){const o=t in n?n[t]:$r(i);if(Y.isList(r)){const o=n[t]&&n[t][0]&&n[t][0]["@list"]?n[t][0]["@list"]:$r(i),a={"@list":[]};Qr(d,t,a);const s=r["@list"];for(const t of s)Y.isSubjectReference(t)?Jr.frame({...e,embedded:!0},[t["@id"]],o,a,"@list"):Qr(a,"@list",se.clone(t))}else Y.isSubjectReference(r)?Jr.frame({...e,embedded:!0},[r["@id"]],o,d,t):Yr(o[0],r)&&Qr(d,t,se.clone(r))}for(const e of Object.keys(n).sort()){if("@type"===e){if(!Q.isObject(n[e][0])||!("@default"in n[e][0]))continue}else if(qr(e))continue;const t=n[e][0]||{};if(!Gr(t,a,"omitDefault")&&!(e in d)){let n="@null";"@default"in t&&(n=se.clone(t["@default"])),Q.isArray(n)||(n=[n]),d[e]=[{"@preserve":n}]}}for(const t of Object.keys(n["@reverse"]||{}).sort()){const r=n["@reverse"][t];for(const n of Object.keys(e.subjects)){se.getValues(e.subjects[n],t).some(e=>e["@id"]===u)&&(d["@reverse"]=d["@reverse"]||{},se.addValue(d["@reverse"],t,[],{propertyIsArray:!0}),Jr.frame({...e,embedded:!0},[n],r,d["@reverse"][t],o))}}Qr(r,o,d),e.subjectStack.pop()}else Qr(r,o,d);else Qr(r,o,d)}},Jr.cleanupNull=(e,t)=>{if(Q.isArray(e)){return e.map(e=>Jr.cleanupNull(e,t)).filter(e=>e)}if("@null"===e)return null;if(Q.isObject(e)){if("@id"in e){const n=e["@id"];if(t.link.hasOwnProperty(n)){const r=t.link[n].indexOf(e);if(-1!==r)return t.link[n][r];t.link[n].push(e)}else t.link[n]=[e]}for(const n in e)e[n]=Jr.cleanupNull(e[n],t)}return e};const{isArray:eo,isObject:to,isString:no,isUndefined:ro}=Q,{isList:oo,isValue:ao,isGraph:io,isSimpleGraph:so,isSubjectReference:lo}=Y,{expandIri:co,getContextValue:uo,isKeyword:po,process:fo,processingMode:ho}=An,{removeBase:yo,prependBase:go}=fe,{addValue:vo,asArray:mo,compareShortestLeast:bo}=se,wo={};var xo=wo;function jo(e,t,n){if("@nest"!==co(e,t,{vocab:!0},n))throw new ee("JSON-LD compact error; nested property must have an @nest value resolving to @nest.","jsonld.SyntaxError",{code:"invalid @nest value"})}wo.compact=async({activeCtx:e,activeProperty:t=null,element:n,options:r={},compactionMap:o=(()=>{})})=>{if(eo(n)){let a=[];for(let i=0;i<n.length;++i){let s=await wo.compact({activeCtx:e,activeProperty:t,element:n[i],options:r,compactionMap:o});null===s&&(s=await o({unmappedValue:n[i],activeCtx:e,activeProperty:t,parent:n,index:i,options:r}),void 0===s)||a.push(s)}if(r.compactArrays&&1===a.length){0===(uo(e,t,"@container")||[]).length&&(a=a[0])}return a}const a=uo(e,t,"@context");if(ro(a)||(e=await fo({activeCtx:e,localCtx:a,propagate:!0,overrideProtected:!0,options:r})),to(n)){if(r.link&&"@id"in n&&r.link.hasOwnProperty(n["@id"])){const e=r.link[n["@id"]];for(let t=0;t<e.length;++t)if(e[t].expanded===n)return e[t].compacted}if(ao(n)||lo(n)){const o=wo.compactValue({activeCtx:e,activeProperty:t,value:n,options:r});return r.link&&lo(n)&&(r.link.hasOwnProperty(n["@id"])||(r.link[n["@id"]]=[]),r.link[n["@id"]].push({expanded:n,compacted:o})),o}if(oo(n)){if((uo(e,t,"@container")||[]).includes("@list"))return wo.compact({activeCtx:e,activeProperty:t,element:n["@list"],options:r,compactionMap:o})}const a="@reverse"===t,i={},s=e;ao(n)||lo(n)||(e=e.revertToPreviousContext());const l=uo(s,t,"@context");ro(l)||(e=await fo({activeCtx:e,localCtx:l,propagate:!0,overrideProtected:!0,options:r})),r.link&&"@id"in n&&(r.link.hasOwnProperty(n["@id"])||(r.link[n["@id"]]=[]),r.link[n["@id"]].push({expanded:n,compacted:i}));let c=n["@type"]||[];c.length>1&&(c=Array.from(c).sort());const u=e;for(const t of c){const n=wo.compactIri({activeCtx:u,iri:t,relativeTo:{vocab:!0}}),o=uo(s,n,"@context");ro(o)||(e=await fo({activeCtx:e,localCtx:o,options:r,propagate:!1}))}const d=Object.keys(n).sort();for(const l of d){const c=n[l];if("@id"!==l)if("@type"!==l)if("@reverse"!==l)if("@preserve"!==l)if("@index"!==l)if("@graph"!==l&&"@list"!==l&&"@included"!==l&&po(l)){const t=wo.compactIri({activeCtx:e,iri:l,relativeTo:{vocab:!0}});vo(i,t,c)}else{if(!eo(c))throw new ee("JSON-LD expansion error; expanded value must be an array.","jsonld.SyntaxError");if(0===c.length){const t=wo.compactIri({activeCtx:e,iri:l,value:c,relativeTo:{vocab:!0},reverse:a}),n=e.mappings.has(t)?e.mappings.get(t)["@nest"]:null;let o=i;n&&(jo(e,n,r),to(i[n])||(i[n]={}),o=i[n]),vo(o,t,c,{propertyIsArray:!0})}for(const t of c){const n=wo.compactIri({activeCtx:e,iri:l,value:t,relativeTo:{vocab:!0},reverse:a}),s=e.mappings.has(n)?e.mappings.get(n)["@nest"]:null;let c=i;s&&(jo(e,s,r),to(i[s])||(i[s]={}),c=i[s]);const u=uo(e,n,"@container")||[],d=io(t),p=oo(t);let f;p?f=t["@list"]:d&&(f=t["@graph"]);let h=await wo.compact({activeCtx:e,activeProperty:n,element:p||d?f:t,options:r,compactionMap:o});if(p){if(eo(h)||(h=[h]),u.includes("@list")){vo(c,n,h,{valueIsArray:!0,allowDuplicate:!0});continue}h={[wo.compactIri({activeCtx:e,iri:"@list",relativeTo:{vocab:!0}})]:h},"@index"in t&&(h[wo.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=t["@index"])}if(d)if(u.includes("@graph")&&(u.includes("@id")||u.includes("@index")&&so(t))){let o;c.hasOwnProperty(n)?o=c[n]:c[n]=o={};const a=(u.includes("@id")?t["@id"]:t["@index"])||wo.compactIri({activeCtx:e,iri:"@none",relativeTo:{vocab:!0}});vo(o,a,h,{propertyIsArray:!r.compactArrays||u.includes("@set")})}else u.includes("@graph")&&so(t)?(eo(h)&&h.length>1&&(h={"@included":h}),vo(c,n,h,{propertyIsArray:!r.compactArrays||u.includes("@set")})):(eo(h)&&1===h.length&&r.compactArrays&&(h=h[0]),h={[wo.compactIri({activeCtx:e,iri:"@graph",relativeTo:{vocab:!0}})]:h},"@id"in t&&(h[wo.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}})]=t["@id"]),"@index"in t&&(h[wo.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=t["@index"]),vo(c,n,h,{propertyIsArray:!r.compactArrays||u.includes("@set")}));else if(u.includes("@language")||u.includes("@index")||u.includes("@id")||u.includes("@type")){let a,i;if(c.hasOwnProperty(n)?a=c[n]:c[n]=a={},u.includes("@language"))ao(h)&&(h=h["@value"]),i=t["@language"];else if(u.includes("@index")){const r=uo(e,n,"@index")||"@index",o=wo.compactIri({activeCtx:e,iri:r,relativeTo:{vocab:!0}});if("@index"===r)i=t["@index"],delete h[o];else{let e;if([i,...e]=mo(h[r]||[]),no(i))switch(e.length){case 0:delete h[r];break;case 1:h[r]=e[0];break;default:h[r]=e}else i=null}}else if(u.includes("@id")){const t=wo.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}});i=h[t],delete h[t]}else if(u.includes("@type")){const a=wo.compactIri({activeCtx:e,iri:"@type",relativeTo:{vocab:!0}});let s;switch([i,...s]=mo(h[a]||[]),s.length){case 0:delete h[a];break;case 1:h[a]=s[0];break;default:h[a]=s}1===Object.keys(h).length&&"@id"in t&&(h=await wo.compact({activeCtx:e,activeProperty:n,element:{"@id":t["@id"]},options:r,compactionMap:o}))}i||(i=wo.compactIri({activeCtx:e,iri:"@none",relativeTo:{vocab:!0}})),vo(a,i,h,{propertyIsArray:u.includes("@set")})}else{const e=!r.compactArrays||u.includes("@set")||u.includes("@list")||eo(h)&&0===h.length||"@list"===l||"@graph"===l;vo(c,n,h,{propertyIsArray:e})}}}else{if((uo(e,t,"@container")||[]).includes("@index"))continue;const n=wo.compactIri({activeCtx:e,iri:l,relativeTo:{vocab:!0}});vo(i,n,c)}else{const n=await wo.compact({activeCtx:e,activeProperty:t,element:c,options:r,compactionMap:o});eo(n)&&0===n.length||vo(i,l,n)}else{const t=await wo.compact({activeCtx:e,activeProperty:"@reverse",element:c,options:r,compactionMap:o});for(const n in t)if(e.mappings.has(n)&&e.mappings.get(n).reverse){const o=t[n],a=(uo(e,n,"@container")||[]).includes("@set")||!r.compactArrays;vo(i,n,o,{propertyIsArray:a}),delete t[n]}if(Object.keys(t).length>0){const n=wo.compactIri({activeCtx:e,iri:l,relativeTo:{vocab:!0}});vo(i,n,t)}}else{let t=mo(c).map(e=>wo.compactIri({activeCtx:s,iri:e,relativeTo:{vocab:!0}}));1===t.length&&(t=t[0]);const n=wo.compactIri({activeCtx:e,iri:"@type",relativeTo:{vocab:!0}}),r=(uo(e,n,"@container")||[]).includes("@set")&&ho(e,1.1)||eo(t)&&0===c.length;vo(i,n,t,{propertyIsArray:r})}else{let t=mo(c).map(t=>wo.compactIri({activeCtx:e,iri:t,relativeTo:{vocab:!1},base:r.base}));1===t.length&&(t=t[0]);i[wo.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}})]=t}}return i}return n},wo.compactIri=({activeCtx:e,iri:t,value:n=null,relativeTo:r={vocab:!1},reverse:o=!1,base:a=null})=>{if(null===t)return t;e.isPropertyTermScoped&&e.previousContext&&(e=e.previousContext);const i=e.getInverse();if(po(t)&&t in i&&"@none"in i[t]&&"@type"in i[t]["@none"]&&"@none"in i[t]["@none"]["@type"])return i[t]["@none"]["@type"]["@none"];if(r.vocab&&t in i){const r=e["@language"]||"@none",a=[];to(n)&&"@index"in n&&!("@graph"in n)&&a.push("@index","@index@set"),to(n)&&"@preserve"in n&&(n=n["@preserve"][0]),io(n)?("@index"in n&&a.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in n&&a.push("@graph@id","@graph@id@set"),a.push("@graph","@graph@set","@set"),"@index"in n||a.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in n||a.push("@graph@id","@graph@id@set")):to(n)&&!ao(n)&&a.push("@id","@id@set","@type","@set@type");let i="@language",s="@null";if(o)i="@type",s="@reverse",a.push("@set");else if(oo(n)){"@index"in n||a.push("@list");const e=n["@list"];if(0===e.length)i="@any",s="@none";else{let t=0===e.length?r:null,n=null;for(let r=0;r<e.length;++r){const o=e[r];let a="@none",i="@none";if(ao(o))if("@direction"in o){a=`${(o["@language"]||"").toLowerCase()}_${o["@direction"]}`}else"@language"in o?a=o["@language"].toLowerCase():"@type"in o?i=o["@type"]:a="@null";else i="@id";if(null===t?t=a:a!==t&&ao(o)&&(t="@none"),null===n?n=i:i!==n&&(n="@none"),"@none"===t&&"@none"===n)break}t=t||"@none",n=n||"@none","@none"!==n?(i="@type",s=n):s=t}}else{if(ao(n))if("@language"in n&&!("@index"in n)){a.push("@language","@language@set"),s=n["@language"];const e=n["@direction"];e&&(s=`${s}_${e}`)}else"@direction"in n&&!("@index"in n)?s="_"+n["@direction"]:"@type"in n&&(i="@type",s=n["@type"]);else i="@type",s="@id";a.push("@set")}a.push("@none"),to(n)&&!("@index"in n)&&a.push("@index","@index@set"),ao(n)&&1===Object.keys(n).length&&a.push("@language","@language@set");const l=function(e,t,n,r,o,a){null===a&&(a="@null");const i=[];if(("@id"===a||"@reverse"===a)&&to(n)&&"@id"in n){"@reverse"===a&&i.push("@reverse");const t=wo.compactIri({activeCtx:e,iri:n["@id"],relativeTo:{vocab:!0}});e.mappings.has(t)&&e.mappings.get(t)&&e.mappings.get(t)["@id"]===n["@id"]?i.push.apply(i,["@vocab","@id"]):i.push.apply(i,["@id","@vocab"])}else{i.push(a);const e=i.find(e=>e.includes("_"));e&&i.push(e.replace(/^[^_]+_/,"_"))}i.push("@none");const s=e.inverse[t];for(const e of r){if(!(e in s))continue;const t=s[e][o];for(const e of i)if(e in t)return t[e]}return null}(e,t,n,a,i,s);if(null!==l)return l}if(r.vocab&&"@vocab"in e){const n=e["@vocab"];if(0===t.indexOf(n)&&t!==n){const r=t.substr(n.length);if(!e.mappings.has(r))return r}}let s=null;const l=[];let c=e.fastCurieMap;const u=t.length-1;for(let e=0;e<u&&t[e]in c;++e)c=c[t[e]],""in c&&l.push(c[""][0]);for(let r=l.length-1;r>=0;--r){const o=l[r],a=o.terms;for(const r of a){const a=r+":"+t.substr(o.iri.length);e.mappings.get(r)._prefix&&(!e.mappings.has(a)||null===n&&e.mappings.get(a)["@id"]===t)&&(null===s||bo(a,s)<0)&&(s=a)}}if(null!==s)return s;for(const[n,r]of e.mappings)if(r&&r._prefix&&t.startsWith(n+":"))throw new ee(`Absolute IRI "${t}" confused with prefix "${n}".`,"jsonld.SyntaxError",{code:"IRI confused with prefix",context:e});return r.vocab?t:"@base"in e?e["@base"]?yo(go(a,e["@base"]),t):t:yo(a,t)},wo.compactValue=({activeCtx:e,activeProperty:t,value:n,options:r})=>{if(ao(n)){const r=uo(e,t,"@type"),o=uo(e,t,"@language"),a=uo(e,t,"@direction"),i=uo(e,t,"@container")||[],s="@index"in n&&!i.includes("@index");if(!s&&"@none"!==r){if(n["@type"]===r)return n["@value"];if("@language"in n&&n["@language"]===o&&"@direction"in n&&n["@direction"]===a)return n["@value"];if("@language"in n&&n["@language"]===o)return n["@value"];if("@direction"in n&&n["@direction"]===a)return n["@value"]}const l=Object.keys(n).length,c=1===l||2===l&&"@index"in n&&!s,u="@language"in e,d=no(n["@value"]),p=e.mappings.has(t)&&null===e.mappings.get(t)["@language"];if(c&&"@none"!==r&&(!u||!d||p))return n["@value"];const f={};return s&&(f[wo.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=n["@index"]),"@type"in n?f[wo.compactIri({activeCtx:e,iri:"@type",relativeTo:{vocab:!0}})]=wo.compactIri({activeCtx:e,iri:n["@type"],relativeTo:{vocab:!0}}):"@language"in n&&(f[wo.compactIri({activeCtx:e,iri:"@language",relativeTo:{vocab:!0}})]=n["@language"]),"@direction"in n&&(f[wo.compactIri({activeCtx:e,iri:"@direction",relativeTo:{vocab:!0}})]=n["@direction"]),f[wo.compactIri({activeCtx:e,iri:"@value",relativeTo:{vocab:!0}})]=n["@value"],f}const o=co(e,t,{vocab:!0},r),a=uo(e,t,"@type"),i=wo.compactIri({activeCtx:e,iri:n["@id"],relativeTo:{vocab:"@vocab"===a},base:r.base});return"@id"===a||"@vocab"===a||"@graph"===o?i:{[wo.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}})]:i}};
/**
 * A JavaScript implementation of the JSON-LD API.
 *
 * @author Dave Longley
 *
 * @license BSD 3-Clause License
 * Copyright (c) 2011-2019 Digital Bazaar, Inc.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * Redistributions of source code must retain the above copyright notice,
 * this list of conditions and the following disclaimer.
 *
 * Redistributions in binary form must reproduce the above copyright
 * notice, this list of conditions and the following disclaimer in the
 * documentation and/or other materials provided with the distribution.
 *
 * Neither the name of the Digital Bazaar, Inc. nor the names of its
 * contributors may be used to endorse or promote products derived from
 * this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
 * IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
 * TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
 * PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 * HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
 * TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
 * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
const So=se.IdentifierIssuer,{expand:Io}=Qn,{flatten:Oo}=lr,{fromRDF:ko}=xr,{toRDF:No}=Br,{frameMergedOrDefault:Co,cleanupNull:Ao}=Hr,{isArray:Eo,isObject:To,isString:Ro}=Q,{isSubjectReference:Lo}=Y,{expandIri:Do,getInitialContext:Po,process:_o,processingMode:Bo}=An,{compact:Mo,compactIri:Uo}=xo,{createNodeMap:qo,createMergedNodeMap:zo,mergeNodeMaps:Fo}=or,Jo=function(e){const t={},n=new sn({max:100});function r(t,{documentLoader:n=e.documentLoader,...r}){return Object.assign({},{documentLoader:n},r,t)}return e.compact=async function(t,o,a){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");if(null===o)throw new ee("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"});if(null===t)return null;let i;(a=r(a,{base:Ro(t)?t:"",compactArrays:!0,compactToRelative:!0,graph:!1,skipExpansion:!1,link:!1,issuer:new So("_:b"),contextResolver:new hn({sharedCache:n})})).link&&(a.skipExpansion=!0),a.compactToRelative||delete a.base,i=a.skipExpansion?t:await e.expand(t,a);const s=await e.processContext(Po(a),o,a);let l=await Mo({activeCtx:s,element:i,options:a,compactionMap:a.compactionMap});a.compactArrays&&!a.graph&&Eo(l)?1===l.length?l=l[0]:0===l.length&&(l={}):a.graph&&To(l)&&(l=[l]),To(o)&&"@context"in o&&(o=o["@context"]),o=se.clone(o),Eo(o)||(o=[o]);const c=o;o=[];for(let e=0;e<c.length;++e)(!To(c[e])||Object.keys(c[e]).length>0)&&o.push(c[e]);const u=o.length>0;if(1===o.length&&(o=o[0]),Eo(l)){const e=Uo({activeCtx:s,iri:"@graph",relativeTo:{vocab:!0}}),t=l;l={},u&&(l["@context"]=o),l[e]=t}else if(To(l)&&u){const e=l;l={"@context":o};for(const t in e)l[t]=e[t]}return l},e.expand=async function(t,o){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");!1===(o=r(o,{keepFreeFloatingNodes:!1,contextResolver:new hn({sharedCache:n})})).expansionMap&&(o.expansionMap=void 0);const a={},i=[];if("expandContext"in o){const e=se.clone(o.expandContext);To(e)&&"@context"in e?a.expandContext=e:a.expandContext={"@context":e},i.push(a.expandContext)}let s;if(Ro(t)){const n=await e.get(t,o);s=n.documentUrl,a.input=n.document,n.contextUrl&&(a.remoteContext={"@context":n.contextUrl},i.push(a.remoteContext))}else a.input=se.clone(t);"base"in o||(o.base=s||"");let l=Po(o);for(const e of i)l=await _o({activeCtx:l,localCtx:e,options:o});let c=await Io({activeCtx:l,element:a.input,options:o,expansionMap:o.expansionMap});return To(c)&&"@graph"in c&&1===Object.keys(c).length?c=c["@graph"]:null===c&&(c=[]),Eo(c)||(c=[c]),c},e.flatten=async function(t,o,a){if(arguments.length<1)return new TypeError("Could not flatten, too few arguments.");o="function"==typeof o?null:o||null,a=r(a,{base:Ro(t)?t:"",contextResolver:new hn({sharedCache:n})});const i=await e.expand(t,a),s=Oo(i);if(null===o)return s;a.graph=!0,a.skipExpansion=!0;const l=await e.compact(s,o,a);return l},e.frame=async function(t,o,a){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");if(a=r(a,{base:Ro(t)?t:"",embed:"@once",explicit:!1,requireAll:!1,omitDefault:!1,bnodesToClear:[],contextResolver:new hn({sharedCache:n})}),Ro(o)){const t=await e.get(o,a);if(o=t.document,t.contextUrl){let e=o["@context"];e?Eo(e)?e.push(t.contextUrl):e=[e,t.contextUrl]:e=t.contextUrl,o["@context"]=e}}const i=o&&o["@context"]||{},s=await e.processContext(Po(a),i,a);a.hasOwnProperty("omitGraph")||(a.omitGraph=Bo(s,1.1)),a.hasOwnProperty("pruneBlankNodeIdentifiers")||(a.pruneBlankNodeIdentifiers=Bo(s,1.1));const l=await e.expand(t,a),c={...a};c.isFrame=!0,c.keepFreeFloatingNodes=!0;const u=await e.expand(o,c),d=Object.keys(o).map(e=>Do(s,e,{vocab:!0}));c.merged=!d.includes("@graph"),c.is11=Bo(s,1.1);const p=Co(l,u,c);c.graph=!a.omitGraph,c.skipExpansion=!0,c.link={},c.framing=!0;let f=await e.compact(p,i,c);return c.link={},f=Ao(f,c),f},e.link=async function(t,n,r){const o={};return n&&(o["@context"]=n),o["@embed"]="@link",e.frame(t,o,r)},e.normalize=e.canonize=async function(t,o){if(arguments.length<1)throw new TypeError("Could not canonize, too few arguments.");if("inputFormat"in(o=r(o,{base:Ro(t)?t:"",algorithm:"URDNA2015",skipExpansion:!1,contextResolver:new hn({sharedCache:n})}))){if("application/n-quads"!==o.inputFormat&&"application/nquads"!==o.inputFormat)throw new ee("Unknown canonicalization input format.","jsonld.CanonizeError");const e=gn.parse(t);return Z.canonize(e,o)}const a={...o};delete a.format,a.produceGeneralizedRdf=!1;const i=await e.toRDF(t,a);return Z.canonize(i,o)},e.fromRDF=async function(e,n){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");n=r(n,{format:Ro(e)?"application/n-quads":void 0});const{format:o}=n;let{rdfParser:a}=n;if(o){if(a=a||t[o],!a)throw new ee("Unknown input format.","jsonld.UnknownFormat",{format:o})}else a=()=>e;const i=await a(e);return ko(i,n)},e.toRDF=async function(t,o){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");let a;a=(o=r(o,{base:Ro(t)?t:"",skipExpansion:!1,contextResolver:new hn({sharedCache:n})})).skipExpansion?t:await e.expand(t,o);const i=No(a,o);if(o.format){if("application/n-quads"===o.format||"application/nquads"===o.format)return gn.serialize(i);throw new ee("Unknown output format.","jsonld.UnknownFormat",{format:o.format})}return i},e.createNodeMap=async function(t,o){if(arguments.length<1)throw new TypeError("Could not create node map, too few arguments.");o=r(o,{base:Ro(t)?t:"",contextResolver:new hn({sharedCache:n})});const a=await e.expand(t,o);return zo(a,o)},e.merge=async function(t,o,a){if(arguments.length<1)throw new TypeError("Could not merge, too few arguments.");if(!Eo(t))throw new TypeError('Could not merge, "docs" must be an array.');o="function"==typeof o?null:o||null,a=r(a,{contextResolver:new hn({sharedCache:n})});const i=await Promise.all(t.map(t=>{const n={...a};return e.expand(t,n)}));let s=!0;"mergeNodes"in a&&(s=a.mergeNodes);const l=a.issuer||new So("_:b"),c={"@default":{}};for(let e=0;e<i.length;++e){const t=se.relabelBlankNodes(i[e],{issuer:new So("_:b"+e+"-")}),n=s||0===e?c:{"@default":{}};if(qo(t,n,"@default",l),n!==c)for(const e in n){const t=n[e];if(!(e in c)){c[e]=t;continue}const r=c[e];for(const e in t)e in r||(r[e]=t[e])}}const u=Fo(c),d=[],p=Object.keys(u).sort();for(let e=0;e<p.length;++e){const t=u[p[e]];Lo(t)||d.push(t)}if(null===o)return d;a.graph=!0,a.skipExpansion=!0;const f=await e.compact(d,o,a);return f},Object.defineProperty(e,"documentLoader",{get:()=>e._documentLoader,set:t=>e._documentLoader=t}),e.documentLoader=async e=>{throw new ee("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",url:e})},e.get=async function(t,n){let r;r="function"==typeof n.documentLoader?n.documentLoader:e.documentLoader;const o=await r(t);try{if(!o.document)throw new ee("No remote document found at the given URL.","jsonld.NullRemoteDocument");Ro(o.document)&&(o.document=JSON.parse(o.document))}catch(e){throw new ee("Could not retrieve a JSON-LD document from the URL.","jsonld.LoadDocumentError",{code:"loading document failed",cause:e,remoteDoc:o})}return o},e.processContext=async function(e,t,o){return o=r(o,{base:"",contextResolver:new hn({sharedCache:n})}),null===t?Po(o):(t=se.clone(t),To(t)&&"@context"in t||(t={"@context":t}),_o({activeCtx:e,localCtx:t,options:o}))},e.getContextValue=An.getContextValue,e.documentLoaders={},e.useDocumentLoader=function(t){if(!(t in e.documentLoaders))throw new ee('Unknown document loader type: "'+t+'"',"jsonld.UnknownDocumentLoader",{type:t});e.documentLoader=e.documentLoaders[t].apply(e,Array.prototype.slice.call(arguments,1))},e.registerRDFParser=function(e,n){t[e]=n},e.unregisterRDFParser=function(e){delete t[e]},e.registerRDFParser("application/n-quads",gn.parse),e.registerRDFParser("application/nquads",gn.parse),e.url=fe,e.util=se,Object.assign(e,se),e.promises=e,e.RequestQueue=de,e.JsonLdProcessor=(e=>{class t{toString(){return"[object JsonLdProcessor]"}}return Object.defineProperty(t,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(t.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:t}),t.compact=function(t,n){return arguments.length<2?Promise.reject(new TypeError("Could not compact, too few arguments.")):e.compact(t,n)},t.expand=function(t){return arguments.length<1?Promise.reject(new TypeError("Could not expand, too few arguments.")):e.expand(t)},t.flatten=function(t){return arguments.length<1?Promise.reject(new TypeError("Could not flatten, too few arguments.")):e.flatten(t)},t})(e),_t.setupGlobals(e),_t.setupDocumentLoaders(e),e},Ho=function(){return Jo((function(){return Ho()}))};Jo(Ho);var $o=Ho,Vo=ge((function(e){!function(t){var n={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"Ae","Å":"A","Æ":"AE","Ç":"C","È":"E","É":"E","Ê":"E","Ë":"E","Ì":"I","Í":"I","Î":"I","Ï":"I","Ð":"D","Ñ":"N","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"Oe","Ő":"O","Ø":"O","Ù":"U","Ú":"U","Û":"U","Ü":"Ue","Ű":"U","Ý":"Y","Þ":"TH","ß":"ss","à":"a","á":"a","â":"a","ã":"a","ä":"ae","å":"a","æ":"ae","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ì":"i","í":"i","î":"i","ï":"i","ð":"d","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"oe","ő":"o","ø":"o","ù":"u","ú":"u","û":"u","ü":"ue","ű":"u","ý":"y","þ":"th","ÿ":"y","ẞ":"SS","ا":"a","أ":"a","إ":"i","آ":"aa","ؤ":"u","ئ":"e","ء":"a","ب":"b","ت":"t","ث":"th","ج":"j","ح":"h","خ":"kh","د":"d","ذ":"th","ر":"r","ز":"z","س":"s","ش":"sh","ص":"s","ض":"dh","ط":"t","ظ":"z","ع":"a","غ":"gh","ف":"f","ق":"q","ك":"k","ل":"l","م":"m","ن":"n","ه":"h","و":"w","ي":"y","ى":"a","ة":"h","ﻻ":"la","ﻷ":"laa","ﻹ":"lai","ﻵ":"laa","گ":"g","چ":"ch","پ":"p","ژ":"zh","ک":"k","ی":"y","َ":"a","ً":"an","ِ":"e","ٍ":"en","ُ":"u","ٌ":"on","ْ":"","٠":"0","١":"1","٢":"2","٣":"3","٤":"4","٥":"5","٦":"6","٧":"7","٨":"8","٩":"9","۰":"0","۱":"1","۲":"2","۳":"3","۴":"4","۵":"5","۶":"6","۷":"7","۸":"8","۹":"9","က":"k","ခ":"kh","ဂ":"g","ဃ":"ga","င":"ng","စ":"s","ဆ":"sa","ဇ":"z","စျ":"za","ည":"ny","ဋ":"t","ဌ":"ta","ဍ":"d","ဎ":"da","ဏ":"na","တ":"t","ထ":"ta","ဒ":"d","ဓ":"da","န":"n","ပ":"p","ဖ":"pa","ဗ":"b","ဘ":"ba","မ":"m","ယ":"y","ရ":"ya","လ":"l","ဝ":"w","သ":"th","ဟ":"h","ဠ":"la","အ":"a","ြ":"y","ျ":"ya","ွ":"w","ြွ":"yw","ျွ":"ywa","ှ":"h","ဧ":"e","၏":"-e","ဣ":"i","ဤ":"-i","ဉ":"u","ဦ":"-u","ဩ":"aw","သြော":"aw","ဪ":"aw","၀":"0","၁":"1","၂":"2","၃":"3","၄":"4","၅":"5","၆":"6","၇":"7","၈":"8","၉":"9","္":"","့":"","း":"","č":"c","ď":"d","ě":"e","ň":"n","ř":"r","š":"s","ť":"t","ů":"u","ž":"z","Č":"C","Ď":"D","Ě":"E","Ň":"N","Ř":"R","Š":"S","Ť":"T","Ů":"U","Ž":"Z","ހ":"h","ށ":"sh","ނ":"n","ރ":"r","ބ":"b","ޅ":"lh","ކ":"k","އ":"a","ވ":"v","މ":"m","ފ":"f","ދ":"dh","ތ":"th","ލ":"l","ގ":"g","ޏ":"gn","ސ":"s","ޑ":"d","ޒ":"z","ޓ":"t","ޔ":"y","ޕ":"p","ޖ":"j","ޗ":"ch","ޘ":"tt","ޙ":"hh","ޚ":"kh","ޛ":"th","ޜ":"z","ޝ":"sh","ޞ":"s","ޟ":"d","ޠ":"t","ޡ":"z","ޢ":"a","ޣ":"gh","ޤ":"q","ޥ":"w","ަ":"a","ާ":"aa","ި":"i","ީ":"ee","ު":"u","ޫ":"oo","ެ":"e","ޭ":"ey","ޮ":"o","ޯ":"oa","ް":"","ა":"a","ბ":"b","გ":"g","დ":"d","ე":"e","ვ":"v","ზ":"z","თ":"t","ი":"i","კ":"k","ლ":"l","მ":"m","ნ":"n","ო":"o","პ":"p","ჟ":"zh","რ":"r","ს":"s","ტ":"t","უ":"u","ფ":"p","ქ":"k","ღ":"gh","ყ":"q","შ":"sh","ჩ":"ch","ც":"ts","ძ":"dz","წ":"ts","ჭ":"ch","ხ":"kh","ჯ":"j","ჰ":"h","α":"a","β":"v","γ":"g","δ":"d","ε":"e","ζ":"z","η":"i","θ":"th","ι":"i","κ":"k","λ":"l","μ":"m","ν":"n","ξ":"ks","ο":"o","π":"p","ρ":"r","σ":"s","τ":"t","υ":"y","φ":"f","χ":"x","ψ":"ps","ω":"o","ά":"a","έ":"e","ί":"i","ό":"o","ύ":"y","ή":"i","ώ":"o","ς":"s","ϊ":"i","ΰ":"y","ϋ":"y","ΐ":"i","Α":"A","Β":"B","Γ":"G","Δ":"D","Ε":"E","Ζ":"Z","Η":"I","Θ":"TH","Ι":"I","Κ":"K","Λ":"L","Μ":"M","Ν":"N","Ξ":"KS","Ο":"O","Π":"P","Ρ":"R","Σ":"S","Τ":"T","Υ":"Y","Φ":"F","Χ":"X","Ψ":"PS","Ω":"O","Ά":"A","Έ":"E","Ί":"I","Ό":"O","Ύ":"Y","Ή":"I","Ώ":"O","Ϊ":"I","Ϋ":"Y","ā":"a","ē":"e","ģ":"g","ī":"i","ķ":"k","ļ":"l","ņ":"n","ū":"u","Ā":"A","Ē":"E","Ģ":"G","Ī":"I","Ķ":"k","Ļ":"L","Ņ":"N","Ū":"U","Ќ":"Kj","ќ":"kj","Љ":"Lj","љ":"lj","Њ":"Nj","њ":"nj","Тс":"Ts","тс":"ts","ą":"a","ć":"c","ę":"e","ł":"l","ń":"n","ś":"s","ź":"z","ż":"z","Ą":"A","Ć":"C","Ę":"E","Ł":"L","Ń":"N","Ś":"S","Ź":"Z","Ż":"Z","Є":"Ye","І":"I","Ї":"Yi","Ґ":"G","є":"ye","і":"i","ї":"yi","ґ":"g","ă":"a","Ă":"A","ș":"s","Ș":"S","ț":"t","Ț":"T","ţ":"t","Ţ":"T","а":"a","б":"b","в":"v","г":"g","д":"d","е":"e","ё":"yo","ж":"zh","з":"z","и":"i","й":"i","к":"k","л":"l","м":"m","н":"n","о":"o","п":"p","р":"r","с":"s","т":"t","у":"u","ф":"f","х":"kh","ц":"c","ч":"ch","ш":"sh","щ":"sh","ъ":"","ы":"y","ь":"","э":"e","ю":"yu","я":"ya","А":"A","Б":"B","В":"V","Г":"G","Д":"D","Е":"E","Ё":"Yo","Ж":"Zh","З":"Z","И":"I","Й":"I","К":"K","Л":"L","М":"M","Н":"N","О":"O","П":"P","Р":"R","С":"S","Т":"T","У":"U","Ф":"F","Х":"Kh","Ц":"C","Ч":"Ch","Ш":"Sh","Щ":"Sh","Ъ":"","Ы":"Y","Ь":"","Э":"E","Ю":"Yu","Я":"Ya","ђ":"dj","ј":"j","ћ":"c","џ":"dz","Ђ":"Dj","Ј":"j","Ћ":"C","Џ":"Dz","ľ":"l","ĺ":"l","ŕ":"r","Ľ":"L","Ĺ":"L","Ŕ":"R","ş":"s","Ş":"S","ı":"i","İ":"I","ğ":"g","Ğ":"G","ả":"a","Ả":"A","ẳ":"a","Ẳ":"A","ẩ":"a","Ẩ":"A","đ":"d","Đ":"D","ẹ":"e","Ẹ":"E","ẽ":"e","Ẽ":"E","ẻ":"e","Ẻ":"E","ế":"e","Ế":"E","ề":"e","Ề":"E","ệ":"e","Ệ":"E","ễ":"e","Ễ":"E","ể":"e","Ể":"E","ỏ":"o","ọ":"o","Ọ":"o","ố":"o","Ố":"O","ồ":"o","Ồ":"O","ổ":"o","Ổ":"O","ộ":"o","Ộ":"O","ỗ":"o","Ỗ":"O","ơ":"o","Ơ":"O","ớ":"o","Ớ":"O","ờ":"o","Ờ":"O","ợ":"o","Ợ":"O","ỡ":"o","Ỡ":"O","Ở":"o","ở":"o","ị":"i","Ị":"I","ĩ":"i","Ĩ":"I","ỉ":"i","Ỉ":"i","ủ":"u","Ủ":"U","ụ":"u","Ụ":"U","ũ":"u","Ũ":"U","ư":"u","Ư":"U","ứ":"u","Ứ":"U","ừ":"u","Ừ":"U","ự":"u","Ự":"U","ữ":"u","Ữ":"U","ử":"u","Ử":"ư","ỷ":"y","Ỷ":"y","ỳ":"y","Ỳ":"Y","ỵ":"y","Ỵ":"Y","ỹ":"y","Ỹ":"Y","ạ":"a","Ạ":"A","ấ":"a","Ấ":"A","ầ":"a","Ầ":"A","ậ":"a","Ậ":"A","ẫ":"a","Ẫ":"A","ắ":"a","Ắ":"A","ằ":"a","Ằ":"A","ặ":"a","Ặ":"A","ẵ":"a","Ẵ":"A","⓪":"0","①":"1","②":"2","③":"3","④":"4","⑤":"5","⑥":"6","⑦":"7","⑧":"8","⑨":"9","⑩":"10","⑪":"11","⑫":"12","⑬":"13","⑭":"14","⑮":"15","⑯":"16","⑰":"17","⑱":"18","⑲":"18","⑳":"18","⓵":"1","⓶":"2","⓷":"3","⓸":"4","⓹":"5","⓺":"6","⓻":"7","⓼":"8","⓽":"9","⓾":"10","⓿":"0","⓫":"11","⓬":"12","⓭":"13","⓮":"14","⓯":"15","⓰":"16","⓱":"17","⓲":"18","⓳":"19","⓴":"20","Ⓐ":"A","Ⓑ":"B","Ⓒ":"C","Ⓓ":"D","Ⓔ":"E","Ⓕ":"F","Ⓖ":"G","Ⓗ":"H","Ⓘ":"I","Ⓙ":"J","Ⓚ":"K","Ⓛ":"L","Ⓜ":"M","Ⓝ":"N","Ⓞ":"O","Ⓟ":"P","Ⓠ":"Q","Ⓡ":"R","Ⓢ":"S","Ⓣ":"T","Ⓤ":"U","Ⓥ":"V","Ⓦ":"W","Ⓧ":"X","Ⓨ":"Y","Ⓩ":"Z","ⓐ":"a","ⓑ":"b","ⓒ":"c","ⓓ":"d","ⓔ":"e","ⓕ":"f","ⓖ":"g","ⓗ":"h","ⓘ":"i","ⓙ":"j","ⓚ":"k","ⓛ":"l","ⓜ":"m","ⓝ":"n","ⓞ":"o","ⓟ":"p","ⓠ":"q","ⓡ":"r","ⓢ":"s","ⓣ":"t","ⓤ":"u","ⓦ":"v","ⓥ":"w","ⓧ":"x","ⓨ":"y","ⓩ":"z","“":'"',"”":'"',"‘":"'","’":"'","∂":"d","ƒ":"f","™":"(TM)","©":"(C)","œ":"oe","Œ":"OE","®":"(R)","†":"+","℠":"(SM)","…":"...","˚":"o","º":"o","ª":"a","•":"*","၊":",","။":".",$:"USD","€":"EUR","₢":"BRN","₣":"FRF","£":"GBP","₤":"ITL","₦":"NGN","₧":"ESP","₩":"KRW","₪":"ILS","₫":"VND","₭":"LAK","₮":"MNT","₯":"GRD","₱":"ARS","₲":"PYG","₳":"ARA","₴":"UAH","₵":"GHS","¢":"cent","¥":"CNY","元":"CNY","円":"YEN","﷼":"IRR","₠":"EWE","฿":"THB","₨":"INR","₹":"INR","₰":"PF","₺":"TRY","؋":"AFN","₼":"AZN","лв":"BGN","៛":"KHR","₡":"CRC","₸":"KZT","ден":"MKD","zł":"PLN","₽":"RUB","₾":"GEL"},r=["်","ް"],o={"ာ":"a","ါ":"a","ေ":"e","ဲ":"e","ိ":"i","ီ":"i","ို":"o","ု":"u","ူ":"u","ေါင်":"aung","ော":"aw","ော်":"aw","ေါ":"aw","ေါ်":"aw","်":"်","က်":"et","ိုက်":"aik","ောက်":"auk","င်":"in","ိုင်":"aing","ောင်":"aung","စ်":"it","ည်":"i","တ်":"at","ိတ်":"eik","ုတ်":"ok","ွတ်":"ut","ေတ်":"it","ဒ်":"d","ိုဒ်":"ok","ုဒ်":"ait","န်":"an","ာန်":"an","ိန်":"ein","ုန်":"on","ွန်":"un","ပ်":"at","ိပ်":"eik","ုပ်":"ok","ွပ်":"ut","န်ုပ်":"nub","မ်":"an","ိမ်":"ein","ုမ်":"on","ွမ်":"un","ယ်":"e","ိုလ်":"ol","ဉ်":"in","ံ":"an","ိံ":"ein","ုံ":"on","ައް":"ah","ަށް":"ah"},a={en:{},az:{"ç":"c","ə":"e","ğ":"g","ı":"i","ö":"o","ş":"s","ü":"u","Ç":"C","Ə":"E","Ğ":"G","İ":"I","Ö":"O","Ş":"S","Ü":"U"},cs:{"č":"c","ď":"d","ě":"e","ň":"n","ř":"r","š":"s","ť":"t","ů":"u","ž":"z","Č":"C","Ď":"D","Ě":"E","Ň":"N","Ř":"R","Š":"S","Ť":"T","Ů":"U","Ž":"Z"},fi:{"ä":"a","Ä":"A","ö":"o","Ö":"O"},hu:{"ä":"a","Ä":"A","ö":"o","Ö":"O","ü":"u","Ü":"U","ű":"u","Ű":"U"},lt:{"ą":"a","č":"c","ę":"e","ė":"e","į":"i","š":"s","ų":"u","ū":"u","ž":"z","Ą":"A","Č":"C","Ę":"E","Ė":"E","Į":"I","Š":"S","Ų":"U","Ū":"U"},lv:{"ā":"a","č":"c","ē":"e","ģ":"g","ī":"i","ķ":"k","ļ":"l","ņ":"n","š":"s","ū":"u","ž":"z","Ā":"A","Č":"C","Ē":"E","Ģ":"G","Ī":"i","Ķ":"k","Ļ":"L","Ņ":"N","Š":"S","Ū":"u","Ž":"Z"},pl:{"ą":"a","ć":"c","ę":"e","ł":"l","ń":"n","ó":"o","ś":"s","ź":"z","ż":"z","Ą":"A","Ć":"C","Ę":"e","Ł":"L","Ń":"N","Ó":"O","Ś":"S","Ź":"Z","Ż":"Z"},sv:{"ä":"a","Ä":"A","ö":"o","Ö":"O"},sk:{"ä":"a","Ä":"A"},sr:{"љ":"lj","њ":"nj","Љ":"Lj","Њ":"Nj","đ":"dj","Đ":"Dj"},tr:{"Ü":"U","Ö":"O","ü":"u","ö":"o"}},i={ar:{"∆":"delta","∞":"la-nihaya","♥":"hob","&":"wa","|":"aw","<":"aqal-men",">":"akbar-men","∑":"majmou","¤":"omla"},az:{},ca:{"∆":"delta","∞":"infinit","♥":"amor","&":"i","|":"o","<":"menys que",">":"mes que","∑":"suma dels","¤":"moneda"},cs:{"∆":"delta","∞":"nekonecno","♥":"laska","&":"a","|":"nebo","<":"mensi nez",">":"vetsi nez","∑":"soucet","¤":"mena"},de:{"∆":"delta","∞":"unendlich","♥":"Liebe","&":"und","|":"oder","<":"kleiner als",">":"groesser als","∑":"Summe von","¤":"Waehrung"},dv:{"∆":"delta","∞":"kolunulaa","♥":"loabi","&":"aai","|":"noonee","<":"ah vure kuda",">":"ah vure bodu","∑":"jumula","¤":"faisaa"},en:{"∆":"delta","∞":"infinity","♥":"love","&":"and","|":"or","<":"less than",">":"greater than","∑":"sum","¤":"currency"},es:{"∆":"delta","∞":"infinito","♥":"amor","&":"y","|":"u","<":"menos que",">":"mas que","∑":"suma de los","¤":"moneda"},fa:{"∆":"delta","∞":"bi-nahayat","♥":"eshgh","&":"va","|":"ya","<":"kamtar-az",">":"bishtar-az","∑":"majmooe","¤":"vahed"},fi:{"∆":"delta","∞":"aarettomyys","♥":"rakkaus","&":"ja","|":"tai","<":"pienempi kuin",">":"suurempi kuin","∑":"summa","¤":"valuutta"},fr:{"∆":"delta","∞":"infiniment","♥":"Amour","&":"et","|":"ou","<":"moins que",">":"superieure a","∑":"somme des","¤":"monnaie"},ge:{"∆":"delta","∞":"usasruloba","♥":"siqvaruli","&":"da","|":"an","<":"naklebi",">":"meti","∑":"jami","¤":"valuta"},gr:{},hu:{"∆":"delta","∞":"vegtelen","♥":"szerelem","&":"es","|":"vagy","<":"kisebb mint",">":"nagyobb mint","∑":"szumma","¤":"penznem"},it:{"∆":"delta","∞":"infinito","♥":"amore","&":"e","|":"o","<":"minore di",">":"maggiore di","∑":"somma","¤":"moneta"},lt:{"∆":"delta","∞":"begalybe","♥":"meile","&":"ir","|":"ar","<":"maziau nei",">":"daugiau nei","∑":"suma","¤":"valiuta"},lv:{"∆":"delta","∞":"bezgaliba","♥":"milestiba","&":"un","|":"vai","<":"mazak neka",">":"lielaks neka","∑":"summa","¤":"valuta"},my:{"∆":"kwahkhyaet","∞":"asaonasme","♥":"akhyait","&":"nhin","|":"tho","<":"ngethaw",">":"kyithaw","∑":"paungld","¤":"ngwekye"},mk:{},nl:{"∆":"delta","∞":"oneindig","♥":"liefde","&":"en","|":"of","<":"kleiner dan",">":"groter dan","∑":"som","¤":"valuta"},pl:{"∆":"delta","∞":"nieskonczonosc","♥":"milosc","&":"i","|":"lub","<":"mniejsze niz",">":"wieksze niz","∑":"suma","¤":"waluta"},pt:{"∆":"delta","∞":"infinito","♥":"amor","&":"e","|":"ou","<":"menor que",">":"maior que","∑":"soma","¤":"moeda"},ro:{"∆":"delta","∞":"infinit","♥":"dragoste","&":"si","|":"sau","<":"mai mic ca",">":"mai mare ca","∑":"suma","¤":"valuta"},ru:{"∆":"delta","∞":"beskonechno","♥":"lubov","&":"i","|":"ili","<":"menshe",">":"bolshe","∑":"summa","¤":"valjuta"},sk:{"∆":"delta","∞":"nekonecno","♥":"laska","&":"a","|":"alebo","<":"menej ako",">":"viac ako","∑":"sucet","¤":"mena"},sr:{},tr:{"∆":"delta","∞":"sonsuzluk","♥":"ask","&":"ve","|":"veya","<":"kucuktur",">":"buyuktur","∑":"toplam","¤":"para birimi"},uk:{"∆":"delta","∞":"bezkinechnist","♥":"lubov","&":"i","|":"abo","<":"menshe",">":"bilshe","∑":"suma","¤":"valjuta"},vn:{"∆":"delta","∞":"vo cuc","♥":"yeu","&":"va","|":"hoac","<":"nho hon",">":"lon hon","∑":"tong","¤":"tien te"}},s=[";","?",":","@","&","=","+","$",",","/"].join(""),l=[";","?",":","@","&","=","+","$",","].join(""),c=[".","!","~","*","'","(",")"].join(""),u=function(e,t){var u,d,h,y,g,v,m,b,w,x,j,S,I,O,k="-",N="",C="",A=!0,E={},T="";if("string"!=typeof e)return"";if("string"==typeof t&&(k=t),m=i.en,b=a.en,"object"==typeof t)for(j in u=t.maintainCase||!1,E=t.custom&&"object"==typeof t.custom?t.custom:E,h=+t.truncate>1&&t.truncate||!1,y=t.uric||!1,g=t.uricNoSlash||!1,v=t.mark||!1,A=!1!==t.symbols&&!1!==t.lang,k=t.separator||k,y&&(T+=s),g&&(T+=l),v&&(T+=c),m=t.lang&&i[t.lang]&&A?i[t.lang]:A?i.en:{},b=t.lang&&a[t.lang]?a[t.lang]:!1===t.lang||!0===t.lang?{}:a.en,t.titleCase&&"number"==typeof t.titleCase.length&&Array.prototype.toString.call(t.titleCase)?(t.titleCase.forEach((function(e){E[e+""]=e+""})),d=!0):d=!!t.titleCase,t.custom&&"number"==typeof t.custom.length&&Array.prototype.toString.call(t.custom)&&t.custom.forEach((function(e){E[e+""]=e+""})),Object.keys(E).forEach((function(t){var n;n=t.length>1?new RegExp("\\b"+p(t)+"\\b","gi"):new RegExp(p(t),"gi"),e=e.replace(n,E[t])})),E)T+=j;for(T=p(T+=k),I=!1,O=!1,x=0,S=(e=e.replace(/(^\s+|\s+$)/g,"")).length;x<S;x++)j=e[x],f(j,E)?I=!1:b[j]?(j=I&&b[j].match(/[A-Za-z0-9]/)?" "+b[j]:b[j],I=!1):j in n?(x+1<S&&r.indexOf(e[x+1])>=0?(C+=j,j=""):!0===O?(j=o[C]+n[j],C=""):j=I&&n[j].match(/[A-Za-z0-9]/)?" "+n[j]:n[j],I=!1,O=!1):j in o?(C+=j,j="",x===S-1&&(j=o[C]),O=!0):!m[j]||y&&-1!==s.indexOf(j)||g&&-1!==l.indexOf(j)?(!0===O?(j=o[C]+j,C="",O=!1):I&&(/[A-Za-z0-9]/.test(j)||N.substr(-1).match(/A-Za-z0-9]/))&&(j=" "+j),I=!1):(j=I||N.substr(-1).match(/[A-Za-z0-9]/)?k+m[j]:m[j],j+=void 0!==e[x+1]&&e[x+1].match(/[A-Za-z0-9]/)?k:"",I=!0),N+=j.replace(new RegExp("[^\\w\\s"+T+"_-]","g"),k);return d&&(N=N.replace(/(\w)(\S*)/g,(function(e,t,n){var r=t.toUpperCase()+(null!==n?n:"");return Object.keys(E).indexOf(r.toLowerCase())<0?r:r.toLowerCase()}))),N=N.replace(/\s+/g,k).replace(new RegExp("\\"+k+"+","g"),k).replace(new RegExp("(^\\"+k+"+|\\"+k+"+$)","g"),""),h&&N.length>h&&(w=N.charAt(h)===k,N=N.slice(0,h),w||(N=N.slice(0,N.lastIndexOf(k)))),u||d||(N=N.toLowerCase()),N},d=function(e){return function(t){return u(t,e)}},p=function(e){return e.replace(/[-\\^$*+?.()|[\]{}\/]/g,"\\$&")},f=function(e,t){for(var n in t)if(t[n]===e)return!0};if(e.exports)e.exports=u,e.exports.createSlug=d;else try{if(t.getSlug||t.createSlug)throw"speakingurl: globals exists /(getSlug|createSlug)/";t.getSlug=u,t.createSlug=d}catch(e){}}(ye)}));Vo.createSlug;var Go=Vo;function Wo(e,t,n,r,o,a,i){try{var s=e[a](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function Zo(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){Wo(a,r,o,i,s,"next",e)}function s(e){Wo(a,r,o,i,s,"throw",e)}i(void 0)}))}}function Ko(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qo(){return(Qo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Xo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xo(Object(n),!0).forEach((function(t){Ko(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ea(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw a}}return n}}(e,t)||na(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ta(e){return function(e){if(Array.isArray(e))return ra(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||na(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function na(e,t){if(e){if("string"==typeof e)return ra(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ra(e,t):void 0}}function ra(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function oa(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=na(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,a=!0,i=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){i=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(i)throw o}}}}var aa=function(e){var n=e.record,r=e.source,o=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["record","source"]);return(null==n?void 0:n[r])&&(Array.isArray(n[r])||(n[r]=[n[r]]),n[r]=n[r].map((function(e){return e["@id"]||e.id||e}))),f.default.createElement(t.ReferenceArrayField,Qo({record:n,source:r},o))};aa.defaultProps={addLabel:!0},n.makeStyles({form:{display:"flex"},input:{paddingRight:"20px"}}),n.makeStyles({root:{display:"none"}});var ia=function(e,t){return Object.keys(t).find((function(n){return t[n][e]}))},sa=function(e,t){return Object.keys(t).find((function(n){return e.startsWith(t[n].baseUrl)}))};!function(){var e=Zo(regeneratorRuntime.mark((function e(t,n){var r,o,a,i,s,l,c,u,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.dataServers,i=n.httpClient,s=n.jsonContext,l=ia("authServer",a),(c=sa(t,a))===l||!(null===(r=a[l])||void 0===r?void 0:r.proxyUrl)||!0===(null===(o=a[c])||void 0===o?void 0:o.noProxy)){e.next=9;break}return e.next=6,i(a[l].proxyUrl,{method:"POST",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded"}),body:new URLSearchParams({id:t})});case 6:e.t0=e.sent,e.next=12;break;case 9:return e.next=11,i(t,{noToken:c!==l});case 11:e.t0=e.sent;case 12:if(u=e.t0,(d=u.json).id=d.id||d["@id"],d["@context"]===s){e.next=19;break}return e.next=18,$o.compact(d,s);case 18:d=e.sent;case 19:return e.abrupt("return",d);case 20:case"end":return e.stop()}}),e)})))}();var la,ca="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},ua=(function(e){var t,n;t=ca,n=function(){function e(e){var t=[];if(0===e.length)return"";if("string"!=typeof e[0])throw new TypeError("Url must be a string. Received "+e[0]);if(e[0].match(/^[^/:]+:\/*$/)&&e.length>1){var n=e.shift();e[0]=n+e[0]}e[0].match(/^file:\/\/\//)?e[0]=e[0].replace(/^([^/:]+):\/*/,"$1:///"):e[0]=e[0].replace(/^([^/:]+):\/*/,"$1://");for(var r=0;r<e.length;r++){var o=e[r];if("string"!=typeof o)throw new TypeError("Url must be a string. Received "+o);""!==o&&(r>0&&(o=o.replace(/^[\/]+/,"")),o=r<e.length-1?o.replace(/[\/]+$/,""):o.replace(/[\/]+$/,"/"),t.push(o))}var a=t.join("/"),i=(a=a.replace(/\/(\?|&|#[^!])/g,"$1")).split("?");return i.shift()+(i.length>0?"?":"")+i.join("&")}return function(){return e("object"==typeof arguments[0]?arguments[0]:[].slice.call(arguments))}},e.exports?e.exports=n():t.urljoin=n()}(la={exports:{}}),la.exports),da=function(e){return e&&e.rawFile&&e.rawFile instanceof File},pa=function(e){var t=Object.keys(e.dataServers).find((function(t){return e.dataServers[t].uploadsContainer}));if(t)return ua(e.dataServers[t].baseUrl,e.dataServers[t].uploadsContainer)},fa=function(){var e=Zo(regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=pa(n)){e.next=3;break}throw new Error("You must define an uploadsContainer in one of the server's configuration");case 3:return e.next=5,n.httpClient(r,{method:"POST",body:t,headers:new Headers({Slug:(a=t.name,i=void 0,s=void 0,i="",s=a.split("."),s.length>1&&(i=s.pop(),a=s.join(".")),Go(a,{lang:"fr"})+"."+i),"Content-Type":t.type})});case 5:if(201!==(o=e.sent).status){e.next=8;break}return e.abrupt("return",o.headers.get("Location"));case 8:case"end":return e.stop()}var a,i,s}),e)})));return function(t,n){return e.apply(this,arguments)}}();!function(){var e=Zo(regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=regeneratorRuntime.keys(t);case 1:if((e.t1=e.t0()).done){e.next=22;break}if(r=e.t1.value,!t.hasOwnProperty(r)){e.next=20;break}if(!Array.isArray(t[r])){e.next=16;break}o=0;case 6:if(!(o<t[r].length)){e.next=14;break}if(!da(t[r][o])){e.next=11;break}return e.next=10,fa(t[r][o].rawFile,n);case 10:t[r][o]=e.sent;case 11:o++,e.next=6;break;case 14:e.next=20;break;case 16:if(!da(t[r])){e.next=20;break}return e.next=19,fa(t[r].rawFile,n);case 19:t[r]=e.sent;case 20:e.next=1;break;case 22:return e.abrupt("return",t);case 23:case"end":return e.stop()}}),e)})))}(),function(){var e=Zo(regeneratorRuntime.mark((function e(t,n,r,o){var a,i,s,l,c,u,d,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.dataServers,i=o.httpClient,s=o.jsonContext,l=Object.keys(t).reduce((function(e,n){return Yo(Yo({},e),Object.fromEntries(t[n].map((function(e){return[e,n]}))))}),{}),c=Object.keys(l).map((function(e){return i(e,{noToken:!l[e]||!0!==a[l[e]].authServer}).then((function(e){var t=e.json;return t["@context"]!==s?$o.compact(t,s):t})).then((function(t){if(n="ldp:Container",o=(r=t).type||r["@type"],Array.isArray(o)?o.includes(n):o===n)return t["ldp:contains"];throw new Error(e+" is not a LDP container");var n,r,o}))})),e.next=5,Promise.all(c);case 5:if(0!==(u=e.sent).length){e.next=10;break}return e.abrupt("return",{data:[],total:0});case 10:return u=(d=[].concat).apply.apply(d,ta(u)),p=u.map((function(e){return e.id=e.id||e["@id"],e})),r.filter&&(r.filter.a&&(r.filter.type=r.filter.a,delete r.filter.a),r.filter.q&&delete r.filter.q,Object.keys(r.filter).length>0&&(p=p.filter((function(e){return Object.entries(r.filter).some((function(t){var n=ea(t,2),r=n[0],o=n[1];return Array.isArray(e[r])?e[r].includes(o):e[r]===o}))})))),r.sort&&(p=p.sort((function(e,t){return!e[r.sort.field]||!t[r.sort.field]||("ASC"===r.sort.order?e[r.sort.field].localeCompare(t[r.sort.field]):t[r.sort.field].localeCompare(e[r.sort.field]))}))),r.pagination&&(p=p.slice((r.pagination.page-1)*r.pagination.perPage,r.pagination.page*r.pagination.perPage)),e.abrupt("return",{data:p,total:u.length});case 16:case"end":return e.stop()}}),e)})))}();var ha=function(e){var t,n={};if(e){var r,o=oa(e);try{for(o.s();!(r=o.n()).done;){var a=r.value;t=a.includes("/")?a.split("/").reverse():[a],n=Yo(Yo({},n),t.reduce((function(e,t){return Ko({},t,Yo({"@embed":"@last"},e))}),{}))}}catch(e){o.e(e)}finally{o.f()}return n}},ya=function(e){return h.default.createHash("md5").update(e).digest("hex")},ga=function(e){return e.includes("/")&&e.split("/")[0]},va=function(e){return e.includes("/")?e.split("/")[1]:e},ma=function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t.filter((function(e){return e.parentNode===n})).map((function(n){return"\n      OPTIONAL { \n        ".concat(n.query,"\n        ").concat(n.filter,"\n        ").concat(e(t,n.node),"\n      }\n    ")})).join("\n")},ba=function(e){var t=[],n=function(e){var t=[];if(e){var n,r=oa(e);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(o.includes("/"))for(var a=o.split("/"),i=1;i<=a.length;i++)t.push(a.slice(0,i).join("/"));else t.push(o)}}catch(e){r.e(e)}finally{r.f()}}return t}(e);if(n){var r,o=oa(n);try{for(o.s();!(r=o.n()).done;){var a=r.value,i=ga(a),s=va(a),l=ya(a),c=i?ya(i):"1";t.push({node:a,parentNode:i,query:"?s".concat(c," ").concat(s," ?s").concat(l," .\n?s").concat(l," ?p").concat(l," ?o").concat(l," ."),filter:""})}}catch(e){o.e(e)}finally{o.f()}return{construct:t.map((function(e){return e.query})).join("\n"),where:ma(t)}}return{construct:"",where:""}},wa=function(e){var t=e.containers,n=e.params.filter,r=e.dereference,o=e.ontologies,a="",i="";n&&(n.q&&n.q.length>0&&(a+='\n      {\n        SELECT ?s1\n        WHERE {\n          ?s1 ?p1 ?o1 .\n          FILTER regex(lcase(str(?o1)), "'.concat(n.q.toLowerCase(),'")\n          FILTER NOT EXISTS {?s1 a ?o1}\n        }\n      }\n      '),delete n.q),Object.keys(n).forEach((function(e){if(n[e]){var t=n[e].startsWith("http")?"<".concat(n[e],">"):n[e];i+="?s1 ".concat(e," ").concat(t," .")}})));var s=ba(r);return"\n    ".concat(function(e){return e.map((function(e){return"PREFIX ".concat(e.prefix,": <").concat(e.url,">")})).join("\n")}(o),"\n    CONSTRUCT {\n      ?s1 ?p2 ?o2 .\n      ").concat(s.construct,"\n    }\n    WHERE {\n      ").concat(i,"\n      ?containerUri ldp:contains ?s1 .\n      FILTER( ?containerUri IN (").concat(t.map((function(e){return"<".concat(e,">")})).join(", "),") ) .\n      FILTER( (isIRI(?s1)) ) .\n      ").concat(a,"\n      ").concat(s.where,"\n      ?s1 ?p2 ?o2 .\n    }\n  ")};function xa(e){this.message=e}!function(){var e=Zo(regeneratorRuntime.mark((function e(t,n,r,o){var a,i,s,l,c,u,d,p,f,h,y,g;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=o.dataServers,s=o.resources,l=o.httpClient,c=o.jsonContext,u=o.ontologies,d=s[n],p=Yo({"@context":c,"@type":d.types,"@embed":"@never"},ha(null===(a=d.list)||void 0===a?void 0:a.dereference)),f=Object.keys(t).map((function(e){return new Promise((function(n,o){var a,s,c=wa({containers:t[e],params:Yo(Yo({},r),{},{filter:Yo(Yo({},null===(a=d.list)||void 0===a?void 0:a.filter),r.filter)}),dereference:null===(s=d.list)||void 0===s?void 0:s.dereference,ontologies:u});l(i[e].sparqlEndpoint,{method:"POST",body:c,noToken:!0!==i[e].authServer}).then((function(e){var t=e.json;return $o.frame(t,p,{omitGraph:!1})})).then((function(e){n(e["@graph"]||[])})).catch((function(e){return o(e)}))}))})),e.next=6,Promise.all(f);case 6:if(0!==(h=e.sent).length){e.next=11;break}return e.abrupt("return",{data:[],total:0});case 11:return h=(y=[].concat).apply.apply(y,ta(h)),g=h.map((function(e){return e.id=e.id||e["@id"],e})),r.sort&&(g=g.sort((function(e,t){return!e[r.sort.field]||!t[r.sort.field]||("ASC"===r.sort.order?e[r.sort.field].localeCompare(t[r.sort.field]):t[r.sort.field].localeCompare(e[r.sort.field]))}))),r.pagination&&(g=g.slice((r.pagination.page-1)*r.pagination.perPage,r.pagination.page*r.pagination.perPage)),e.abrupt("return",{data:g,total:h.length});case 16:case"end":return e.stop()}}),e)})))}(),xa.prototype=new Error,xa.prototype.name="InvalidCharacterError";var ja="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new xa("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,r,o=0,a=0,i="";r=t.charAt(a++);~r&&(n=o%4?64*n+r:r,o++%4)?i+=String.fromCharCode(255&n>>(-2*o&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);return i};function Sa(e){this.message=e}function Ia(e,t){if("string"!=typeof e)throw new Sa("Invalid token specified");var n=!0===(t=t||{}).header?0:1;try{return JSON.parse(function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(ja(e).replace(/(.)/g,(function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})))}(t)}catch(e){return ja(t)}}(e.split(".")[n]))}catch(e){throw new Sa("Invalid token specified: "+e.message)}}Sa.prototype=new Error,Sa.prototype.name="InvalidTokenError",function(){var e=Zo(regeneratorRuntime.mark((function e(t){var n,r,o,a,i,s,l,c,u,d,p,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.dataServers,r=t.httpClient,o=localStorage.getItem("token"),a=ia("pod",n),i=ia("authServer",n),!o){e.next=24;break}return s=Ia(o),l=s.webId,e.prev=6,e.next=9,r(l);case 9:u=e.sent,d=u.json,c=d,e.next=20;break;case 14:return e.prev=14,e.t0=e.catch(6),console.error(e.t0),localStorage.removeItem("token"),window.location.reload(),e.abrupt("return");case 20:a&&(t.dataServers[a].name="My Pod",t.dataServers[a].baseUrl=ua(l,"data"),t.dataServers[a].sparqlEndpoint=(null===(p=c.endpoints)||void 0===p?void 0:p["void:sparqlEndpoint"])||ua(l,"sparql")),i&&(t.dataServers[i].proxyUrl=null===(f=c.endpoints)||void 0===f?void 0:f.proxyUrl),e.next=25;break;case 24:a&&delete t.dataServers[a];case 25:case"end":return e.stop()}}),e,null,[[6,14]])})))}(),function(){var e=Zo(regeneratorRuntime.mark((function e(t){var n,r,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object.values(t.dataServers).filter((function(e){return!0!==e.pod})).map((function(e){return t.httpClient(new URL("/.well-known/void",e.baseUrl)).then((function(e){return{data:e.json}})).catch((function(e){if(404===e.status)return{error:e};throw e}))})),e.prev=1,e.next=4,Promise.all(n);case 4:r=e.sent,o=oa(r);try{for(o.s();!(a=o.n()).done;)a.value.data}catch(e){o.e(e)}finally{o.f()}e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:case"end":return e.stop()}}),e,null,[[1,9]])})))}();var Oa=["collectionUri","resource","children"],ka=function(e){var n=e.collectionUri,r=e.resource,o=e.children,a=N(e,Oa);if(1!==f.default.Children.count(o))throw new Error("<CollectionList> only accepts a single child");var i=t.useGetOne(r,n,{enabled:!!n}),s=i.data;return i.loading?f.default.createElement("div",{style:{marginTop:8}},f.default.createElement(t.LinearProgress,null)):s?f.default.createElement(aa,k({reference:r,record:s,source:"items"},a),o):null},Na=["source","record","reference","children"],Ca=function(e){var t=e.source,n=e.record,r=e.reference,o=e.children,a=N(e,Na);if(1!==f.default.Children.count(o))throw new Error("<ReferenceCollectionField> only accepts a single child");return n&&n[t]?f.default.createElement(ka,k({resource:r,collectionUri:n[t]},a),o):null};Ca.defaultProps={addLabel:!0};exports.CollectionList=ka,exports.ReferenceCollectionField=Ca,exports.useCollection=function(n){var r=t.useGetIdentity().identity,o=C(e.useState([]),2),a=o[0],i=o[1],s=C(e.useState(!1),2),l=s[0],c=s[1],u=C(e.useState(!1),2),d=u[0],p=u[1],f=C(e.useState(!1),2),h=f[0],y=f[1],g=e.useMemo((function(){if(n){if(n.startsWith("http"))return n;var e;if(null!=r&&r.webIdData)return null==r||null===(e=r.webIdData)||void 0===e?void 0:e[n]}}),[r,n]),v=e.useCallback(I(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g){e.next=2;break}return e.abrupt("return");case 2:c(!0),n=new Headers({Accept:"application/ld+json",Authorization:"Bearer "+localStorage.getItem("token")}),t.fetchUtils.fetchJson(g,{headers:n}).then((function(e){var t=e.json;t&&t.items?i(t.items):i([]),y(!1),p(!0),c(!1)})).catch((function(){y(!0),p(!0),c(!1)}));case 5:case"end":return e.stop()}}),e)}))),[i,p,c,y,g]);return e.useEffect((function(){l||d||h||v()}),[v,l,d,h]),{items:a,loading:l,loaded:d,error:h,refetch:v,url:g,owner:null==r?void 0:r.id}},exports.useInbox=function(){var n=t.useGetIdentity().identity,r=e.useMemo((function(){var e;if(null!=n&&n.webIdData)return null==n||null===(e=n.webIdData)||void 0===e?void 0:e.inbox}),[n]),o=e.useMemo((function(){var e,t;if(null!=n&&n.webIdData)return null==n||null===(e=n.webIdData)||void 0===e||null===(t=e.endpoints)||void 0===t?void 0:t["void:sparqlEndpoint"]}),[n]);return{fetch:e.useCallback(function(){var e=I(regeneratorRuntime.mark((function e(n){var a,i,s,l,c,u,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.filters,o&&r){e.next=3;break}return e.abrupt("return");case 3:return i=localStorage.getItem("token"),s=ba(["as:object"]),l="",a&&Object.keys(a).forEach((function(e){if(a[e]){var t=a[e].startsWith("http")?"<".concat(a[e],">"):a[e];l+="?s1 ".concat(e," ").concat(t," .")}})),c="\n      PREFIX as: <https://www.w3.org/ns/activitystreams#>\n      CONSTRUCT {\n        ?s1 ?p1 ?o1 .\n        ".concat(s.construct,"\n      }\n      WHERE {\n        <").concat(r,"> as:items ?s1 .\n        ?s1 ?p1 ?o1 .\n        FILTER( (isIRI(?s1)) ) .\n        ").concat(l,"\n        ").concat(s.where,"\n      }\n    "),e.next=10,t.fetchUtils.fetchJson(o,{method:"POST",body:c,headers:new Headers({Accept:"application/ld+json",Authorization:"Bearer "+i})});case 10:if(u=e.sent,!(d=u.json)["@graph"]){e.next=16;break}return e.abrupt("return",d["@graph"]);case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[o,r]),url:r,owner:null==n?void 0:n.id}},exports.useOutbox=function(){var n=t.useGetIdentity().identity,r=e.useMemo((function(){var e;if(null!=n&&n.webIdData)return null==n||null===(e=n.webIdData)||void 0===e?void 0:e.outbox}),[n]),o=e.useMemo((function(){var e,t;if(null!=n&&n.webIdData)return null==n||null===(e=n.webIdData)||void 0===e||null===(t=e.endpoints)||void 0===t?void 0:t["void:sparqlEndpoint"]}),[n]);return{post:e.useCallback(function(){var e=I(regeneratorRuntime.mark((function e(n){var o,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=localStorage.getItem("token"),e.prev=1,e.next=4,t.fetchUtils.fetchJson(r,{method:"POST",body:JSON.stringify(j({"@context":"https://www.w3.org/ns/activitystreams"},n)),headers:new Headers({"Content-Type":"application/ld+json",Authorization:"Bearer ".concat(o)})});case 4:return a=e.sent,i=a.headers,e.abrupt("return",i.get("Location"));case 9:return e.prev=9,e.t0=e.catch(1),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),[r]),fetch:e.useCallback(I(regeneratorRuntime.mark((function e(){var n,a,i,s,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o&&r){e.next=2;break}return e.abrupt("return");case 2:return n=localStorage.getItem("token"),a=ba(["as:object"]),i="\n      PREFIX as: <https://www.w3.org/ns/activitystreams#>\n      CONSTRUCT {\n        ?s1 ?p1 ?o1 .\n        ".concat(a.construct,"\n      }\n      WHERE {\n        <").concat(r,"> as:items ?s1 .\n        ?s1 ?p1 ?o1 .\n        ").concat(a.where,"\n      }\n    "),e.next=7,t.fetchUtils.fetchJson(o,{method:"POST",body:i,headers:new Headers({Accept:"application/ld+json",Authorization:"Bearer "+n})});case 7:if(s=e.sent,!(l=s.json)["@graph"]){e.next=13;break}return e.abrupt("return",l["@graph"]);case 13:return e.abrupt("return",null);case 14:case"end":return e.stop()}}),e)}))),[o,r]),url:r,owner:null==n?void 0:n.id}},exports.useWebfinger=function(){return{fetch:e.useCallback(function(){var e=I(regeneratorRuntime.mark((function e(n){var r,o,a,i,s,l,c,u,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.split("@"),o=C(r,3),a=o[1],i=o[2],s=i.includes(":")?"http":"https",l="".concat(s,"://").concat(i,"/.well-known/webfinger?resource=acct:").concat(a,"@").concat(i),e.prev=3,e.next=6,t.fetchUtils.fetchJson(l);case 6:return c=e.sent,u=c.json,d=u.links.find((function(e){return"application/activity+json"===e.type})),e.abrupt("return",d?d.href:null);case 12:return e.prev=12,e.t0=e.catch(3),e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t){return e.apply(this,arguments)}}(),[])}};
//# sourceMappingURL=index.cjs.js.map
