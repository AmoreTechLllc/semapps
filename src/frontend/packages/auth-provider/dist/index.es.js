import e,{useState as t,useEffect as r,useCallback as n,createElement as a,useMemo as o,forwardRef as i}from"react";import{useTranslate as c,useGetList as s,useDataProvider as u,Loading as l,Error as f,usePermissionsOptimized as p,useAuthProvider as m,Button as d,ListButton as h,ShowButton as v,useRecordContext as g,DeleteButton as b,Toolbar as y,SaveButton as _,useNotify as w,useRedirect as j,Edit as E,EditButton as O,Show as k,useLogin as P,Notification as C,useSafeSetState as x,createMuiTheme as S,LoginForm as A,useLogout as I,Resource as T,MenuItemLink as R,useGetIdentity as N,UserMenu as U,useGetPermissions as z}from"react-admin";import{TopToolbar as L,List as W,ListActions as V}from"@semapps/archipelago-layout";import D from"@material-ui/icons/Share";import{makeStyles as F,TextField as M,List as $,ListItem as B,ListItemAvatar as q,Avatar as G,ListItemText as H,ListItemSecondaryAction as J,IconButton as Y,Menu as K,MenuItem as Q,ListItemIcon as X,Dialog as Z,DialogTitle as ee,DialogContent as te,DialogActions as re,Card as ne,CardActions as ae,Button as oe,CircularProgress as ie,ThemeProvider as ce,Typography as se}from"@material-ui/core";import ue from"@material-ui/lab/Autocomplete";import le from"@material-ui/icons/Person";import fe from"@material-ui/icons/Edit";import pe from"@material-ui/icons/Check";import me from"@material-ui/icons/Public";import de from"@material-ui/icons/VpnLock";import he from"@material-ui/icons/Group";import{ThemeProvider as ve}from"@material-ui/styles";import{makeStyles as ge,createMuiTheme as be}from"@material-ui/core/styles";import ye from"@material-ui/icons/Lock";import _e from"classnames";import{useHistory as we,useLocation as je,Link as Ee}from"react-router-dom";import{Form as Oe,Field as ke}from"react-final-form";import Pe from"@material-ui/core/MenuItem";import Ce from"@material-ui/icons/PowerSettingsNew";import xe from"@material-ui/icons/AccountCircle";function Se(e,t,r,n,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void r(e)}c.done?t(s):Promise.resolve(s).then(n,a)}function Ae(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Se(o,n,a,i,c,"next",e)}function c(e){Se(o,n,a,i,c,"throw",e)}i(void 0)}))}}function Ie(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Te(){return(Te=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ne(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(r),!0).forEach((function(t){Ie(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Re(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ue(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ze(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||We(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Le(e){return function(e){if(Array.isArray(e))return Ve(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||We(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function We(e,t){if(e){if("string"==typeof e)return Ve(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ve(e,t):void 0}}function Ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function De(e){this.message=e}De.prototype=new Error,De.prototype.name="InvalidCharacterError";var Fe="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new De("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,n,a=0,o=0,i="";n=t.charAt(o++);~n&&(r=a%4?64*r+n:n,a++%4)?i+=String.fromCharCode(255&r>>(-2*a&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return i};function Me(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(Fe(e).replace(/(.)/g,(function(e,t){var r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r})))}(t)}catch(e){return Fe(t)}}function $e(e){this.message=e}function Be(e,t){if("string"!=typeof e)throw new $e("Invalid token specified");var r=!0===(t=t||{}).header?0:1;try{return JSON.parse(Me(e.split(".")[r]))}catch(e){throw new $e("Invalid token specified: "+e.message)}}$e.prototype=new Error,$e.prototype.name="InvalidTokenError";var qe="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Ge(e,t){return e(t={exports:{}},t.exports),t.exports}var He,Je,Ye=Ge((function(e){var t,r;t=qe,r=function(){function e(e){var t=[];if(0===e.length)return"";if("string"!=typeof e[0])throw new TypeError("Url must be a string. Received "+e[0]);if(e[0].match(/^[^/:]+:\/*$/)&&e.length>1){var r=e.shift();e[0]=r+e[0]}e[0].match(/^file:\/\/\//)?e[0]=e[0].replace(/^([^/:]+):\/*/,"$1:///"):e[0]=e[0].replace(/^([^/:]+):\/*/,"$1://");for(var n=0;n<e.length;n++){var a=e[n];if("string"!=typeof a)throw new TypeError("Url must be a string. Received "+a);""!==a&&(n>0&&(a=a.replace(/^[\/]+/,"")),a=n<e.length-1?a.replace(/[\/]+$/,""):a.replace(/[\/]+$/,"/"),t.push(a))}var o=t.join("/"),i=(o=o.replace(/\/(\?|&|#[^!])/g,"$1")).split("?");return o=i.shift()+(i.length>0?"?":"")+i.join("&")}return function(){return e("object"==typeof arguments[0]?arguments[0]:[].slice.call(arguments))}},e.exports?e.exports=r():t.urljoin=r()})),Ke=function(e){return e?Array.isArray(e)?e:[e]:void 0},Qe=function(e,t){return Ye(e,t.replace(e,"_acl/"))},Xe=function(e){return{"@base":e,acl:"http://www.w3.org/ns/auth/acl#",foaf:"http://xmlns.com/foaf/0.1/","acl:agent":{"@type":"@id"},"acl:agentGroup":{"@type":"@id"},"acl:agentClass":{"@type":"@id"},"acl:mode":{"@type":"@id"},"acl:accessTo":{"@type":"@id"}}},Ze=function(e){var t,r,n,a,o,i,c,s=e.middlewareUri,u=e.allowAnonymous,l=void 0===u||u,f=e.localAccounts,p=void 0!==f&&f,m=e.checkUser,d=e.httpClient,h=e.checkPermissions,v=e.resources;return{login:(c=Ae(regeneratorRuntime.mark((function e(t){var r,n,a,o,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=new URL(window.location.href),!p){e.next=17;break}return n=t.username,a=t.password,e.prev=3,e.next=6,d("".concat(s,"auth"),{method:"POST",body:JSON.stringify({email:n,password:a}),headers:new Headers({"Content-Type":"application/json"})});case 6:o=e.sent,i=o.json,c=i.token,localStorage.setItem("token",c),e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(3),new Error("ra.auth.sign_in_error");case 15:e.next=18;break;case 17:window.location.href="".concat(s,"auth?redirectUrl=")+encodeURIComponent(r.origin+"/login?login=true");case 18:case"end":return e.stop()}}),e,null,[[3,12]])}))),function(e){return c.apply(this,arguments)}),signup:(i=Ae(regeneratorRuntime.mark((function e(t){var r,n,a,o,i,c,u,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!p){e.next=22;break}return r=t.email,n=t.password,a=Ue(t,["email","password"]),e.prev=2,e.next=5,d("".concat(s,"auth/signup"),{method:"POST",body:JSON.stringify(Ne({email:r,password:n},a)),headers:new Headers({"Content-Type":"application/json"})});case 5:return o=e.sent,i=o.json,c=i.token,localStorage.setItem("token",c),u=Be(c),l=u.webId,e.abrupt("return",l);case 13:if(e.prev=13,e.t0=e.catch(2),"email.already.exists"!==e.t0.message){e.next=19;break}throw new Error("auth.message.user_email_exist");case 19:throw new Error(e.t0.message||"ra.auth.sign_in_error");case 20:e.next=23;break;case 22:window.location.href="".concat(s,"auth?redirectUrl=")+encodeURIComponent(url.origin+"/login?login=true");case 23:case"end":return e.stop()}}),e,null,[[2,13]])}))),function(e){return i.apply(this,arguments)}),logout:(o=Ae(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.removeItem("token"),p||(t=new URL(window.location.href),window.location.href=l?"".concat(s,"auth/logout?redirectUrl=")+encodeURIComponent(t.origin+"/login?logout=true"):"".concat(s,"auth/logout?redirectUrl=")+encodeURIComponent(t.origin+"/login")),e.abrupt("return","/");case 3:case"end":return e.stop()}}),e)}))),function(){return o.apply(this,arguments)}),checkAuth:(a=Ae(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(localStorage.getItem("token")||l){e.next=3;break}throw new Error;case 3:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)}),checkUser:function(e){return!m||m(e)},checkError:function(e){return Promise.resolve()},getPermissions:(n=Ae(regeneratorRuntime.mark((function e(t){var r,n,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h){e.next=2;break}return e.abrupt("return",!0);case 2:return r=v[t]?v[t].containerUri:t,n=Qe(s,r),e.next=6,d(n);case 6:return a=e.sent,o=a.json,e.abrupt("return",o["@graph"]);case 9:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)}),addPermission:(r=Ae(regeneratorRuntime.mark((function e(t,r,n,a){var o,i,c,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=v[t]?v[t].containerUri:t,c=Qe(s,i),Ie(o={"@id":"#"+a.replace("acl:",""),"@type":"acl:Authorization"},n,r),Ie(o,"acl:accessTo",i),Ie(o,"acl:mode",a),u=o,e.next=5,d(c,{method:"PATCH",body:JSON.stringify({"@context":Xe(c),"@graph":[u]})});case 5:case"end":return e.stop()}}),e)}))),function(e,t,n,a){return r.apply(this,arguments)}),removePermission:(t=Ae(regeneratorRuntime.mark((function e(t,r,n,a){var o,i,c,u,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=v[t]?v[t].containerUri:t,i=Qe(s,o),e.next=4,d(i);case 4:return c=e.sent,u=c.json,l=u["@graph"].filter((function(e){return!e["@id"].includes("#Default")})).map((function(e){var t=Ke(e["acl:mode"]),o=Ke(e[n]);return a&&t.includes(a)&&o&&o.includes(r)&&(o=o.filter((function(e){return e!==r}))),Ne(Ne({},e),{},Ie({},n,o))})),e.next=9,d(i,{method:"PUT",body:JSON.stringify({"@context":Xe(i),"@graph":l})});case 9:case"end":return e.stop()}}),e)}))),function(e,r,n,a){return t.apply(this,arguments)}),getIdentity:function(){var e=localStorage.getItem("token");if(e){var t=Be(e);return{id:t.webId,fullName:t["foaf:name"]}}}}},et="acl:agentClass",tt=["acl:Append","acl:Write","acl:Control"],rt=["acl:Append","acl:Write","acl:Control"],nt=["acl:Write","acl:Control"],at=["acl:Control"],ot={show:["acl:Read","acl:Append","acl:Write","acl:Control"],list:["acl:Read","acl:Append","acl:Write","acl:Control"],create:tt,edit:rt,delete:nt,control:at},it={show:"auth.message.resource_show_forbidden",edit:"auth.message.resource_edit_forbidden",delete:"auth.message.resource_delete_forbidden",control:"auth.message.resource_control_forbidden",list:"auth.message.container_list_forbidden",create:"auth.message.container_create_forbidden"},ct=(Ie(He={},"acl:Read","auth.right.resource.read"),Ie(He,"acl:Append","auth.right.resource.append"),Ie(He,"acl:Write","auth.right.resource.write"),Ie(He,"acl:Control","auth.right.resource.control"),He),st=(Ie(Je={},"acl:Read","auth.right.container.read"),Ie(Je,"acl:Write","auth.right.container.write"),Ie(Je,"acl:Control","auth.right.container.control"),Je),ut=F((function(){return{list:{padding:0,width:"100%"},option:{padding:0}}})),lt=function(n){var a=n.agents,o=n.addPermission,i=ut(),u=c(),l=ze(t(null),2),f=l[0],p=l[1],m=ze(t(""),2),d=m[0],h=m[1],v=ze(t([]),2),g=v[0],b=v[1],y=s("Person",{page:1,perPage:100},{field:"pair:label",order:"ASC"},{q:d},{enabled:d.length>0}),_=y.ids,w=y.data;return r((function(){b(_.length>0?Object.values(w):[])}),[_,w]),e.createElement(ue,{classes:{option:i.option},getOptionLabel:function(e){return e["pair:label"]},filterOptions:function(e){return e.filter((function(e){return!Object.keys(a).includes(e.id)}))},options:g,noOptionsText:u("ra.navigation.no_results"),autoComplete:!0,blurOnSelect:!0,clearOnBlur:!0,disableClearable:!0,value:f,onChange:function(e,t){o(t.id||t["@id"],"acl:agent","acl:Read"),p(null),h(""),b([])},onInputChange:function(e,t){h(t)},renderInput:function(t){return e.createElement(M,Te({},t,{label:u("auth.input.agent_select"),variant:"filled",margin:"dense",fullWidth:!0}))},renderOption:function(t){return e.createElement($,{dense:!0,className:i.list},e.createElement(B,{button:!0},e.createElement(q,null,e.createElement(G,{src:t.image},e.createElement(le,null))),e.createElement(H,{primary:t["pair:label"]})))}})},ft=function(t){var r=t.agent;switch(r.predicate){case et:return"foaf:Agent"===r.id?e.createElement(me,null):e.createElement(de,null);case"acl:agent":return e.createElement(le,null);case"acl:agentGroup":return e.createElement(he,null);default:throw new Error("Unknown agent predicate: "+r.predicate)}},pt=F((function(){return{listItem:{paddingLeft:4,paddingRight:36},primaryText:{width:"30%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},secondaryText:{textAlign:"center",width:"60%",fontStyle:"italic",color:"grey"}}})),mt=function(n){var a=n.isContainer,o=n.agent,i=n.addPermission,s=n.removePermission,p=pt(),m=c(),d=u(),h=ze(e.useState(null),2),v=h[0],g=h[1],b=ze(t(),2),y=b[0],_=b[1],w=ze(t(!0),2),j=w[0],E=w[1],O=ze(t(),2),k=O[0],P=O[1];if(r((function(){"acl:agent"===o.predicate?d.getOne("Person",{id:o.id}).then((function(e){var t=e.data;_(t),E(!1)})).catch((function(e){P(e),E(!1)})):E(!1)}),[o.id,o.predicate]),"acl:agentGroup"===o.predicate)return null;var C=function(){return g(null)},x=a?st:ct;return j?e.createElement(l,null):k?e.createElement(f,null):e.createElement(B,{className:p.listItem},e.createElement(q,null,e.createElement(G,{src:null==y?void 0:y.image},e.createElement(ft,{agent:o}))),e.createElement(H,{className:p.primaryText,primary:y?y["pair:label"]:m("foaf:Agent"===o.id?"auth.agent.anonymous":"auth.agent.authenticated")}),e.createElement(H,{className:p.secondaryText,primary:o.permissions&&o.permissions.map((function(e){return m(x[e])})).join(", ")}),e.createElement(J,null,e.createElement(Y,{onClick:function(e){return g(e.currentTarget)}},e.createElement(fe,null)),e.createElement(K,{anchorEl:v,keepMounted:!0,open:Boolean(v),onClose:C},Object.entries(x).map((function(t){var r=ze(t,2),n=r[0],a=r[1],c=o.permissions&&o.permissions.includes(n);return e.createElement(Q,{key:n,onClick:function(){c?s(o.id,o.predicate,n):i(o.id,o.predicate,n),C()}},e.createElement(X,null,c?e.createElement(pe,null):null),e.createElement(H,{primary:m(a)}))})))))},dt=F((function(e){return{list:{width:"100%",maxWidth:"100%",backgroundColor:e.palette.background.paper}}})),ht=function(t){var r=t.isContainer,n=t.agents,a=t.addPermission,o=t.removePermission,i=dt();return e.createElement($,{dense:!0,className:i.list},Object.entries(n).map((function(t){var n=ze(t,2),i=n[0],c=n[1];return e.createElement(mt,{key:i,isContainer:r,agent:c,addPermission:a,removePermission:o})})))},vt=function(e){var a=p(e).permissions,o=m(),i=ze(t({}),2),c=i[0],s=i[1];r((function(){var e,t=(Ie(e={},"foaf:Agent",{id:"foaf:Agent",predicate:et,permissions:[]}),Ie(e,"acl:AuthenticatedAgent",{id:"acl:AuthenticatedAgent",predicate:et,permissions:[]}),e),r=function(e,r,n){t[e]?t[e].permissions.push(n):t[e]={id:e,predicate:r,permissions:[n]}};if(a){var n,o=function(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=We(e))){var t=0,r=function(){};return{s:r,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a,o=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw a}}}}(a);try{var i=function(){var e=n.value;e[et]&&Ke(e[et]).forEach((function(t){return r(t,et,e["acl:mode"])})),e["acl:agent"]&&Ke(e["acl:agent"]).forEach((function(t){return r(t,"acl:agent",e["acl:mode"])})),e["acl:agentGroup"]&&Ke(e["acl:agentGroup"]).forEach((function(t){return r(t,"acl:agentGroup",e["acl:mode"])}))};for(o.s();!(n=o.n()).done;)i()}catch(e){o.e(e)}finally{o.f()}s(t)}}),[a]);var u=n((function(t,r,n){var a,i=Ne({},c);s(Ne(Ne({},c),{},Ie({},t,{id:t,predicate:r,permissions:c[t]?[].concat(Le(null===(a=c[t])||void 0===a?void 0:a.permissions),[n]):[n]}))),o.addPermission(e,t,r,n).catch((function(e){s(i)}))}),[c,s,e,o]),l=n((function(t,r,n){var a=Ne({},c);s(Object.fromEntries(Object.entries(c).map((function(e){var r=ze(e,2),a=r[0],o=r[1];return o.id===t&&(o.permissions=o.permissions.filter((function(e){return e!==n}))),[a,o]})).filter((function(e){var t=ze(e,2),r=(t[0],t[1]);return r.predicate===et||r.permissions.length>0})))),o.removePermission(e,t,r,n).catch((function(e){s(a)}))}),[c,s,e,o]);return{agents:c,addPermission:u,removePermission:l}},gt=F((function(){return{title:{paddingBottom:8},actions:{padding:15},addForm:{paddingTop:0},listForm:{paddingTop:0,paddingBottom:0,paddingRight:0,maxHeight:210}}})),bt=function(t){var r=t.open,n=t.onClose,a=t.resourceId,o=t.isContainer,i=gt(),s=c(),u=vt(a),l=u.agents,f=u.addPermission,p=u.removePermission;return e.createElement(Z,{fullWidth:!0,open:r,onClose:n},e.createElement(ee,{className:i.title},s(o?"auth.dialog.container_permissions":"auth.dialog.resource_permissions")),e.createElement(te,{className:i.addForm},e.createElement(lt,{agents:l,addPermission:f})),e.createElement(te,{className:i.listForm},e.createElement(ht,{isContainer:o,agents:l,addPermission:f,removePermission:p})),e.createElement(re,{className:i.actions},e.createElement(d,{label:"ra.action.close",variant:"text",onClick:n})))},yt=function(r){var n=r.record,a=r.resource,o=ze(t(!1),2),i=o[0],c=o[1],s=!!a?a:n.id||n["@id"];return e.createElement(e.Fragment,null,e.createElement(d,{label:"auth.action.permissions",onClick:function(){return c(!0)}},e.createElement(D,null)),e.createElement(bt,{resourceId:s,isContainer:!!a,open:i,onClose:function(){return c(!1)}}))},_t=function(t){var r=t.basePath,n=t.className,a=t.data,o=t.hasList,i=t.hasShow,c=t.hasControl,s=Ue(t,["basePath","className","data","hasList","hasShow","hasControl"]);return e.createElement(L,Te({className:n},s),o&&e.createElement(h,{basePath:r,record:a}),i&&e.createElement(v,{basePath:r,record:a}),a&&c&&e.createElement(yt,{basePath:r,record:a}))},wt=function(t){var r=g(),n=p(r.id).permissions;return n&&n.some((function(e){return nt.includes(e["acl:mode"])}))?e.createElement(b,t):null},jt=F((function(){return{toolbar:{flex:1,display:"flex",justifyContent:"space-between"}}})),Et=function(t){var r=jt();return e.createElement(y,Te({},t,{className:r.toolbar}),e.createElement(_,null),e.createElement(wt,{undoable:!1}),"}")},Ot=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",a=p(e),o=a.permissions,i=w(),c=j();return r((function(){o&&!o.some((function(e){return ot[t].includes(e["acl:mode"])}))&&(i(it[t],"error"),c(n))}),[o,c,i]),o},kt=function(t){var r=Ot(t.id,"edit");return e.createElement(E,Te({actions:e.createElement(_t,{hasControl:!!r&&r.some((function(e){return at.includes(e["acl:mode"])}))})},t,{permissions:r}),e.cloneElement(t.children,Ne({toolbar:e.createElement(Et,null)},t.children.props)))},Pt=function(t){var r=t.actions,n=t.resource,a=t.hasCreate,o=Ue(t,["actions","resource","hasCreate"]),i=p(n).permissions;return e.createElement(W,Te({},o,{resource:n,hasCreate:a&&!!i&&i.some((function(e){return tt.includes(e["acl:mode"])})),actions:r&&i&&i.some((function(e){return at.includes(e["acl:mode"])}))?e.cloneElement(r,{bulkActions:e.createElement(yt,null)}):r}))};Pt.defaultProps={actions:e.createElement(V,null)};var Ct=function(t){var r=t.basePath,n=t.className,a=t.data,o=t.hasList,i=t.hasEdit,c=t.hasControl,s=Ue(t,["basePath","className","data","hasList","hasEdit","hasControl"]);return e.createElement(L,Te({className:n},s),o&&e.createElement(h,{basePath:r,record:a}),i&&e.createElement(O,{basePath:r,record:a}),a&&c&&e.createElement(yt,{basePath:r,record:a}))},xt=function(t){var r=p(t.id).permissions;return e.createElement(k,Te({actions:e.createElement(Ct,{hasControl:!!r&&r.some((function(e){return at.includes(e["acl:mode"])}))})},t,{permissions:r,hasEdit:t.hasEdit&&!!r&&r.some((function(e){return rt.includes(e["acl:mode"])}))}))},St=ge((function(e){return{main:{display:"flex",flexDirection:"column",minHeight:"100vh",alignItems:"center",justifyContent:"flex-start",backgroundColor:e.palette.primary[500]},card:{minWidth:300,marginTop:"6em"},lockIconAvatar:{margin:"1em",display:"flex",justifyContent:"center"},lockIcon:{backgroundColor:e.palette.secondary[500]}}})),At=function(t){var n=t.theme,a=t.history,o=t.location,i=t.buttons,c=t.userResource,s=St(),l=w(),f=P(),p=u(),d=m();return r((function(){Ae(regeneratorRuntime.mark((function e(){var t,r,n,i,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=new URLSearchParams(o.search)).has("login")){e.next=14;break}if(!t.has("error")){e.next=6;break}"registration.not-allowed"===t.get("error")?l("auth.message.user_email_not_found","error"):l("auth.message.bad_request","error",{error:t.get("error")}),e.next=14;break;case 6:if(!t.has("token")){e.next=14;break}return r=t.get("token"),n=Be(r),i=n.webId,e.next=11,p.getOne("Person",{id:i});case 11:s=e.sent,u=s.data,d.checkUser(u)?(localStorage.setItem("token",r),t.has("new")&&"true"===t.get("new")?(l("auth.message.new_user_created","info"),a.push("/"+c+"/"+encodeURIComponent(i)+"/edit")):(l("auth.message.user_connected","info"),a.push("/"))):(l("auth.message.user_not_allowed_to_login","error"),a.replace("/login"));case 14:t.has("logout")&&(localStorage.removeItem("token"),l("auth.message.user_disconnected","info"),a.push("/"));case 15:case"end":return e.stop()}}),e)})))()}),[o.search]),e.createElement(ve,{theme:be(n)},e.createElement("div",{className:s.main},e.createElement(ne,{className:s.card},e.createElement("div",{className:s.lockIconAvatar},e.createElement(G,{className:s.lockIcon},e.createElement(ye,null))),i&&i.map((function(t,r){return e.createElement(ae,{key:r},e.cloneElement(t,{fullWidth:!0,variant:"outlined",type:"submit",onClick:function(){return f({},"/login")}}))})))),e.createElement(C,null))};At.defaultProps={buttons:[e.createElement(oe,{startIcon:e.createElement(G,{src:"/lescommuns.jpg"})},"Les Communs")],userResource:"Person"};function It(){}function Tt(){}Tt.resetWarningCache=It;var Rt=Ge((function(e){e.exports=function(){function e(e,t,r,n,a,o){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==o){var i=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw i.name="Invariant Violation",i}}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:Tt,resetWarningCache:It};return r.PropTypes=r,r}()})),Nt=ge((function(e){return{form:{padding:"0 1em 1em 1em"},input:{marginTop:"1em"},button:{width:"100%"},icon:{marginRight:e.spacing(1)}}})),Ut=function(e){var t=e.meta,r=t.touched,n=t.error,o=e.input,i=Ue(e,["meta","input"]);return a(M,Te({error:!(!r||!n),helperText:r&&n},o,i,{fullWidth:!0}))},zt=function(e){var t=e.redirectTo,r=ze(x(!1),2),n=r[0],o=r[1],i=m(),s=c(),u=w(),l=we(),f=Nt(e);return a(Oe,{onSubmit:function(e){o(!0),i.signup(e,t).then((function(e){o(!1),u("auth.message.new_user_created","info"),l.push("/Person/"+encodeURIComponent(e)+"/edit")})).catch((function(e){o(!1),u("string"==typeof e?e:void 0!==e&&e.message?e.message:"ra.auth.sign_in_error","warning",{_:"string"==typeof e?e:e&&e.message?e.message:void 0})}))},validate:function(e){var t={email:void 0,password:void 0};return e.email||(t.email=s("ra.validation.required")),e.password||(t.password=s("ra.validation.required")),t},render:function(e){var t=e.handleSubmit;return a("form",{onSubmit:t,noValidate:!0},a("div",{className:f.form},a("div",{className:f.input},a(ke,{autoFocus:!0,id:"name",name:"name",component:Ut,label:s("auth.input.name"),disabled:n})),a("div",{className:f.input},a(ke,{id:"email",name:"email",component:Ut,label:s("auth.input.email"),disabled:n})),a("div",{className:f.input},a(ke,{id:"password",name:"password",component:Ut,label:s("ra.auth.password"),type:"password",disabled:n}))),a(ae,null,a(oe,{variant:"contained",type:"submit",color:"primary",disabled:n,className:f.button},n&&a(ie,{className:f.icon,size:18,thickness:2}),s("auth.action.signup"))))}})};zt.propTypes={redirectTo:Rt.string};var Lt=F((function(e){return{main:{display:"flex",flexDirection:"column",minHeight:"100vh",height:"1px",alignItems:"center",justifyContent:"flex-start",backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundImage:"radial-gradient(circle at 50% 14em, #313264 0%, #00023b 60%, #00023b 100%)"},card:{minWidth:300,marginTop:"6em"},avatar:{margin:"1em",display:"flex",justifyContent:"center"},icon:{backgroundColor:e.palette.secondary[500]},switch:{margin:"1em",display:"flex",justifyContent:"center"}}})),Wt=function(t){var r=t.theme,n=(t.title,t.classes,t.className),a=Ue(t,["theme","title","classes","className"]),i=Lt(t),c=je(),s=o((function(){return S(r)}),[r]),u=new URLSearchParams(c.search).has("signup");return e.createElement(ce,{theme:s},e.createElement("div",Te({className:_e(i.main,n)},a),e.createElement(ne,{className:i.card},e.createElement("div",{className:i.avatar},e.createElement(G,{className:i.icon},e.createElement(ye,null))),u?e.createElement(zt,null):e.createElement(A,null),e.createElement("div",{className:i.switch},u?e.createElement(Ee,{to:"/login"},e.createElement(se,{variant:"body2"},"Se connecter avec un compte")):e.createElement(Ee,{to:"/login?signup=true"},e.createElement(se,{variant:"body2"},"Créer un nouveau compte")))),e.createElement(C,null)))};Wt.propTypes={children:Rt.node,classes:Rt.object,className:Rt.string,theme:Rt.object};var Vt=i((function(t,r){var n=I();return e.createElement(Pe,{onClick:function(){return n()},ref:r},e.createElement(Ce,null),"   Se déconnecter")})),Dt=function(t){var r=t.name,n=t.create,a=Ue(t,["name","create"]),o=p(r).permissions;return e.createElement(T,Te({},a,{name:r,create:o&&o.some((function(e){return tt.includes(e["acl:mode"])}))?n:void 0}))},Ft=i((function(t,r){var n=t.onClick,a=t.webId;return e.createElement(R,{ref:r,to:"/Person/".concat(encodeURIComponent(a),"/show"),primaryText:"Voir mon profil",leftIcon:e.createElement(xe,null),onClick:n})})),Mt=i((function(t,r){var n=t.onClick,a=t.webId;return e.createElement(R,{ref:r,to:"/Person/".concat(encodeURIComponent(a),"/edit"),primaryText:"Editer mon profil",leftIcon:e.createElement(fe,null),onClick:n})})),$t=i((function(t,r){var n=t.onClick;return e.createElement(R,{ref:r,to:"/login",primaryText:"Se connecter!!",onClick:n})})),Bt=i((function(t,r){var n=t.onClick;return e.createElement(R,{ref:r,to:"/login?signup=true",primaryText:"Créer un compte",onClick:n})})),qt=function(t){var r=t.logout,n=Ue(t,["logout"]),a=N().identity;return e.createElement(U,n,a&&""!==a.id?[e.createElement(Ft,{webId:a.id,key:"view"}),e.createElement(Mt,{webId:a.id,key:"edit"}),e.cloneElement(r,{key:"logout"})]:[e.createElement(Bt,{key:"signup"}),e.createElement($t,{key:"login"})])},Gt=function(){var e=N(),t=e.identity,n=e.loading,a=w(),o=j();return r((function(){n||(null==t?void 0:t.id)||(a("ra.auth.auth_check_error","error"),o("/login"))}),[n,t,o,a]),{identity:t,loading:n}};var Ht=function(){this.__data__=[],this.size=0};var Jt=function(e,t){return e===t||e!=e&&t!=t};var Yt=function(e,t){for(var r=e.length;r--;)if(Jt(e[r][0],t))return r;return-1},Kt=Array.prototype.splice;var Qt=function(e){var t=this.__data__,r=Yt(t,e);return!(r<0)&&(r==t.length-1?t.pop():Kt.call(t,r,1),--this.size,!0)};var Xt=function(e){var t=this.__data__,r=Yt(t,e);return r<0?void 0:t[r][1]};var Zt=function(e){return Yt(this.__data__,e)>-1};var er=function(e,t){var r=this.__data__,n=Yt(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function tr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}tr.prototype.clear=Ht,tr.prototype.delete=Qt,tr.prototype.get=Xt,tr.prototype.has=Zt,tr.prototype.set=er;var rr=tr;var nr=function(){this.__data__=new rr,this.size=0};var ar=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r};var or=function(e){return this.__data__.get(e)};var ir=function(e){return this.__data__.has(e)},cr="object"==typeof qe&&qe&&qe.Object===Object&&qe,sr="object"==typeof self&&self&&self.Object===Object&&self,ur=cr||sr||Function("return this")(),lr=ur.Symbol,fr=Object.prototype,pr=fr.hasOwnProperty,mr=fr.toString,dr=lr?lr.toStringTag:void 0;var hr=function(e){var t=pr.call(e,dr),r=e[dr];try{e[dr]=void 0;var n=!0}catch(e){}var a=mr.call(e);return n&&(t?e[dr]=r:delete e[dr]),a},vr=Object.prototype.toString;var gr=function(e){return vr.call(e)},br=lr?lr.toStringTag:void 0;var yr=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":br&&br in Object(e)?hr(e):gr(e)};var _r=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};var wr,jr=function(e){if(!_r(e))return!1;var t=yr(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},Er=ur["__core-js_shared__"],Or=(wr=/[^.]+$/.exec(Er&&Er.keys&&Er.keys.IE_PROTO||""))?"Symbol(src)_1."+wr:"";var kr=function(e){return!!Or&&Or in e},Pr=Function.prototype.toString;var Cr=function(e){if(null!=e){try{return Pr.call(e)}catch(e){}try{return e+""}catch(e){}}return""},xr=/^\[object .+?Constructor\]$/,Sr=Function.prototype,Ar=Object.prototype,Ir=Sr.toString,Tr=Ar.hasOwnProperty,Rr=RegExp("^"+Ir.call(Tr).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Nr=function(e){return!(!_r(e)||kr(e))&&(jr(e)?Rr:xr).test(Cr(e))};var Ur=function(e,t){return null==e?void 0:e[t]};var zr=function(e,t){var r=Ur(e,t);return Nr(r)?r:void 0},Lr=zr(ur,"Map"),Wr=zr(Object,"create");var Vr=function(){this.__data__=Wr?Wr(null):{},this.size=0};var Dr=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Fr=Object.prototype.hasOwnProperty;var Mr=function(e){var t=this.__data__;if(Wr){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return Fr.call(t,e)?t[e]:void 0},$r=Object.prototype.hasOwnProperty;var Br=function(e){var t=this.__data__;return Wr?void 0!==t[e]:$r.call(t,e)};var qr=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Wr&&void 0===t?"__lodash_hash_undefined__":t,this};function Gr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Gr.prototype.clear=Vr,Gr.prototype.delete=Dr,Gr.prototype.get=Mr,Gr.prototype.has=Br,Gr.prototype.set=qr;var Hr=Gr;var Jr=function(){this.size=0,this.__data__={hash:new Hr,map:new(Lr||rr),string:new Hr}};var Yr=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var Kr=function(e,t){var r=e.__data__;return Yr(t)?r["string"==typeof t?"string":"hash"]:r.map};var Qr=function(e){var t=Kr(this,e).delete(e);return this.size-=t?1:0,t};var Xr=function(e){return Kr(this,e).get(e)};var Zr=function(e){return Kr(this,e).has(e)};var en=function(e,t){var r=Kr(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function tn(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}tn.prototype.clear=Jr,tn.prototype.delete=Qr,tn.prototype.get=Xr,tn.prototype.has=Zr,tn.prototype.set=en;var rn=tn;var nn=function(e,t){var r=this.__data__;if(r instanceof rr){var n=r.__data__;if(!Lr||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new rn(n)}return r.set(e,t),this.size=r.size,this};function an(e){var t=this.__data__=new rr(e);this.size=t.size}an.prototype.clear=nr,an.prototype.delete=ar,an.prototype.get=or,an.prototype.has=ir,an.prototype.set=nn;var on=an;var cn=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this};var sn=function(e){return this.__data__.has(e)};function un(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new rn;++t<r;)this.add(e[t])}un.prototype.add=un.prototype.push=cn,un.prototype.has=sn;var ln=un;var fn=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1};var pn=function(e,t){return e.has(t)};var mn=function(e,t,r,n,a,o){var i=1&r,c=e.length,s=t.length;if(c!=s&&!(i&&s>c))return!1;var u=o.get(e);if(u&&o.get(t))return u==t;var l=-1,f=!0,p=2&r?new ln:void 0;for(o.set(e,t),o.set(t,e);++l<c;){var m=e[l],d=t[l];if(n)var h=i?n(d,m,l,t,e,o):n(m,d,l,e,t,o);if(void 0!==h){if(h)continue;f=!1;break}if(p){if(!fn(t,(function(e,t){if(!pn(p,t)&&(m===e||a(m,e,r,n,o)))return p.push(t)}))){f=!1;break}}else if(m!==d&&!a(m,d,r,n,o)){f=!1;break}}return o.delete(e),o.delete(t),f},dn=ur.Uint8Array;var hn=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r};var vn=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r},gn=lr?lr.prototype:void 0,bn=gn?gn.valueOf:void 0;var yn=function(e,t,r,n,a,o,i){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new dn(e),new dn(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Jt(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var c=hn;case"[object Set]":var s=1&n;if(c||(c=vn),e.size!=t.size&&!s)return!1;var u=i.get(e);if(u)return u==t;n|=2,i.set(e,t);var l=mn(c(e),c(t),n,a,o,i);return i.delete(e),l;case"[object Symbol]":if(bn)return bn.call(e)==bn.call(t)}return!1};var _n=function(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e},wn=Array.isArray;var jn=function(e,t,r){var n=t(e);return wn(e)?n:_n(n,r(e))};var En=function(e,t){for(var r=-1,n=null==e?0:e.length,a=0,o=[];++r<n;){var i=e[r];t(i,r,e)&&(o[a++]=i)}return o};var On=function(){return[]},kn=Object.prototype.propertyIsEnumerable,Pn=Object.getOwnPropertySymbols,Cn=Pn?function(e){return null==e?[]:(e=Object(e),En(Pn(e),(function(t){return kn.call(e,t)})))}:On;var xn=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n};var Sn=function(e){return null!=e&&"object"==typeof e};var An=function(e){return Sn(e)&&"[object Arguments]"==yr(e)},In=Object.prototype,Tn=In.hasOwnProperty,Rn=In.propertyIsEnumerable,Nn=An(function(){return arguments}())?An:function(e){return Sn(e)&&Tn.call(e,"callee")&&!Rn.call(e,"callee")};var Un=function(){return!1},zn=Ge((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,a=n&&n.exports===r?ur.Buffer:void 0,o=(a?a.isBuffer:void 0)||Un;e.exports=o})),Ln=/^(?:0|[1-9]\d*)$/;var Wn=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&Ln.test(e))&&e>-1&&e%1==0&&e<t};var Vn=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},Dn={};Dn["[object Float32Array]"]=Dn["[object Float64Array]"]=Dn["[object Int8Array]"]=Dn["[object Int16Array]"]=Dn["[object Int32Array]"]=Dn["[object Uint8Array]"]=Dn["[object Uint8ClampedArray]"]=Dn["[object Uint16Array]"]=Dn["[object Uint32Array]"]=!0,Dn["[object Arguments]"]=Dn["[object Array]"]=Dn["[object ArrayBuffer]"]=Dn["[object Boolean]"]=Dn["[object DataView]"]=Dn["[object Date]"]=Dn["[object Error]"]=Dn["[object Function]"]=Dn["[object Map]"]=Dn["[object Number]"]=Dn["[object Object]"]=Dn["[object RegExp]"]=Dn["[object Set]"]=Dn["[object String]"]=Dn["[object WeakMap]"]=!1;var Fn=function(e){return Sn(e)&&Vn(e.length)&&!!Dn[yr(e)]};var Mn=function(e){return function(t){return e(t)}},$n=Ge((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,a=n&&n.exports===r&&cr.process,o=function(){try{var e=n&&n.require&&n.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=o})),Bn=$n&&$n.isTypedArray,qn=Bn?Mn(Bn):Fn,Gn=Object.prototype.hasOwnProperty;var Hn=function(e,t){var r=wn(e),n=!r&&Nn(e),a=!r&&!n&&zn(e),o=!r&&!n&&!a&&qn(e),i=r||n||a||o,c=i?xn(e.length,String):[],s=c.length;for(var u in e)!t&&!Gn.call(e,u)||i&&("length"==u||a&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Wn(u,s))||c.push(u);return c},Jn=Object.prototype;var Yn=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Jn)};var Kn=function(e,t){return function(r){return e(t(r))}}(Object.keys,Object),Qn=Object.prototype.hasOwnProperty;var Xn=function(e){if(!Yn(e))return Kn(e);var t=[];for(var r in Object(e))Qn.call(e,r)&&"constructor"!=r&&t.push(r);return t};var Zn=function(e){return null!=e&&Vn(e.length)&&!jr(e)};var ea=function(e){return Zn(e)?Hn(e):Xn(e)};var ta=function(e){return jn(e,ea,Cn)},ra=Object.prototype.hasOwnProperty;var na=function(e,t,r,n,a,o){var i=1&r,c=ta(e),s=c.length;if(s!=ta(t).length&&!i)return!1;for(var u=s;u--;){var l=c[u];if(!(i?l in t:ra.call(t,l)))return!1}var f=o.get(e);if(f&&o.get(t))return f==t;var p=!0;o.set(e,t),o.set(t,e);for(var m=i;++u<s;){var d=e[l=c[u]],h=t[l];if(n)var v=i?n(h,d,l,t,e,o):n(d,h,l,e,t,o);if(!(void 0===v?d===h||a(d,h,r,n,o):v)){p=!1;break}m||(m="constructor"==l)}if(p&&!m){var g=e.constructor,b=t.constructor;g==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof g&&g instanceof g&&"function"==typeof b&&b instanceof b||(p=!1)}return o.delete(e),o.delete(t),p},aa=zr(ur,"DataView"),oa=zr(ur,"Promise"),ia=zr(ur,"Set"),ca=zr(ur,"WeakMap"),sa=Cr(aa),ua=Cr(Lr),la=Cr(oa),fa=Cr(ia),pa=Cr(ca),ma=yr;(aa&&"[object DataView]"!=ma(new aa(new ArrayBuffer(1)))||Lr&&"[object Map]"!=ma(new Lr)||oa&&"[object Promise]"!=ma(oa.resolve())||ia&&"[object Set]"!=ma(new ia)||ca&&"[object WeakMap]"!=ma(new ca))&&(ma=function(e){var t=yr(e),r="[object Object]"==t?e.constructor:void 0,n=r?Cr(r):"";if(n)switch(n){case sa:return"[object DataView]";case ua:return"[object Map]";case la:return"[object Promise]";case fa:return"[object Set]";case pa:return"[object WeakMap]"}return t});var da=ma,ha=Object.prototype.hasOwnProperty;var va=function(e,t,r,n,a,o){var i=wn(e),c=wn(t),s=i?"[object Array]":da(e),u=c?"[object Array]":da(t),l="[object Object]"==(s="[object Arguments]"==s?"[object Object]":s),f="[object Object]"==(u="[object Arguments]"==u?"[object Object]":u),p=s==u;if(p&&zn(e)){if(!zn(t))return!1;i=!0,l=!1}if(p&&!l)return o||(o=new on),i||qn(e)?mn(e,t,r,n,a,o):yn(e,t,s,r,n,a,o);if(!(1&r)){var m=l&&ha.call(e,"__wrapped__"),d=f&&ha.call(t,"__wrapped__");if(m||d){var h=m?e.value():e,v=d?t.value():t;return o||(o=new on),a(h,v,r,n,o)}}return!!p&&(o||(o=new on),na(e,t,r,n,a,o))};var ga=function e(t,r,n,a,o){return t===r||(null==t||null==r||!Sn(t)&&!Sn(r)?t!=t&&r!=r:va(t,r,n,a,e,o))};var ba=function(e,t){return ga(e,t)},ya={},_a={"{}":void 0},wa=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ya,t=JSON.stringify(e),a=x({permissions:_a[t]}),o=ze(a,2),i=o[0],c=o[1],s=z(),u=n((function(){return s(e).then((function(e){ba(e,i.permissions)||(_a[t]=e,c({permissions:e}))})).catch((function(e){c({error:e})}))}),[t,e,s]);return r((function(){u()}),[t]),Ne(Ne({},i),{},{refetch:u})},ja={auth:{dialog:{container_permissions:"Permissions sur le container",resource_permissions:"Permissions sur la resource"},action:{permissions:"Permissions",signup:"S'inscrire"},right:{resource:{read:"Lire",append:"Enrichir",write:"Modifier",control:"Administrer"},container:{read:"Lister",append:"Ajouter",write:"Ajouter",control:"Administrer"}},agent:{anonymous:"Tous les utilisateurs",authenticated:"Utilisateurs connectés"},input:{agent_select:"Ajouter un utilisateur...",name:"Prénom",email:"Adresse e-mail"},message:{resource_show_forbidden:"Vous n'avez pas la permission de voir cette ressource",resource_edit_forbidden:"Vous n'avez pas la permission d'éditer cette ressource",resource_delete_forbidden:"Vous n'avez pas la permission d'effacer cette ressource",resource_control_forbidden:"Vous n'avez pas la permission d'administrer cette ressource",container_create_forbidden:"Vous n'avez pas la permission de créer des ressources",container_list_forbidden:"Vous n'avez pas la permission de voir ces ressources",user_not_allowed_to_login:"Vous n'avez pas le droit de vous connecter avec ce compte",user_email_not_found:"Aucun compte trouvé avec cette adresse mail",user_email_exist:"Un compte existe déjà avec cette adresse mail",new_user_created:"Votre compte a été créé, vous pouvez maintenant le compléter",user_connected:"Vous êtes maintenant connecté",user_disconnected:"Vous êtes maintenant déconnecté",bad_request:"Requête erronée (Message d'erreur renvoyé par le serveur: %{error})"}}};export{wt as DeleteButtonWithPermissions,_t as EditActions,Et as EditToolbarWithPermissions,kt as EditWithPermissions,Pt as ListWithPermissions,Wt as LocalLoginPage,At as LoginPage,Vt as LogoutButton,yt as PermissionsButton,Dt as ResourceWithPermissions,Ct as ShowActions,xt as ShowWithPermissions,At as SsoLoginPage,qt as UserMenu,Ze as authProvider,ja as frenchMessages,vt as useAgents,Gt as useCheckAuthenticated,Ot as useCheckPermissions,wa as usePermissionsWithRefetch};
//# sourceMappingURL=index.es.js.map
