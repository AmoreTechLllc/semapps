import e,{useState as t,useEffect as r,useCallback as n,createElement as a,useMemo as o,forwardRef as i}from"react";import{useTranslate as c,useGetList as s,useDataProvider as u,Loading as l,Error as m,usePermissionsOptimized as d,useAuthProvider as f,Button as p,ListButton as h,ShowButton as v,useRecordContext as g,DeleteButton as b,Toolbar as y,SaveButton as w,useGetIdentity as _,useNotify as j,useRedirect as E,Edit as O,EditButton as k,Show as x,useLogin as P,Notification as C,useSafeSetState as S,LoginForm as A,useLogout as I,Resource as T,MenuItemLink as R,UserMenu as N,useGetPermissions as U}from"react-admin";import{TopToolbar as z,List as L,ListActions as W}from"@semapps/archipelago-layout";import V from"@material-ui/icons/Share";import{makeStyles as D,TextField as F,List as M,ListItem as B,ListItemAvatar as $,Avatar as q,ListItemText as G,ListItemSecondaryAction as H,IconButton as J,Menu as Y,MenuItem as K,ListItemIcon as Q,Dialog as X,DialogTitle as Z,DialogContent as ee,DialogActions as te,Card as re,Typography as ne,CardActions as ae,Button as oe,CircularProgress as ie,createMuiTheme as ce,ThemeProvider as se}from"@material-ui/core";import ue from"@material-ui/lab/Autocomplete";import le from"@material-ui/icons/Person";import me from"@material-ui/icons/Edit";import de from"@material-ui/icons/Check";import fe from"@material-ui/icons/Public";import pe from"@material-ui/icons/VpnLock";import he from"@material-ui/icons/Group";import{useLocation as ve,Redirect as ge,Link as be}from"react-router-dom";import{ThemeProvider as ye}from"@material-ui/styles";import{makeStyles as we,createMuiTheme as _e}from"@material-ui/core/styles";import je from"@material-ui/icons/Lock";import Ee from"classnames";import{Form as Oe,Field as ke}from"react-final-form";import xe from"@material-ui/core/MenuItem";import Pe from"@material-ui/icons/PowerSettingsNew";import Ce from"@material-ui/icons/AccountCircle";function Se(e,t,r,n,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void r(e)}c.done?t(s):Promise.resolve(s).then(n,a)}function Ae(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Se(o,n,a,i,c,"next",e)}function c(e){Se(o,n,a,i,c,"throw",e)}i(void 0)}))}}function Ie(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Te(){return(Te=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ne(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(r),!0).forEach((function(t){Ie(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Re(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ue(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ze(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||We(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Le(e){return function(e){if(Array.isArray(e))return Ve(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||We(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function We(e,t){if(e){if("string"==typeof e)return Ve(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ve(e,t):void 0}}function Ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function De(e){this.message=e}De.prototype=new Error,De.prototype.name="InvalidCharacterError";var Fe="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new De("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,n,a=0,o=0,i="";n=t.charAt(o++);~n&&(r=a%4?64*r+n:n,a++%4)?i+=String.fromCharCode(255&r>>(-2*a&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return i};function Me(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(Fe(e).replace(/(.)/g,(function(e,t){var r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r})))}(t)}catch(e){return Fe(t)}}function Be(e){this.message=e}function $e(e,t){if("string"!=typeof e)throw new Be("Invalid token specified");var r=!0===(t=t||{}).header?0:1;try{return JSON.parse(Me(e.split(".")[r]))}catch(e){throw new Be("Invalid token specified: "+e.message)}}Be.prototype=new Error,Be.prototype.name="InvalidTokenError";var qe="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Ge(e,t){return e(t={exports:{}},t.exports),t.exports}var He,Je,Ye=Ge((function(e){var t,r;t=qe,r=function(){function e(e){var t=[];if(0===e.length)return"";if("string"!=typeof e[0])throw new TypeError("Url must be a string. Received "+e[0]);if(e[0].match(/^[^/:]+:\/*$/)&&e.length>1){var r=e.shift();e[0]=r+e[0]}e[0].match(/^file:\/\/\//)?e[0]=e[0].replace(/^([^/:]+):\/*/,"$1:///"):e[0]=e[0].replace(/^([^/:]+):\/*/,"$1://");for(var n=0;n<e.length;n++){var a=e[n];if("string"!=typeof a)throw new TypeError("Url must be a string. Received "+a);""!==a&&(n>0&&(a=a.replace(/^[\/]+/,"")),a=n<e.length-1?a.replace(/[\/]+$/,""):a.replace(/[\/]+$/,"/"),t.push(a))}var o=t.join("/"),i=(o=o.replace(/\/(\?|&|#[^!])/g,"$1")).split("?");return o=i.shift()+(i.length>0?"?":"")+i.join("&")}return function(){return e("object"==typeof arguments[0]?arguments[0]:[].slice.call(arguments))}},e.exports?e.exports=r():t.urljoin=r()})),Ke=function(e){return e?Array.isArray(e)?e:[e]:void 0},Qe=function(e,t){return Ye(e,t.replace(e,"_acl/"))},Xe=function(e){return{"@base":e,acl:"http://www.w3.org/ns/auth/acl#",foaf:"http://xmlns.com/foaf/0.1/","acl:agent":{"@type":"@id"},"acl:agentGroup":{"@type":"@id"},"acl:agentClass":{"@type":"@id"},"acl:mode":{"@type":"@id"},"acl:accessTo":{"@type":"@id"}}},Ze=function(e){var t,r,n,a,o,i,c,s,u=e.middlewareUri,l=e.allowAnonymous,m=void 0===l||l,d=e.localAccounts,f=void 0!==d&&d,p=e.checkUser,h=e.httpClient,v=e.checkPermissions,g=e.resources;return{login:(s=Ae(regeneratorRuntime.mark((function e(t){var r,n,a,o,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=new URL(window.location.href),!f){e.next=18;break}return n=t.username,a=t.password,e.prev=3,e.next=6,h("".concat(u,"auth/login"),{method:"POST",body:JSON.stringify({username:n.trim(),password:a.trim()}),headers:new Headers({"Content-Type":"application/json"})});case 6:o=e.sent,i=o.json,c=i.token,localStorage.setItem("token",c),window.location.reload(),e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(3),new Error("ra.auth.sign_in_error");case 16:e.next=19;break;case 18:window.location.href="".concat(u,"auth?redirectUrl=")+encodeURIComponent(r.origin+"/login?login=true");case 19:case"end":return e.stop()}}),e,null,[[3,13]])}))),function(e){return s.apply(this,arguments)}),signup:(c=Ae(regeneratorRuntime.mark((function e(t){var r,n,a,o,i,c,s,l,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!f){e.next=22;break}return r=t.username,n=t.email,a=t.password,o=Ue(t,["username","email","password"]),e.prev=2,e.next=5,h("".concat(u,"auth/signup"),{method:"POST",body:JSON.stringify(Ne({username:r.trim(),email:n.trim(),password:a.trim()},o)),headers:new Headers({"Content-Type":"application/json"})});case 5:return i=e.sent,c=i.json,s=c.token,localStorage.setItem("token",s),l=$e(s),m=l.webId,e.abrupt("return",m);case 13:if(e.prev=13,e.t0=e.catch(2),"email.already.exists"!==e.t0.message){e.next=19;break}throw new Error("auth.message.user_email_exist");case 19:throw new Error(e.t0.message||"ra.auth.sign_in_error");case 20:e.next=23;break;case 22:window.location.href="".concat(u,"auth?redirectUrl=")+encodeURIComponent(url.origin+"/login?login=true");case 23:case"end":return e.stop()}}),e,null,[[2,13]])}))),function(e){return c.apply(this,arguments)}),logout:(i=Ae(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.removeItem("token"),f?(window.location.reload(),window.location.href="/"):(t=new URL(window.location.href),window.location.href=m?"".concat(u,"auth/logout?redirectUrl=")+encodeURIComponent(t.origin+"/login?logout=true"):"".concat(u,"auth/logout?redirectUrl=")+encodeURIComponent(t.origin+"/login")),e.abrupt("return","/");case 3:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)}),checkAuth:(o=Ae(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(localStorage.getItem("token")||m){e.next=3;break}throw new Error;case 3:case"end":return e.stop()}}),e)}))),function(){return o.apply(this,arguments)}),checkUser:function(e){return!p||p(e)},checkError:function(e){return Promise.resolve()},getPermissions:(a=Ae(regeneratorRuntime.mark((function e(t){var r,n,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v){e.next=2;break}return e.abrupt("return",!0);case 2:return r=g[t]?g[t].containerUri:t,n=Qe(u,r),e.next=6,h(n);case 6:return a=e.sent,o=a.json,e.abrupt("return",o["@graph"]);case 9:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),addPermission:(n=Ae(regeneratorRuntime.mark((function e(t,r,n,a){var o,i,c,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=g[t]?g[t].containerUri:t,c=Qe(u,i),Ie(o={"@id":"#"+a.replace("acl:",""),"@type":"acl:Authorization"},n,r),Ie(o,"acl:accessTo",i),Ie(o,"acl:mode",a),s=o,e.next=5,h(c,{method:"PATCH",body:JSON.stringify({"@context":Xe(c),"@graph":[s]})});case 5:case"end":return e.stop()}}),e)}))),function(e,t,r,a){return n.apply(this,arguments)}),removePermission:(r=Ae(regeneratorRuntime.mark((function e(t,r,n,a){var o,i,c,s,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=g[t]?g[t].containerUri:t,i=Qe(u,o),e.next=4,h(i);case 4:return c=e.sent,s=c.json,l=s["@graph"].filter((function(e){return!e["@id"].includes("#Default")})).map((function(e){var t=Ke(e["acl:mode"]),o=Ke(e[n]);return a&&t.includes(a)&&o&&o.includes(r)&&(o=o.filter((function(e){return e!==r}))),Ne(Ne({},e),{},Ie({},n,o))})),e.next=9,h(i,{method:"PUT",body:JSON.stringify({"@context":Xe(i),"@graph":l})});case 9:case"end":return e.stop()}}),e)}))),function(e,t,n,a){return r.apply(this,arguments)}),getIdentity:(t=Ae(regeneratorRuntime.mark((function e(){var t,r,n,a,o,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=localStorage.getItem("token"))){e.next=17;break}return r=$e(t),n=r.webId,e.next=5,h(n);case 5:if(a=e.sent,!(o=a.json).url){e.next=13;break}return e.next=10,h(o.url);case 10:e.t0=e.sent,e.next=14;break;case 13:e.t0={};case 14:return i=e.t0,c=i.json,e.abrupt("return",{id:n,fullName:(null==c?void 0:c["pair:label"])||o["foaf:name"],profileData:c,webIdData:o});case 17:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}},et="acl:agentClass",tt=["acl:Append","acl:Write","acl:Control"],rt=["acl:Append","acl:Write","acl:Control"],nt=["acl:Write","acl:Control"],at=["acl:Control"],ot={show:["acl:Read","acl:Append","acl:Write","acl:Control"],list:["acl:Read","acl:Append","acl:Write","acl:Control"],create:tt,edit:rt,delete:nt,control:at},it={show:"auth.message.resource_show_forbidden",edit:"auth.message.resource_edit_forbidden",delete:"auth.message.resource_delete_forbidden",control:"auth.message.resource_control_forbidden",list:"auth.message.container_list_forbidden",create:"auth.message.container_create_forbidden"},ct=(Ie(He={},"acl:Read","auth.right.resource.read"),Ie(He,"acl:Append","auth.right.resource.append"),Ie(He,"acl:Write","auth.right.resource.write"),Ie(He,"acl:Control","auth.right.resource.control"),He),st=(Ie(Je={},"acl:Read","auth.right.container.read"),Ie(Je,"acl:Write","auth.right.container.write"),Ie(Je,"acl:Control","auth.right.container.control"),Je),ut=D((function(){return{list:{padding:0,width:"100%"},option:{padding:0}}})),lt=function(n){var a=n.agents,o=n.addPermission,i=ut(),u=c(),l=ze(t(null),2),m=l[0],d=l[1],f=ze(t(""),2),p=f[0],h=f[1],v=ze(t([]),2),g=v[0],b=v[1],y=s("Person",{page:1,perPage:100},{field:"pair:label",order:"ASC"},{q:p},{enabled:p.length>0}),w=y.ids,_=y.data;return r((function(){b(w.length>0?Object.values(_):[])}),[w,_]),e.createElement(ue,{classes:{option:i.option},getOptionLabel:function(e){return e["pair:label"]},filterOptions:function(e){return e.filter((function(e){return!Object.keys(a).includes(e.id)}))},options:g,noOptionsText:u("ra.navigation.no_results"),autoComplete:!0,blurOnSelect:!0,clearOnBlur:!0,disableClearable:!0,value:m,onChange:function(e,t){o(t.id||t["@id"],"acl:agent","acl:Read"),d(null),h(""),b([])},onInputChange:function(e,t){h(t)},renderInput:function(t){return e.createElement(F,Te({},t,{label:u("auth.input.agent_select"),variant:"filled",margin:"dense",fullWidth:!0}))},renderOption:function(t){return e.createElement(M,{dense:!0,className:i.list},e.createElement(B,{button:!0},e.createElement($,null,e.createElement(q,{src:t.image},e.createElement(le,null))),e.createElement(G,{primary:t["pair:label"]})))}})},mt=function(t){var r=t.agent;switch(r.predicate){case et:return"foaf:Agent"===r.id?e.createElement(fe,null):e.createElement(pe,null);case"acl:agent":return e.createElement(le,null);case"acl:agentGroup":return e.createElement(he,null);default:throw new Error("Unknown agent predicate: "+r.predicate)}},dt=D((function(){return{listItem:{paddingLeft:4,paddingRight:36},primaryText:{width:"30%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},secondaryText:{textAlign:"center",width:"60%",fontStyle:"italic",color:"grey"}}})),ft=function(n){var a=n.isContainer,o=n.agent,i=n.addPermission,s=n.removePermission,d=dt(),f=c(),p=u(),h=ze(e.useState(null),2),v=h[0],g=h[1],b=ze(t(),2),y=b[0],w=b[1],_=ze(t(!0),2),j=_[0],E=_[1],O=ze(t(),2),k=O[0],x=O[1];if(r((function(){"acl:agent"===o.predicate?p.getOne("Person",{id:o.id}).then((function(e){var t=e.data;w(t),E(!1)})).catch((function(e){x(e),E(!1)})):E(!1)}),[o.id,o.predicate]),"acl:agentGroup"===o.predicate)return null;var P=function(){return g(null)},C=a?st:ct;return j?e.createElement(l,null):k?e.createElement(m,null):e.createElement(B,{className:d.listItem},e.createElement($,null,e.createElement(q,{src:null==y?void 0:y.image},e.createElement(mt,{agent:o}))),e.createElement(G,{className:d.primaryText,primary:y?y["pair:label"]:f("foaf:Agent"===o.id?"auth.agent.anonymous":"auth.agent.authenticated")}),e.createElement(G,{className:d.secondaryText,primary:o.permissions&&o.permissions.map((function(e){return f(C[e])})).join(", ")}),e.createElement(H,null,e.createElement(J,{onClick:function(e){return g(e.currentTarget)}},e.createElement(me,null)),e.createElement(Y,{anchorEl:v,keepMounted:!0,open:Boolean(v),onClose:P},Object.entries(C).map((function(t){var r=ze(t,2),n=r[0],a=r[1],c=o.permissions&&o.permissions.includes(n);return e.createElement(K,{key:n,onClick:function(){c?s(o.id,o.predicate,n):i(o.id,o.predicate,n),P()}},e.createElement(Q,null,c?e.createElement(de,null):null),e.createElement(G,{primary:f(a)}))})))))},pt=D((function(e){return{list:{width:"100%",maxWidth:"100%",backgroundColor:e.palette.background.paper}}})),ht=function(t){var r=t.isContainer,n=t.agents,a=t.addPermission,o=t.removePermission,i=pt();return e.createElement(M,{dense:!0,className:i.list},Object.entries(n).map((function(t){var n=ze(t,2),i=n[0],c=n[1];return e.createElement(ft,{key:i,isContainer:r,agent:c,addPermission:a,removePermission:o})})))},vt=function(e){var a=d(e).permissions,o=f(),i=ze(t({}),2),c=i[0],s=i[1];r((function(){var e,t=(Ie(e={},"foaf:Agent",{id:"foaf:Agent",predicate:et,permissions:[]}),Ie(e,"acl:AuthenticatedAgent",{id:"acl:AuthenticatedAgent",predicate:et,permissions:[]}),e),r=function(e,r,n){t[e]?t[e].permissions.push(n):t[e]={id:e,predicate:r,permissions:[n]}};if(a){var n,o=function(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=We(e))){var t=0,r=function(){};return{s:r,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a,o=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw a}}}}(a);try{var i=function(){var e=n.value;e[et]&&Ke(e[et]).forEach((function(t){return r(t,et,e["acl:mode"])})),e["acl:agent"]&&Ke(e["acl:agent"]).forEach((function(t){return r(t,"acl:agent",e["acl:mode"])})),e["acl:agentGroup"]&&Ke(e["acl:agentGroup"]).forEach((function(t){return r(t,"acl:agentGroup",e["acl:mode"])}))};for(o.s();!(n=o.n()).done;)i()}catch(e){o.e(e)}finally{o.f()}s(t)}}),[a]);var u=n((function(t,r,n){var a,i=Ne({},c);s(Ne(Ne({},c),{},Ie({},t,{id:t,predicate:r,permissions:c[t]?[].concat(Le(null===(a=c[t])||void 0===a?void 0:a.permissions),[n]):[n]}))),o.addPermission(e,t,r,n).catch((function(e){s(i)}))}),[c,s,e,o]),l=n((function(t,r,n){var a=Ne({},c);s(Object.fromEntries(Object.entries(c).map((function(e){var r=ze(e,2),a=r[0],o=r[1];return o.id===t&&(o.permissions=o.permissions.filter((function(e){return e!==n}))),[a,o]})).filter((function(e){var t=ze(e,2),r=(t[0],t[1]);return r.predicate===et||r.permissions.length>0})))),o.removePermission(e,t,r,n).catch((function(e){s(a)}))}),[c,s,e,o]);return{agents:c,addPermission:u,removePermission:l}},gt=D((function(){return{title:{paddingBottom:8},actions:{padding:15},addForm:{paddingTop:0},listForm:{paddingTop:0,paddingBottom:0,paddingRight:0,maxHeight:210}}})),bt=function(t){var r=t.open,n=t.onClose,a=t.resourceId,o=t.isContainer,i=gt(),s=c(),u=vt(a),l=u.agents,m=u.addPermission,d=u.removePermission;return e.createElement(X,{fullWidth:!0,open:r,onClose:n},e.createElement(Z,{className:i.title},s(o?"auth.dialog.container_permissions":"auth.dialog.resource_permissions")),e.createElement(ee,{className:i.addForm},e.createElement(lt,{agents:l,addPermission:m})),e.createElement(ee,{className:i.listForm},e.createElement(ht,{isContainer:o,agents:l,addPermission:m,removePermission:d})),e.createElement(te,{className:i.actions},e.createElement(p,{label:"ra.action.close",variant:"text",onClick:n})))},yt=function(r){var n=r.record,a=r.resource,o=ze(t(!1),2),i=o[0],c=o[1],s=!!a?a:n.id||n["@id"];return e.createElement(e.Fragment,null,e.createElement(p,{label:"auth.action.permissions",onClick:function(){return c(!0)}},e.createElement(V,null)),e.createElement(bt,{resourceId:s,isContainer:!!a,open:i,onClose:function(){return c(!1)}}))},wt=function(t){var r=t.basePath,n=t.className,a=t.data,o=t.hasList,i=t.hasShow,c=t.hasControl,s=Ue(t,["basePath","className","data","hasList","hasShow","hasControl"]);return e.createElement(z,Te({className:n},s),o&&e.createElement(h,{basePath:r,record:a}),i&&e.createElement(v,{basePath:r,record:a}),a&&c&&e.createElement(yt,{basePath:r,record:a}))},_t=function(t){var r=g(),n=d(r.id).permissions;return n&&n.some((function(e){return nt.includes(e["acl:mode"])}))?e.createElement(b,t):null},jt=D((function(){return{toolbar:{flex:1,display:"flex",justifyContent:"space-between"}}})),Et=function(t){var r=jt();return e.createElement(y,Te({},t,{className:r.toolbar}),e.createElement(w,null),e.createElement(_t,{undoable:!1}),"}")},Ot=function(){var e=_(),t=e.identity,n=e.loading,a=j(),o=E(),i=ve();return r((function(){n||(null==t?void 0:t.id)||(a("ra.auth.auth_check_error","error"),o("/login?redirect="+encodeURIComponent(i.pathname)))}),[n,t,o,a,i]),{identity:t,loading:n}},kt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",a=Ot(),o=a.identity,i=d(e),c=i.permissions,s=j(),u=E();return r((function(){(null==o?void 0:o.id)&&c&&!c.some((function(e){return ot[t].includes(e["acl:mode"])}))&&(s(it[t],"error"),u(n))}),[c,o,u,s]),c},xt=function(t){var r=kt(t.id,"edit");return e.createElement(O,Te({actions:e.createElement(wt,{hasControl:!!r&&r.some((function(e){return at.includes(e["acl:mode"])}))})},t,{permissions:r}),e.cloneElement(t.children,Ne({toolbar:e.createElement(Et,null)},t.children.props)))},Pt=function(t){var r=t.actions,n=t.resource,a=t.hasCreate,o=Ue(t,["actions","resource","hasCreate"]),i=d(n).permissions;return e.createElement(L,Te({},o,{resource:n,hasCreate:a&&!!i&&i.some((function(e){return tt.includes(e["acl:mode"])})),actions:r&&i&&i.some((function(e){return at.includes(e["acl:mode"])}))?e.cloneElement(r,{bulkActions:e.createElement(yt,null)}):r}))};Pt.defaultProps={actions:e.createElement(W,null)};var Ct=function(t){var r=t.basePath,n=t.className,a=t.data,o=t.hasList,i=t.hasEdit,c=t.hasControl,s=Ue(t,["basePath","className","data","hasList","hasEdit","hasControl"]);return e.createElement(z,Te({className:n},s),o&&e.createElement(h,{basePath:r,record:a}),i&&e.createElement(k,{basePath:r,record:a}),a&&c&&e.createElement(yt,{basePath:r,record:a}))},St=function(t){var r=d(t.id).permissions;return e.createElement(x,Te({actions:e.createElement(Ct,{hasControl:!!r&&r.some((function(e){return at.includes(e["acl:mode"])}))})},t,{permissions:r,hasEdit:t.hasEdit&&!!r&&r.some((function(e){return rt.includes(e["acl:mode"])}))}))},At=we((function(e){return{main:{display:"flex",flexDirection:"column",minHeight:"100vh",alignItems:"center",justifyContent:"flex-start",backgroundColor:e.palette.grey[300]},text:{maxWidth:300,textAlign:"center",padding:"4px 8px 8px"},card:{minWidth:300,marginTop:"6em"},lockIconAvatar:{margin:"1em",display:"flex",justifyContent:"center"},lockIcon:{backgroundColor:e.palette.grey[500]}}})),It=function(t){var n=t.theme,a=t.history,o=t.location,i=t.buttons,c=t.userResource,s=t.text,l=At(),m=j(),d=P(),p=u(),h=f();return r((function(){Ae(regeneratorRuntime.mark((function e(){var t,r,n,i,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=new URLSearchParams(o.search)).has("login")){e.next=14;break}if(!t.has("error")){e.next=6;break}"registration.not-allowed"===t.get("error")?m("auth.message.user_email_not_found","error"):m("auth.message.bad_request","error",{error:t.get("error")}),e.next=14;break;case 6:if(!t.has("token")){e.next=14;break}return r=t.get("token"),n=$e(r),i=n.webId,e.next=11,p.getOne("Person",{id:i});case 11:s=e.sent,u=s.data,h.checkUser(u)?(localStorage.setItem("token",r),t.has("new")&&"true"===t.get("new")?(m("auth.message.new_user_created","info"),a.push("/"+c+"/"+encodeURIComponent(i)+"/edit")):(m("auth.message.user_connected","info"),a.push("/"))):(m("auth.message.user_not_allowed_to_login","error"),a.replace("/login"));case 14:t.has("logout")&&(localStorage.removeItem("token"),m("auth.message.user_disconnected","info"),a.push("/"));case 15:case"end":return e.stop()}}),e)})))()}),[o.search]),e.createElement(ye,{theme:_e(n)},e.createElement("div",{className:l.main},e.createElement(re,{className:l.card},e.createElement("div",{className:l.lockIconAvatar},e.createElement(q,{className:l.lockIcon},e.createElement(je,null))),s&&e.createElement(ne,{variant:"body2",className:l.text},s),i&&i.map((function(t,r){return e.createElement(ae,{key:r},e.cloneElement(t,{fullWidth:!0,variant:"outlined",type:"submit",onClick:function(){return d({},"/login")}}))})))),e.createElement(C,null))};It.defaultProps={buttons:[e.createElement(oe,{startIcon:e.createElement(q,{src:"/lescommuns.jpg"})},"Les Communs")],userResource:"Person"};function Tt(){}function Rt(){}Rt.resetWarningCache=Tt;var Nt=Ge((function(e){e.exports=function(){function e(e,t,r,n,a,o){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==o){var i=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw i.name="Invariant Violation",i}}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:Rt,resetWarningCache:Tt};return r.PropTypes=r,r}()})),Ut=function(){var e=f();return n((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.signup(t)}),[e])},zt=D((function(e){return{form:{padding:"0 1em 1em 1em"},input:{marginTop:"1em"},button:{width:"100%"},icon:{marginRight:e.spacing(1)}}})),Lt=function(e){var t=e.meta,r=t.touched,n=t.error,o=e.input,i=Ue(e,["meta","input"]);return a(F,Te({error:!(!r||!n),helperText:r&&n},o,i,{fullWidth:!0}))},Wt=function(e){var t=e.redirectTo,r=e.delayBeforeRedirect,n=ze(S(!1),2),o=n[0],i=n[1],s=Ut(),u=c(),l=j(),m=zt(),d=ve(),f=new URLSearchParams(d.search);return a(Oe,{onSubmit:function(e){i(!0),s(e).then((function(e){r?setTimeout((function(){window.location.reload(),window.location.href=t||"/",i(!1)}),r):(window.location.reload(),window.location.href=t||"/",i(!1)),l("auth.message.new_user_created","info")})).catch((function(e){i(!1),l("string"==typeof e?e:void 0!==e&&e.message?e.message:"ra.auth.sign_in_error","warning",{_:"string"==typeof e?e:e&&e.message?e.message:void 0})}))},validate:function(e){var t={email:void 0,password:void 0};return e.email||(t.email=u("ra.validation.required")),e.password||(t.password=u("ra.validation.required")),t},initialValues:{name:f.get("name"),email:f.get("email")},render:function(e){var t=e.handleSubmit;return a("form",{onSubmit:t,noValidate:!0},a("div",{className:m.form},a("div",{className:m.input},a(ke,{autoFocus:!0,id:"name",name:"name",component:Lt,label:u("auth.input.name"),disabled:o})),a("div",{className:m.input},a(ke,{id:"username",name:"username",component:Lt,label:u("auth.input.username"),disabled:o})),a("div",{className:m.input},a(ke,{id:"email",name:"email",component:Lt,label:u("auth.input.email"),disabled:o||f.has("email")&&f.has("force-email")})),a("div",{className:m.input},a(ke,{id:"password",name:"password",component:Lt,label:u("ra.auth.password"),type:"password",disabled:o}))),a(ae,null,a(oe,{variant:"contained",type:"submit",color:"primary",disabled:o,className:m.button},o&&a(ie,{className:m.icon,size:18,thickness:2}),u("auth.action.signup"))))}})};Wt.propTypes={redirectTo:Nt.string};var Vt=D((function(e){return{main:{display:"flex",flexDirection:"column",minHeight:"100vh",height:"1px",alignItems:"center",justifyContent:"flex-start",backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundImage:"radial-gradient(circle at 50% 14em, #313264 0%, #00023b 60%, #00023b 100%)"},card:{minWidth:300,marginTop:"6em"},avatar:{margin:"1em",display:"flex",justifyContent:"center"},icon:{backgroundColor:e.palette.secondary[500]},switch:{margin:"1em",display:"flex",justifyContent:"center"}}})),Dt=function(t){var r=t.theme,n=(t.title,t.classes,t.className),a=Ue(t,["theme","title","classes","className"]),i=Vt(t),c=ve(),s=o((function(){return ce(r)}),[r]),u=new URLSearchParams(c.search),l=u.has("signup"),m=u.get("redirect"),d=_(),f=d.identity;return d.loading?null:(null==f?void 0:f.id)?e.createElement(ge,{to:m||"/"}):e.createElement(se,{theme:s},e.createElement("div",Te({className:Ee(i.main,n)},a),e.createElement(re,{className:i.card},e.createElement("div",{className:i.avatar},e.createElement(q,{className:i.icon},e.createElement(je,null))),l?e.createElement(Wt,{redirectTo:m,delayBeforeRedirect:3e3}):e.createElement(A,{redirectTo:m}),e.createElement("div",{className:i.switch},l?e.createElement(be,{to:"/login"},e.createElement(ne,{variant:"body2"},"Se connecter avec un compte")):e.createElement(be,{to:"/login?signup=true"},e.createElement(ne,{variant:"body2"},"Créer un nouveau compte")))),e.createElement(C,null)))};Dt.propTypes={children:Nt.node,classes:Nt.object,className:Nt.string,theme:Nt.object};var Ft=i((function(t,r){var n=I();return e.createElement(xe,{onClick:function(){return n()},ref:r},e.createElement(Pe,null),"   Se déconnecter")})),Mt=function(t){var r=t.name,n=t.create,a=Ue(t,["name","create"]),o=d(r).permissions;return e.createElement(T,Te({},a,{name:r,create:o&&o.some((function(e){return tt.includes(e["acl:mode"])}))?n:void 0}))},Bt=i((function(t,r){var n=t.onClick,a=t.webId;return e.createElement(R,{ref:r,to:"/Person/".concat(encodeURIComponent(a),"/show"),primaryText:"Voir mon profil",leftIcon:e.createElement(Ce,null),onClick:n})})),$t=i((function(t,r){var n=t.onClick,a=t.webId;return e.createElement(R,{ref:r,to:"/Person/".concat(encodeURIComponent(a),"/edit"),primaryText:"Editer mon profil",leftIcon:e.createElement(me,null),onClick:n})})),qt=i((function(t,r){var n=t.onClick;return e.createElement(R,{ref:r,to:"/login",primaryText:"Se connecter",onClick:n})})),Gt=i((function(t,r){var n=t.onClick;return e.createElement(R,{ref:r,to:"/login?signup=true",primaryText:"Créer un compte",onClick:n})})),Ht=function(t){var r=t.logout,n=Ue(t,["logout"]),a=_().identity;return e.createElement(N,n,a&&""!==a.id?[e.createElement(Bt,{webId:a.id,key:"view"}),e.createElement($t,{webId:a.id,key:"edit"}),e.cloneElement(r,{key:"logout"})]:[e.createElement(Gt,{key:"signup"}),e.createElement(qt,{key:"login"})])};var Jt=function(){this.__data__=[],this.size=0};var Yt=function(e,t){return e===t||e!=e&&t!=t};var Kt=function(e,t){for(var r=e.length;r--;)if(Yt(e[r][0],t))return r;return-1},Qt=Array.prototype.splice;var Xt=function(e){var t=this.__data__,r=Kt(t,e);return!(r<0)&&(r==t.length-1?t.pop():Qt.call(t,r,1),--this.size,!0)};var Zt=function(e){var t=this.__data__,r=Kt(t,e);return r<0?void 0:t[r][1]};var er=function(e){return Kt(this.__data__,e)>-1};var tr=function(e,t){var r=this.__data__,n=Kt(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function rr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}rr.prototype.clear=Jt,rr.prototype.delete=Xt,rr.prototype.get=Zt,rr.prototype.has=er,rr.prototype.set=tr;var nr=rr;var ar=function(){this.__data__=new nr,this.size=0};var or=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r};var ir=function(e){return this.__data__.get(e)};var cr=function(e){return this.__data__.has(e)},sr="object"==typeof qe&&qe&&qe.Object===Object&&qe,ur="object"==typeof self&&self&&self.Object===Object&&self,lr=sr||ur||Function("return this")(),mr=lr.Symbol,dr=Object.prototype,fr=dr.hasOwnProperty,pr=dr.toString,hr=mr?mr.toStringTag:void 0;var vr=function(e){var t=fr.call(e,hr),r=e[hr];try{e[hr]=void 0;var n=!0}catch(e){}var a=pr.call(e);return n&&(t?e[hr]=r:delete e[hr]),a},gr=Object.prototype.toString;var br=function(e){return gr.call(e)},yr=mr?mr.toStringTag:void 0;var wr=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":yr&&yr in Object(e)?vr(e):br(e)};var _r=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};var jr,Er=function(e){if(!_r(e))return!1;var t=wr(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},Or=lr["__core-js_shared__"],kr=(jr=/[^.]+$/.exec(Or&&Or.keys&&Or.keys.IE_PROTO||""))?"Symbol(src)_1."+jr:"";var xr=function(e){return!!kr&&kr in e},Pr=Function.prototype.toString;var Cr=function(e){if(null!=e){try{return Pr.call(e)}catch(e){}try{return e+""}catch(e){}}return""},Sr=/^\[object .+?Constructor\]$/,Ar=Function.prototype,Ir=Object.prototype,Tr=Ar.toString,Rr=Ir.hasOwnProperty,Nr=RegExp("^"+Tr.call(Rr).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Ur=function(e){return!(!_r(e)||xr(e))&&(Er(e)?Nr:Sr).test(Cr(e))};var zr=function(e,t){return null==e?void 0:e[t]};var Lr=function(e,t){var r=zr(e,t);return Ur(r)?r:void 0},Wr=Lr(lr,"Map"),Vr=Lr(Object,"create");var Dr=function(){this.__data__=Vr?Vr(null):{},this.size=0};var Fr=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Mr=Object.prototype.hasOwnProperty;var Br=function(e){var t=this.__data__;if(Vr){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return Mr.call(t,e)?t[e]:void 0},$r=Object.prototype.hasOwnProperty;var qr=function(e){var t=this.__data__;return Vr?void 0!==t[e]:$r.call(t,e)};var Gr=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Vr&&void 0===t?"__lodash_hash_undefined__":t,this};function Hr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Hr.prototype.clear=Dr,Hr.prototype.delete=Fr,Hr.prototype.get=Br,Hr.prototype.has=qr,Hr.prototype.set=Gr;var Jr=Hr;var Yr=function(){this.size=0,this.__data__={hash:new Jr,map:new(Wr||nr),string:new Jr}};var Kr=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var Qr=function(e,t){var r=e.__data__;return Kr(t)?r["string"==typeof t?"string":"hash"]:r.map};var Xr=function(e){var t=Qr(this,e).delete(e);return this.size-=t?1:0,t};var Zr=function(e){return Qr(this,e).get(e)};var en=function(e){return Qr(this,e).has(e)};var tn=function(e,t){var r=Qr(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function rn(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}rn.prototype.clear=Yr,rn.prototype.delete=Xr,rn.prototype.get=Zr,rn.prototype.has=en,rn.prototype.set=tn;var nn=rn;var an=function(e,t){var r=this.__data__;if(r instanceof nr){var n=r.__data__;if(!Wr||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new nn(n)}return r.set(e,t),this.size=r.size,this};function on(e){var t=this.__data__=new nr(e);this.size=t.size}on.prototype.clear=ar,on.prototype.delete=or,on.prototype.get=ir,on.prototype.has=cr,on.prototype.set=an;var cn=on;var sn=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this};var un=function(e){return this.__data__.has(e)};function ln(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new nn;++t<r;)this.add(e[t])}ln.prototype.add=ln.prototype.push=sn,ln.prototype.has=un;var mn=ln;var dn=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1};var fn=function(e,t){return e.has(t)};var pn=function(e,t,r,n,a,o){var i=1&r,c=e.length,s=t.length;if(c!=s&&!(i&&s>c))return!1;var u=o.get(e);if(u&&o.get(t))return u==t;var l=-1,m=!0,d=2&r?new mn:void 0;for(o.set(e,t),o.set(t,e);++l<c;){var f=e[l],p=t[l];if(n)var h=i?n(p,f,l,t,e,o):n(f,p,l,e,t,o);if(void 0!==h){if(h)continue;m=!1;break}if(d){if(!dn(t,(function(e,t){if(!fn(d,t)&&(f===e||a(f,e,r,n,o)))return d.push(t)}))){m=!1;break}}else if(f!==p&&!a(f,p,r,n,o)){m=!1;break}}return o.delete(e),o.delete(t),m},hn=lr.Uint8Array;var vn=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r};var gn=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r},bn=mr?mr.prototype:void 0,yn=bn?bn.valueOf:void 0;var wn=function(e,t,r,n,a,o,i){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new hn(e),new hn(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Yt(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var c=vn;case"[object Set]":var s=1&n;if(c||(c=gn),e.size!=t.size&&!s)return!1;var u=i.get(e);if(u)return u==t;n|=2,i.set(e,t);var l=pn(c(e),c(t),n,a,o,i);return i.delete(e),l;case"[object Symbol]":if(yn)return yn.call(e)==yn.call(t)}return!1};var _n=function(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e},jn=Array.isArray;var En=function(e,t,r){var n=t(e);return jn(e)?n:_n(n,r(e))};var On=function(e,t){for(var r=-1,n=null==e?0:e.length,a=0,o=[];++r<n;){var i=e[r];t(i,r,e)&&(o[a++]=i)}return o};var kn=function(){return[]},xn=Object.prototype.propertyIsEnumerable,Pn=Object.getOwnPropertySymbols,Cn=Pn?function(e){return null==e?[]:(e=Object(e),On(Pn(e),(function(t){return xn.call(e,t)})))}:kn;var Sn=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n};var An=function(e){return null!=e&&"object"==typeof e};var In=function(e){return An(e)&&"[object Arguments]"==wr(e)},Tn=Object.prototype,Rn=Tn.hasOwnProperty,Nn=Tn.propertyIsEnumerable,Un=In(function(){return arguments}())?In:function(e){return An(e)&&Rn.call(e,"callee")&&!Nn.call(e,"callee")};var zn=function(){return!1},Ln=Ge((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,a=n&&n.exports===r?lr.Buffer:void 0,o=(a?a.isBuffer:void 0)||zn;e.exports=o})),Wn=/^(?:0|[1-9]\d*)$/;var Vn=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&Wn.test(e))&&e>-1&&e%1==0&&e<t};var Dn=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},Fn={};Fn["[object Float32Array]"]=Fn["[object Float64Array]"]=Fn["[object Int8Array]"]=Fn["[object Int16Array]"]=Fn["[object Int32Array]"]=Fn["[object Uint8Array]"]=Fn["[object Uint8ClampedArray]"]=Fn["[object Uint16Array]"]=Fn["[object Uint32Array]"]=!0,Fn["[object Arguments]"]=Fn["[object Array]"]=Fn["[object ArrayBuffer]"]=Fn["[object Boolean]"]=Fn["[object DataView]"]=Fn["[object Date]"]=Fn["[object Error]"]=Fn["[object Function]"]=Fn["[object Map]"]=Fn["[object Number]"]=Fn["[object Object]"]=Fn["[object RegExp]"]=Fn["[object Set]"]=Fn["[object String]"]=Fn["[object WeakMap]"]=!1;var Mn=function(e){return An(e)&&Dn(e.length)&&!!Fn[wr(e)]};var Bn=function(e){return function(t){return e(t)}},$n=Ge((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,a=n&&n.exports===r&&sr.process,o=function(){try{var e=n&&n.require&&n.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=o})),qn=$n&&$n.isTypedArray,Gn=qn?Bn(qn):Mn,Hn=Object.prototype.hasOwnProperty;var Jn=function(e,t){var r=jn(e),n=!r&&Un(e),a=!r&&!n&&Ln(e),o=!r&&!n&&!a&&Gn(e),i=r||n||a||o,c=i?Sn(e.length,String):[],s=c.length;for(var u in e)!t&&!Hn.call(e,u)||i&&("length"==u||a&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Vn(u,s))||c.push(u);return c},Yn=Object.prototype;var Kn=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Yn)};var Qn=function(e,t){return function(r){return e(t(r))}}(Object.keys,Object),Xn=Object.prototype.hasOwnProperty;var Zn=function(e){if(!Kn(e))return Qn(e);var t=[];for(var r in Object(e))Xn.call(e,r)&&"constructor"!=r&&t.push(r);return t};var ea=function(e){return null!=e&&Dn(e.length)&&!Er(e)};var ta=function(e){return ea(e)?Jn(e):Zn(e)};var ra=function(e){return En(e,ta,Cn)},na=Object.prototype.hasOwnProperty;var aa=function(e,t,r,n,a,o){var i=1&r,c=ra(e),s=c.length;if(s!=ra(t).length&&!i)return!1;for(var u=s;u--;){var l=c[u];if(!(i?l in t:na.call(t,l)))return!1}var m=o.get(e);if(m&&o.get(t))return m==t;var d=!0;o.set(e,t),o.set(t,e);for(var f=i;++u<s;){var p=e[l=c[u]],h=t[l];if(n)var v=i?n(h,p,l,t,e,o):n(p,h,l,e,t,o);if(!(void 0===v?p===h||a(p,h,r,n,o):v)){d=!1;break}f||(f="constructor"==l)}if(d&&!f){var g=e.constructor,b=t.constructor;g==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof g&&g instanceof g&&"function"==typeof b&&b instanceof b||(d=!1)}return o.delete(e),o.delete(t),d},oa=Lr(lr,"DataView"),ia=Lr(lr,"Promise"),ca=Lr(lr,"Set"),sa=Lr(lr,"WeakMap"),ua=Cr(oa),la=Cr(Wr),ma=Cr(ia),da=Cr(ca),fa=Cr(sa),pa=wr;(oa&&"[object DataView]"!=pa(new oa(new ArrayBuffer(1)))||Wr&&"[object Map]"!=pa(new Wr)||ia&&"[object Promise]"!=pa(ia.resolve())||ca&&"[object Set]"!=pa(new ca)||sa&&"[object WeakMap]"!=pa(new sa))&&(pa=function(e){var t=wr(e),r="[object Object]"==t?e.constructor:void 0,n=r?Cr(r):"";if(n)switch(n){case ua:return"[object DataView]";case la:return"[object Map]";case ma:return"[object Promise]";case da:return"[object Set]";case fa:return"[object WeakMap]"}return t});var ha=pa,va=Object.prototype.hasOwnProperty;var ga=function(e,t,r,n,a,o){var i=jn(e),c=jn(t),s=i?"[object Array]":ha(e),u=c?"[object Array]":ha(t),l="[object Object]"==(s="[object Arguments]"==s?"[object Object]":s),m="[object Object]"==(u="[object Arguments]"==u?"[object Object]":u),d=s==u;if(d&&Ln(e)){if(!Ln(t))return!1;i=!0,l=!1}if(d&&!l)return o||(o=new cn),i||Gn(e)?pn(e,t,r,n,a,o):wn(e,t,s,r,n,a,o);if(!(1&r)){var f=l&&va.call(e,"__wrapped__"),p=m&&va.call(t,"__wrapped__");if(f||p){var h=f?e.value():e,v=p?t.value():t;return o||(o=new cn),a(h,v,r,n,o)}}return!!d&&(o||(o=new cn),aa(e,t,r,n,a,o))};var ba=function e(t,r,n,a,o){return t===r||(null==t||null==r||!An(t)&&!An(r)?t!=t&&r!=r:ga(t,r,n,a,e,o))};var ya=function(e,t){return ba(e,t)},wa={},_a={"{}":void 0},ja=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wa,t=JSON.stringify(e),a=S({permissions:_a[t]}),o=ze(a,2),i=o[0],c=o[1],s=U(),u=n((function(){return s(e).then((function(e){ya(e,i.permissions)||(_a[t]=e,c({permissions:e}))})).catch((function(e){c({error:e})}))}),[t,e,s]);return r((function(){u()}),[t]),Ne(Ne({},i),{},{refetch:u})},Ea={auth:{dialog:{container_permissions:"Permissions sur le container",resource_permissions:"Permissions sur la resource"},action:{permissions:"Permissions",signup:"S'inscrire"},right:{resource:{read:"Lire",append:"Enrichir",write:"Modifier",control:"Administrer"},container:{read:"Lister",append:"Ajouter",write:"Ajouter",control:"Administrer"}},agent:{anonymous:"Tous les utilisateurs",authenticated:"Utilisateurs connectés"},input:{agent_select:"Ajouter un utilisateur...",name:"Prénom",username:"Nom utilisateur",email:"Adresse e-mail"},message:{resource_show_forbidden:"Vous n'avez pas la permission de voir cette ressource",resource_edit_forbidden:"Vous n'avez pas la permission d'éditer cette ressource",resource_delete_forbidden:"Vous n'avez pas la permission d'effacer cette ressource",resource_control_forbidden:"Vous n'avez pas la permission d'administrer cette ressource",container_create_forbidden:"Vous n'avez pas la permission de créer des ressources",container_list_forbidden:"Vous n'avez pas la permission de voir ces ressources",user_not_allowed_to_login:"Vous n'avez pas le droit de vous connecter avec ce compte",user_email_not_found:"Aucun compte trouvé avec cette adresse mail",user_email_exist:"Un compte existe déjà avec cette adresse mail",new_user_created:"Votre compte a été créé avec succès",user_connected:"Vous êtes maintenant connecté",user_disconnected:"Vous êtes maintenant déconnecté",bad_request:"Requête erronée (Message d'erreur renvoyé par le serveur: %{error})"}}};export{_t as DeleteButtonWithPermissions,wt as EditActions,Et as EditToolbarWithPermissions,xt as EditWithPermissions,Pt as ListWithPermissions,Dt as LocalLoginPage,It as LoginPage,Ft as LogoutButton,yt as PermissionsButton,Mt as ResourceWithPermissions,Ct as ShowActions,St as ShowWithPermissions,It as SsoLoginPage,Ht as UserMenu,Ze as authProvider,Ea as frenchMessages,vt as useAgents,Ot as useCheckAuthenticated,kt as useCheckPermissions,ja as usePermissionsWithRefetch,Ut as useSignup};
//# sourceMappingURL=index.es.js.map
