import*as e from"react";import t,{useState as r,useEffect as n,useCallback as a,useMemo as o,forwardRef as i}from"react";import{useTranslate as c,useGetList as s,useDataProvider as u,Loading as l,Error as m,usePermissionsOptimized as f,useAuthProvider as d,Button as p,ListButton as h,ShowButton as v,useRecordContext as g,DeleteButton as b,Toolbar as y,SaveButton as w,useGetIdentity as _,useNotify as E,useRedirect as j,Edit as k,EditButton as x,Show as O,useLogin as P,Notification as C,useSafeSetState as S,LoginForm as A,useLogout as I,Resource as T,UserMenu as R,MenuItemLink as N,useGetPermissions as U}from"react-admin";import{TopToolbar as z,List as L,ListActions as W}from"@semapps/archipelago-layout";import V from"@material-ui/icons/Share";import{useCreateContainer as D}from"@semapps/semantic-data-provider";import{makeStyles as F,TextField as B,List as M,ListItem as $,ListItemAvatar as q,Avatar as G,ListItemText as H,ListItemSecondaryAction as J,IconButton as Y,Menu as K,MenuItem as Q,ListItemIcon as X,Dialog as Z,DialogTitle as ee,DialogContent as te,DialogActions as re,Card as ne,Typography as ae,CardActions as oe,Button as ie,CircularProgress as ce,createTheme as se,ThemeProvider as ue}from"@material-ui/core";import le from"@material-ui/lab/Autocomplete";import me from"@material-ui/icons/Person";import fe from"@material-ui/icons/Edit";import de from"@material-ui/icons/Check";import pe from"@material-ui/icons/Public";import he from"@material-ui/icons/VpnLock";import ve from"@material-ui/icons/Group";import{useLocation as ge,Redirect as be,Link as ye}from"react-router-dom";import{ThemeProvider as we}from"@material-ui/styles";import{makeStyles as _e,createTheme as Ee}from"@material-ui/core/styles";import je from"@material-ui/icons/Lock";import{Form as ke,Field as xe}from"react-final-form";import Oe from"@material-ui/core/MenuItem";import Pe from"@material-ui/icons/PowerSettingsNew";import Ce from"@material-ui/icons/AccountCircle";function Se(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ae(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(r),!0).forEach((function(t){Re(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Se(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ie(e,t,r,n,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void r(e)}c.done?t(s):Promise.resolve(s).then(n,a)}function Te(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Ie(o,n,a,i,c,"next",e)}function c(e){Ie(o,n,a,i,c,"throw",e)}i(void 0)}))}}function Re(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ne(){return(Ne=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Ue(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ze(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,a,o=[],i=!0,c=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){c=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(c)throw a}}return o}(e,t)||We(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Le(e){return function(e){if(Array.isArray(e))return Ve(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||We(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function We(e,t){if(e){if("string"==typeof e)return Ve(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ve(e,t):void 0}}function Ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function De(e){this.message=e}De.prototype=new Error,De.prototype.name="InvalidCharacterError";var Fe="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new De("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,n,a=0,o=0,i="";n=t.charAt(o++);~n&&(r=a%4?64*r+n:n,a++%4)?i+=String.fromCharCode(255&r>>(-2*a&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return i};function Be(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(Fe(e).replace(/(.)/g,(function(e,t){var r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r})))}(t)}catch(e){return Fe(t)}}function Me(e){this.message=e}function $e(e,t){if("string"!=typeof e)throw new Me("Invalid token specified");var r=!0===(t=t||{}).header?0:1;try{return JSON.parse(Be(e.split(".")[r]))}catch(e){throw new Me("Invalid token specified: "+e.message)}}Me.prototype=new Error,Me.prototype.name="InvalidTokenError";var qe="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Ge(e,t){return e(t={exports:{}},t.exports),t.exports}var He,Je,Ye=Ge((function(e){var t,r;t=qe,r=function(){function e(e){var t=[];if(0===e.length)return"";if("string"!=typeof e[0])throw new TypeError("Url must be a string. Received "+e[0]);if(e[0].match(/^[^/:]+:\/*$/)&&e.length>1){var r=e.shift();e[0]=r+e[0]}e[0].match(/^file:\/\/\//)?e[0]=e[0].replace(/^([^/:]+):\/*/,"$1:///"):e[0]=e[0].replace(/^([^/:]+):\/*/,"$1://");for(var n=0;n<e.length;n++){var a=e[n];if("string"!=typeof a)throw new TypeError("Url must be a string. Received "+a);""!==a&&(n>0&&(a=a.replace(/^[\/]+/,"")),a=n<e.length-1?a.replace(/[\/]+$/,""):a.replace(/[\/]+$/,"/"),t.push(a))}var o=t.join("/"),i=(o=o.replace(/\/(\?|&|#[^!])/g,"$1")).split("?");return o=i.shift()+(i.length>0?"?":"")+i.join("&")}return function(){return e("object"==typeof arguments[0]?arguments[0]:[].slice.call(arguments))}},e.exports?e.exports=r():t.urljoin=r()})),Ke=function(e){return e?Array.isArray(e)?e:[e]:void 0},Qe=function(e){var t=new URL(e);return Ye(t.origin,"_acl",t.pathname)},Xe=function(e){return{"@base":e,acl:"http://www.w3.org/ns/auth/acl#",foaf:"http://xmlns.com/foaf/0.1/","acl:agent":{"@type":"@id"},"acl:agentGroup":{"@type":"@id"},"acl:agentClass":{"@type":"@id"},"acl:mode":{"@type":"@id"},"acl:accessTo":{"@type":"@id"}}},Ze=["username","email","password","domain"],et=function(e){var t,r,n,a,o,i,c,s,u=e.middlewareUri,l=e.allowAnonymous,m=void 0===l||l,f=e.localAccounts,d=void 0!==f&&f,p=e.checkUser,h=e.httpClient,v=e.checkPermissions;return{login:(s=Te(regeneratorRuntime.mark((function e(t){var r,n,a,o,i,c,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=new URL(window.location.href),n=u||t.domain&&"https://".concat(t.domain,"/")){e.next=4;break}throw new Error("You must specify a middlewareUri in the authProvider config, or specify a domain when calling the login method");case 4:if(!d){e.next=21;break}return a=t.username,o=t.password,e.prev=6,e.next=9,h("".concat(n,"auth/login"),{method:"POST",body:JSON.stringify({username:a.trim(),password:o.trim()}),headers:new Headers({"Content-Type":"application/json"})});case 9:i=e.sent,c=i.json,s=c.token,localStorage.setItem("token",s),window.location.reload(),e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(6),new Error("ra.auth.sign_in_error");case 19:e.next=22;break;case 21:window.location.href="".concat(n,"auth?redirectUrl=")+encodeURIComponent(r.origin+"/login?login=true");case 22:case"end":return e.stop()}}),e,null,[[6,16]])}))),function(e){return s.apply(this,arguments)}),signup:(c=Te(regeneratorRuntime.mark((function e(t){var r,n,a,o,i,c,s,l,m,f,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u||t.domain&&"https://".concat(t.domain,"/")){e.next=3;break}throw new Error("You must specify a middlewareUri in the authProvider config, or specify a domain when calling the signup method");case 3:if(!d){e.next=33;break}return n=t.username,a=t.email,o=t.password,i=t.domain,c=Ue(t,Ze),e.prev=5,e.next=8,h("".concat(r||"https://".concat(i),"auth/signup"),{method:"POST",body:JSON.stringify(Ae({username:n.trim(),email:a.trim(),password:o.trim()},c)),headers:new Headers({"Content-Type":"application/json"})});case 8:return s=e.sent,l=s.json,m=l.token,localStorage.setItem("token",m),f=$e(m),p=f.webId,e.abrupt("return",p);case 16:if(e.prev=16,e.t0=e.catch(5),"email.already.exists"!==e.t0.message){e.next=22;break}throw new Error("auth.message.user_email_exist");case 22:if("username.already.exists"!==e.t0.message){e.next=26;break}throw new Error("auth.message.username_exist");case 26:if("username.invalid"!==e.t0.message){e.next=30;break}throw new Error("auth.message.username_invalid");case 30:throw new Error(e.t0.message||"ra.auth.sign_in_error");case 31:e.next=34;break;case 33:window.location.href="".concat(r,"auth?redirectUrl=")+encodeURIComponent(url.origin+"/login?login=true");case 34:case"end":return e.stop()}}),e,null,[[5,16]])}))),function(e){return c.apply(this,arguments)}),logout:(i=Te(regeneratorRuntime.mark((function e(){var t,r,n,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u?t=u:(r=localStorage.getItem("token"))&&(n=$e(r),a=n.webId,t=new URL(a).origin+"/"),localStorage.removeItem("token"),d?(window.location.reload(),window.location.href="/"):t&&(o=new URL(window.location.href),window.location.href=m?"".concat(t,"auth/logout?redirectUrl=")+encodeURIComponent(o.origin+"/login?logout=true"):"".concat(t,"auth/logout?redirectUrl=")+encodeURIComponent(o.origin+"/login")),e.abrupt("return","/");case 4:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)}),checkAuth:(o=Te(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(localStorage.getItem("token")||m){e.next=3;break}throw new Error;case 3:case"end":return e.stop()}}),e)}))),function(){return o.apply(this,arguments)}),checkUser:function(e){return!p||p(e)},checkError:function(e){return Promise.resolve()},getPermissions:(a=Te(regeneratorRuntime.mark((function e(t){var r,n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v){e.next=2;break}return e.abrupt("return",!0);case 2:if(t&&t.startsWith("http")){e.next=4;break}throw new Error("The first parameter passed to getPermissions must be an URL");case 4:return r=Qe(t),e.next=7,h(r);case 7:return n=e.sent,a=n.json,e.abrupt("return",a["@graph"]);case 10:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),addPermission:(n=Te(regeneratorRuntime.mark((function e(t,r,n,a){var o,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Qe(t),t&&t.startsWith("http")){e.next=3;break}throw new Error("The first parameter passed to addPermission must be an URL");case 3:return Re(o={"@id":"#"+a.replace("acl:",""),"@type":"acl:Authorization"},n,r),Re(o,"acl:accessTo",resourceUri),Re(o,"acl:mode",a),c=o,e.next=6,h(i,{method:"PATCH",body:JSON.stringify({"@context":Xe(i),"@graph":[c]})});case 6:case"end":return e.stop()}}),e)}))),function(e,t,r,a){return n.apply(this,arguments)}),removePermission:(r=Te(regeneratorRuntime.mark((function e(t,r,n,a){var o,i,c,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.startsWith("http")){e.next=2;break}throw new Error("The first parameter passed to removePermission must be an URL");case 2:return o=Qe(t),e.next=5,h(o);case 5:return i=e.sent,c=i.json,s=c["@graph"].filter((function(e){return!e["@id"].includes("#Default")})).map((function(e){var t=Ke(e["acl:mode"]),o=Ke(e[n]);return a&&t.includes(a)&&o&&o.includes(r)&&(o=o.filter((function(e){return e!==r}))),Ae(Ae({},e),{},Re({},n,o))})),e.next=10,h(o,{method:"PUT",body:JSON.stringify({"@context":Xe(o),"@graph":s})});case 10:case"end":return e.stop()}}),e)}))),function(e,t,n,a){return r.apply(this,arguments)}),getIdentity:(t=Te(regeneratorRuntime.mark((function e(){var t,r,n,a,o,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=localStorage.getItem("token"))){e.next=17;break}return r=$e(t),n=r.webId,e.next=5,h(n);case 5:if(a=e.sent,!(o=a.json).url){e.next=13;break}return e.next=10,h(o.url);case 10:e.t0=e.sent,e.next=14;break;case 13:e.t0={};case 14:return i=e.t0,c=i.json,e.abrupt("return",{id:n,fullName:(null==c?void 0:c["vcard:given-name"])||(null==c?void 0:c["pair:label"])||o["foaf:name"],profileData:c,webIdData:o});case 17:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}},tt="acl:agentClass",rt=["acl:Append","acl:Write","acl:Control"],nt=["acl:Append","acl:Write","acl:Control"],at=["acl:Write","acl:Control"],ot=["acl:Control"],it={show:["acl:Read","acl:Append","acl:Write","acl:Control"],list:["acl:Read","acl:Append","acl:Write","acl:Control"],create:rt,edit:nt,delete:at,control:ot},ct={show:"auth.message.resource_show_forbidden",edit:"auth.message.resource_edit_forbidden",delete:"auth.message.resource_delete_forbidden",control:"auth.message.resource_control_forbidden",list:"auth.message.container_list_forbidden",create:"auth.message.container_create_forbidden"},st=(Re(He={},"acl:Read","auth.right.resource.read"),Re(He,"acl:Append","auth.right.resource.append"),Re(He,"acl:Write","auth.right.resource.write"),Re(He,"acl:Control","auth.right.resource.control"),He),ut=(Re(Je={},"acl:Read","auth.right.container.read"),Re(Je,"acl:Write","auth.right.container.write"),Re(Je,"acl:Control","auth.right.container.control"),Je),lt=F((function(){return{list:{padding:0,width:"100%"},option:{padding:0}}})),mt=function(e){var a=e.agents,o=e.addPermission,i=lt(),u=c(),l=ze(r(null),2),m=l[0],f=l[1],d=ze(r(""),2),p=d[0],h=d[1],v=ze(r([]),2),g=v[0],b=v[1],y=s("Person",{page:1,perPage:100},{field:"pair:label",order:"ASC"},{q:p},{enabled:p.length>0}),w=y.ids,_=y.data;return n((function(){b(w.length>0?Object.values(_):[])}),[w,_]),t.createElement(le,{classes:{option:i.option},getOptionLabel:function(e){return e["pair:label"]},filterOptions:function(e){return e.filter((function(e){return!Object.keys(a).includes(e.id)}))},options:g,noOptionsText:u("ra.navigation.no_results"),autoComplete:!0,blurOnSelect:!0,clearOnBlur:!0,disableClearable:!0,value:m,onChange:function(e,t){o(t.id||t["@id"],"acl:agent","acl:Read"),f(null),h(""),b([])},onInputChange:function(e,t){h(t)},renderInput:function(e){return t.createElement(B,Ne({},e,{label:u("auth.input.agent_select"),variant:"filled",margin:"dense",fullWidth:!0}))},renderOption:function(e){return t.createElement(M,{dense:!0,className:i.list},t.createElement($,{button:!0},t.createElement(q,null,t.createElement(G,{src:e.image},t.createElement(me,null))),t.createElement(H,{primary:e["pair:label"]})))}})},ft=function(e){var r=e.agent;switch(r.predicate){case tt:return"foaf:Agent"===r.id?t.createElement(pe,null):t.createElement(he,null);case"acl:agent":return t.createElement(me,null);case"acl:agentGroup":return t.createElement(ve,null);default:throw new Error("Unknown agent predicate: "+r.predicate)}},dt=F((function(){return{listItem:{paddingLeft:4,paddingRight:36},primaryText:{width:"30%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},secondaryText:{textAlign:"center",width:"60%",fontStyle:"italic",color:"grey"}}})),pt=function(e){var a=e.isContainer,o=e.agent,i=e.addPermission,s=e.removePermission,f=dt(),d=c(),p=u(),h=ze(t.useState(null),2),v=h[0],g=h[1],b=ze(r(),2),y=b[0],w=b[1],_=ze(r(!0),2),E=_[0],j=_[1],k=ze(r(),2),x=k[0],O=k[1];if(n((function(){"acl:agent"===o.predicate?p.getOne("Person",{id:o.id}).then((function(e){var t=e.data;w(t),j(!1)})).catch((function(e){O(e),j(!1)})):j(!1)}),[o.id,o.predicate]),"acl:agentGroup"===o.predicate)return null;var P=function(){return g(null)},C=a?ut:st;return E?t.createElement(l,null):x?t.createElement(m,null):t.createElement($,{className:f.listItem},t.createElement(q,null,t.createElement(G,{src:null==y?void 0:y.image},t.createElement(ft,{agent:o}))),t.createElement(H,{className:f.primaryText,primary:y?y["pair:label"]:d("foaf:Agent"===o.id?"auth.agent.anonymous":"auth.agent.authenticated")}),t.createElement(H,{className:f.secondaryText,primary:o.permissions&&o.permissions.map((function(e){return d(C[e])})).join(", ")}),t.createElement(J,null,t.createElement(Y,{onClick:function(e){return g(e.currentTarget)}},t.createElement(fe,null)),t.createElement(K,{anchorEl:v,keepMounted:!0,open:Boolean(v),onClose:P},Object.entries(C).map((function(e){var r=ze(e,2),n=r[0],a=r[1],c=o.permissions&&o.permissions.includes(n);return t.createElement(Q,{key:n,onClick:function(){c?s(o.id,o.predicate,n):i(o.id,o.predicate,n),P()}},t.createElement(X,null,c?t.createElement(de,null):null),t.createElement(H,{primary:d(a)}))})))))},ht=F((function(e){return{list:{width:"100%",maxWidth:"100%",backgroundColor:e.palette.background.paper}}})),vt=function(e){var r=e.isContainer,n=e.agents,a=e.addPermission,o=e.removePermission,i=ht();return t.createElement(M,{dense:!0,className:i.list},Object.entries(n).map((function(e){var n=ze(e,2),i=n[0],c=n[1];return t.createElement(pt,{key:i,isContainer:r,agent:c,addPermission:a,removePermission:o})})))},gt=function(e){var t=f(e).permissions,o=d(),i=ze(r({}),2),c=i[0],s=i[1];n((function(){var e,r=(Re(e={},"foaf:Agent",{id:"foaf:Agent",predicate:tt,permissions:[]}),Re(e,"acl:AuthenticatedAgent",{id:"acl:AuthenticatedAgent",predicate:tt,permissions:[]}),e),n=function(e,t,n){r[e]?r[e].permissions.push(n):r[e]={id:e,predicate:t,permissions:[n]}};if(t){var a,o=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=We(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw o}}}}(t);try{var i=function(){var e=a.value;e[tt]&&Ke(e[tt]).forEach((function(t){return n(t,tt,e["acl:mode"])})),e["acl:agent"]&&Ke(e["acl:agent"]).forEach((function(t){return n(t,"acl:agent",e["acl:mode"])})),e["acl:agentGroup"]&&Ke(e["acl:agentGroup"]).forEach((function(t){return n(t,"acl:agentGroup",e["acl:mode"])}))};for(o.s();!(a=o.n()).done;)i()}catch(e){o.e(e)}finally{o.f()}s(r)}}),[t]);var u=a((function(t,r,n){var a,i=Ae({},c);s(Ae(Ae({},c),{},Re({},t,{id:t,predicate:r,permissions:c[t]?[].concat(Le(null===(a=c[t])||void 0===a?void 0:a.permissions),[n]):[n]}))),o.addPermission(e,t,r,n).catch((function(e){s(i)}))}),[c,s,e,o]),l=a((function(t,r,n){var a=Ae({},c);s(Object.fromEntries(Object.entries(c).map((function(e){var r=ze(e,2),a=r[0],o=r[1];return o.id===t&&(o.permissions=o.permissions.filter((function(e){return e!==n}))),[a,o]})).filter((function(e){var t=ze(e,2);t[0];var r=t[1];return r.predicate===tt||r.permissions.length>0})))),o.removePermission(e,t,r,n).catch((function(e){s(a)}))}),[c,s,e,o]);return{agents:c,addPermission:u,removePermission:l}},bt=F((function(){return{title:{paddingBottom:8},actions:{padding:15},addForm:{paddingTop:0},listForm:{paddingTop:0,paddingBottom:0,paddingRight:0,maxHeight:210}}})),yt=function(e){var r=e.open,n=e.onClose,a=e.uri,o=e.isContainer,i=bt(),s=c(),u=gt(a),l=u.agents,m=u.addPermission,f=u.removePermission;return t.createElement(Z,{fullWidth:!0,open:r,onClose:n},t.createElement(ee,{className:i.title},s(o?"auth.dialog.container_permissions":"auth.dialog.resource_permissions")),t.createElement(te,{className:i.addForm},t.createElement(mt,{agents:l,addPermission:m})),t.createElement(te,{className:i.listForm},t.createElement(vt,{isContainer:o,agents:l,addPermission:m,removePermission:f})),t.createElement(re,{className:i.actions},t.createElement(p,{label:"ra.action.close",variant:"text",onClick:n})))},wt=function(e){var n=e.record,a=e.resource,o=ze(r(!1),2),i=o[0],c=o[1],s=D(a),u=!!a,l=u?s:n.id||n["@id"];return t.createElement(t.Fragment,null,t.createElement(p,{label:"auth.action.permissions",onClick:function(){return c(!0)}},t.createElement(V,null)),t.createElement(yt,{uri:l,isContainer:!!u,open:i,onClose:function(){return c(!1)}}))},_t=["basePath","className","data","hasList","hasShow","hasControl"],Et=function(e){var r=e.basePath,n=e.className,a=e.data,o=e.hasList,i=e.hasShow,c=e.hasControl,s=Ue(e,_t);return t.createElement(z,Ne({className:n},s),o&&t.createElement(h,{basePath:r,record:a}),i&&t.createElement(v,{basePath:r,record:a}),a&&c&&t.createElement(wt,{basePath:r,record:a}))},jt=function(e){var r=g(),n=f(r.id).permissions;return n&&n.some((function(e){return at.includes(e["acl:mode"])}))?t.createElement(b,e):null},kt=F((function(){return{toolbar:{flex:1,display:"flex",justifyContent:"space-between"}}})),xt=function(e){var r=kt();return t.createElement(y,Ne({},e,{className:r.toolbar}),t.createElement(w,null),t.createElement(jt,{undoable:!1}),"}")},Ot=function(){var e=_(),t=e.identity,r=e.loading,a=E(),o=j(),i=ge();return n((function(){r||null!=t&&t.id||(a("ra.auth.auth_check_error","error"),o("/login?redirect="+encodeURIComponent(i.pathname+i.search)))}),[r,t,o,a,i]),{identity:t,loading:r}},Pt=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",a=Ot(),o=a.identity,i=f(e),c=i.permissions,s=E(),u=j();return n((function(){null!=o&&o.id&&c&&!c.some((function(e){return it[t].includes(e["acl:mode"])}))&&(s(ct[t],"error"),u(r))}),[c,o,u,s]),c},Ct=function(e){var r=Pt(e.id,"edit");return t.createElement(k,Ne({actions:t.createElement(Et,{hasControl:!!r&&r.some((function(e){return ot.includes(e["acl:mode"])}))})},e,{permissions:r}),t.cloneElement(e.children,Ae({toolbar:t.createElement(xt,null)},e.children.props)))},St=["actions","resource","hasCreate"],At=function(e){var r=e.actions,n=e.resource,a=e.hasCreate,o=Ue(e,St),i=D(n),c=f(i).permissions;return t.createElement(L,Ne({},o,{resource:n,hasCreate:a&&!!c&&c.some((function(e){return rt.includes(e["acl:mode"])})),actions:r&&c&&c.some((function(e){return ot.includes(e["acl:mode"])}))?t.cloneElement(r,{bulkActions:t.createElement(wt,null)}):r}))};At.defaultProps={actions:t.createElement(W,null)};var It=["basePath","className","data","hasList","hasEdit","hasControl"],Tt=function(e){var r=e.basePath,n=e.className,a=e.data,o=e.hasList,i=e.hasEdit,c=e.hasControl,s=Ue(e,It);return t.createElement(z,Ne({className:n},s),o&&t.createElement(h,{basePath:r,record:a}),i&&t.createElement(x,{basePath:r,record:a}),a&&c&&t.createElement(wt,{basePath:r,record:a}))},Rt=function(e){var r=f(e.id).permissions;return t.createElement(O,Ne({actions:t.createElement(Tt,{hasControl:!!r&&r.some((function(e){return ot.includes(e["acl:mode"])}))})},e,{permissions:r,hasEdit:e.hasEdit&&!!r&&r.some((function(e){return nt.includes(e["acl:mode"])}))}))},Nt=_e((function(e){return{main:{display:"flex",flexDirection:"column",minHeight:"100vh",alignItems:"center",justifyContent:"flex-start",backgroundColor:e.palette.grey[300]},text:{maxWidth:300,textAlign:"center",padding:"4px 8px 8px"},card:{minWidth:300,marginTop:"6em"},lockIconAvatar:{margin:"1em",display:"flex",justifyContent:"center"},lockIcon:{backgroundColor:e.palette.grey[500]}}})),Ut=function(e){var r=e.theme,a=e.history,o=e.location,i=e.buttons,c=e.userResource,s=e.text,l=Nt(),m=E(),f=P(),p=u(),h=d();return n((function(){Te(regeneratorRuntime.mark((function e(){var t,r,n,i,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=new URLSearchParams(o.search)).has("login")){e.next=14;break}if(!t.has("error")){e.next=6;break}"registration.not-allowed"===t.get("error")?m("auth.message.user_email_not_found","error"):m("auth.message.bad_request","error",{error:t.get("error")}),e.next=14;break;case 6:if(!t.has("token")){e.next=14;break}return r=t.get("token"),n=$e(r),i=n.webId,e.next=11,p.getOne("Person",{id:i});case 11:s=e.sent,u=s.data,h.checkUser(u)?(localStorage.setItem("token",r),t.has("new")&&"true"===t.get("new")?(m("auth.message.new_user_created","info"),a.push("/"+c+"/"+encodeURIComponent(i)+"/edit")):(m("auth.message.user_connected","info"),a.push("/"))):(m("auth.message.user_not_allowed_to_login","error"),a.replace("/login"));case 14:t.has("logout")&&(localStorage.removeItem("token"),m("auth.message.user_disconnected","info"),a.push("/"));case 15:case"end":return e.stop()}}),e)})))()}),[o.search]),t.createElement(we,{theme:Ee(r)},t.createElement("div",{className:l.main},t.createElement(ne,{className:l.card},t.createElement("div",{className:l.lockIconAvatar},t.createElement(G,{className:l.lockIcon},t.createElement(je,null))),s&&t.createElement(ae,{variant:"body2",className:l.text},s),i&&i.map((function(e,r){return t.createElement(oe,{key:r},t.cloneElement(e,{fullWidth:!0,variant:"outlined",type:"submit",onClick:function(){return f({},"/login")}}))})))),t.createElement(C,null))};Ut.defaultProps={buttons:[t.createElement(ie,{startIcon:t.createElement(G,{src:"/lescommuns.jpg"})},"Les Communs")],userResource:"Person"};function zt(){}function Lt(){}Lt.resetWarningCache=zt;var Wt=function(){function e(e,t,r,n,a,o){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==o){var i=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw i.name="Invariant Violation",i}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:Lt,resetWarningCache:zt};return r.PropTypes=r,r},Vt=Ge((function(e){e.exports=Wt()})),Dt=Ge((function(e){
/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){var t={}.hasOwnProperty;function r(){for(var e=[],n=0;n<arguments.length;n++){var a=arguments[n];if(a){var o=typeof a;if("string"===o||"number"===o)e.push(a);else if(Array.isArray(a)){if(a.length){var i=r.apply(null,a);i&&e.push(i)}}else if("object"===o)if(a.toString===Object.prototype.toString)for(var c in a)t.call(a,c)&&a[c]&&e.push(c);else e.push(a.toString())}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):window.classNames=r}()})),Ft=function(){var e=d();return a((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.signup(t)}),[e])},Bt=["meta","input"],Mt=F((function(e){return{form:{padding:"0 1em 1em 1em"},input:{marginTop:"1em"},button:{width:"100%"},icon:{marginRight:e.spacing(1)}}})),$t=function(t){var r=t.meta,n=r.touched,a=r.error,o=t.input,i=Ue(t,Bt);return e.createElement(B,Ne({error:!(!n||!a),helperText:n&&a},o,i,{fullWidth:!0}))},qt=function(t){var r=t.redirectTo,n=t.delayBeforeRedirect,a=ze(S(!1),2),o=a[0],i=a[1],s=Ft(),u=c(),l=E(),m=Mt(),f=ge(),d=new URLSearchParams(f.search);return e.createElement(ke,{onSubmit:function(e){i(!0),s(e).then((function(e){n?setTimeout((function(){window.location.reload(),window.location.href=r||"/",i(!1)}),n):(window.location.reload(),window.location.href=r||"/",i(!1)),l("auth.message.new_user_created","info")})).catch((function(e){i(!1),l("string"==typeof e?e:void 0!==e&&e.message?e.message:"ra.auth.sign_in_error","warning",{_:"string"==typeof e?e:e&&e.message?e.message:void 0})}))},validate:function(e){var t={email:void 0,password:void 0};return e.email||(t.email=u("ra.validation.required")),e.password||(t.password=u("ra.validation.required")),t},initialValues:{name:d.get("name"),email:d.get("email")},render:function(t){var r=t.handleSubmit;return e.createElement("form",{onSubmit:r,noValidate:!0},e.createElement("div",{className:m.form},e.createElement("div",{className:m.input},e.createElement(xe,{autoFocus:!0,id:"name",name:"name",component:$t,label:u("auth.input.name"),disabled:o})),e.createElement("div",{className:m.input},e.createElement(xe,{id:"username",name:"username",component:$t,label:u("auth.input.username"),disabled:o})),e.createElement("div",{className:m.input},e.createElement(xe,{id:"email",name:"email",component:$t,label:u("auth.input.email"),disabled:o||d.has("email")&&d.has("force-email")})),e.createElement("div",{className:m.input},e.createElement(xe,{id:"password",name:"password",component:$t,label:u("ra.auth.password"),type:"password",disabled:o}))),e.createElement(oe,null,e.createElement(ie,{variant:"contained",type:"submit",color:"primary",disabled:o,className:m.button},o&&e.createElement(ce,{className:m.icon,size:18,thickness:2}),u("auth.action.signup"))))}})};qt.propTypes={redirectTo:Vt.string};var Gt=["theme","title","classes","className"],Ht=F((function(e){return{main:{display:"flex",flexDirection:"column",minHeight:"100vh",height:"1px",alignItems:"center",justifyContent:"flex-start",backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundImage:"radial-gradient(circle at 50% 14em, #313264 0%, #00023b 60%, #00023b 100%)"},card:{minWidth:300,marginTop:"6em"},avatar:{margin:"1em",display:"flex",justifyContent:"center"},icon:{backgroundColor:e.palette.secondary[500]},switch:{margin:"1em",display:"flex",justifyContent:"center"}}})),Jt=function(e){var r=e.theme;e.title,e.classes;var n=e.className,a=Ue(e,Gt),i=Ht(e),c=ge(),s=o((function(){return se(r)}),[r]),u=new URLSearchParams(c.search),l=u.has("signup"),m=u.get("redirect"),f=_(),d=f.identity;return f.loading?null:null!=d&&d.id?t.createElement(be,{to:m||"/"}):t.createElement(ue,{theme:s},t.createElement("div",Ne({className:Dt(i.main,n)},a),t.createElement(ne,{className:i.card},t.createElement("div",{className:i.avatar},t.createElement(G,{className:i.icon},t.createElement(je,null))),l?t.createElement(qt,{redirectTo:m,delayBeforeRedirect:3e3}):t.createElement(A,{redirectTo:m}),t.createElement("div",{className:i.switch},l?t.createElement(ye,{to:"/login"},t.createElement(ae,{variant:"body2"},"Se connecter avec un compte")):t.createElement(ye,{to:"/login?signup=true"},t.createElement(ae,{variant:"body2"},"Créer un nouveau compte")))),t.createElement(C,null)))};Jt.propTypes={children:Vt.node,classes:Vt.object,className:Vt.string,theme:Vt.object};var Yt=i((function(e,r){var n=I();return t.createElement(Oe,{onClick:function(){return n()},ref:r},t.createElement(Pe,null),"   Se déconnecter")})),Kt=["name","create"],Qt=function(e){var r=e.name,n=e.create,a=Ue(e,Kt),o=D(r),i=f(o).permissions;return t.createElement(T,Ne({},a,{name:r,create:i&&i.some((function(e){return rt.includes(e["acl:mode"])}))?n:void 0}))},Xt=["logout"],Zt=i((function(e,r){var n=e.onClick,a=e.webId;return t.createElement(N,{ref:r,to:"/Person/".concat(encodeURIComponent(a),"/show"),primaryText:"Voir mon profil",leftIcon:t.createElement(Ce,null),onClick:n})})),er=i((function(e,r){var n=e.onClick,a=e.webId;return t.createElement(N,{ref:r,to:"/Person/".concat(encodeURIComponent(a)),primaryText:"Editer mon profil",leftIcon:t.createElement(fe,null),onClick:n})})),tr=i((function(e,r){var n=e.onClick;return t.createElement(N,{ref:r,to:"/login",primaryText:"Se connecter",onClick:n})})),rr=i((function(e,r){var n=e.onClick;return t.createElement(N,{ref:r,to:"/login?signup=true",primaryText:"Créer un compte",onClick:n})})),nr=function(e){var r=e.logout,n=Ue(e,Xt),a=_().identity;return t.createElement(R,n,a&&""!==a.id?[t.createElement(Zt,{webId:a.id,key:"view"}),t.createElement(er,{webId:a.id,key:"edit"}),t.cloneElement(r,{key:"logout"})]:[t.createElement(rr,{key:"signup"}),t.createElement(tr,{key:"login"})])};var ar=function(){this.__data__=[],this.size=0};var or=function(e,t){return e===t||e!=e&&t!=t};var ir=function(e,t){for(var r=e.length;r--;)if(or(e[r][0],t))return r;return-1},cr=Array.prototype.splice;var sr=function(e){var t=this.__data__,r=ir(t,e);return!(r<0)&&(r==t.length-1?t.pop():cr.call(t,r,1),--this.size,!0)};var ur=function(e){var t=this.__data__,r=ir(t,e);return r<0?void 0:t[r][1]};var lr=function(e){return ir(this.__data__,e)>-1};var mr=function(e,t){var r=this.__data__,n=ir(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function fr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}fr.prototype.clear=ar,fr.prototype.delete=sr,fr.prototype.get=ur,fr.prototype.has=lr,fr.prototype.set=mr;var dr=fr;var pr=function(){this.__data__=new dr,this.size=0};var hr=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r};var vr=function(e){return this.__data__.get(e)};var gr=function(e){return this.__data__.has(e)},br="object"==typeof qe&&qe&&qe.Object===Object&&qe,yr="object"==typeof self&&self&&self.Object===Object&&self,wr=br||yr||Function("return this")(),_r=wr.Symbol,Er=Object.prototype,jr=Er.hasOwnProperty,kr=Er.toString,xr=_r?_r.toStringTag:void 0;var Or=function(e){var t=jr.call(e,xr),r=e[xr];try{e[xr]=void 0;var n=!0}catch(e){}var a=kr.call(e);return n&&(t?e[xr]=r:delete e[xr]),a},Pr=Object.prototype.toString;var Cr=function(e){return Pr.call(e)},Sr=_r?_r.toStringTag:void 0;var Ar=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Sr&&Sr in Object(e)?Or(e):Cr(e)};var Ir=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};var Tr,Rr=function(e){if(!Ir(e))return!1;var t=Ar(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},Nr=wr["__core-js_shared__"],Ur=(Tr=/[^.]+$/.exec(Nr&&Nr.keys&&Nr.keys.IE_PROTO||""))?"Symbol(src)_1."+Tr:"";var zr=function(e){return!!Ur&&Ur in e},Lr=Function.prototype.toString;var Wr=function(e){if(null!=e){try{return Lr.call(e)}catch(e){}try{return e+""}catch(e){}}return""},Vr=/^\[object .+?Constructor\]$/,Dr=Function.prototype,Fr=Object.prototype,Br=Dr.toString,Mr=Fr.hasOwnProperty,$r=RegExp("^"+Br.call(Mr).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var qr=function(e){return!(!Ir(e)||zr(e))&&(Rr(e)?$r:Vr).test(Wr(e))};var Gr=function(e,t){return null==e?void 0:e[t]};var Hr=function(e,t){var r=Gr(e,t);return qr(r)?r:void 0},Jr=Hr(wr,"Map"),Yr=Hr(Object,"create");var Kr=function(){this.__data__=Yr?Yr(null):{},this.size=0};var Qr=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Xr=Object.prototype.hasOwnProperty;var Zr=function(e){var t=this.__data__;if(Yr){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return Xr.call(t,e)?t[e]:void 0},en=Object.prototype.hasOwnProperty;var tn=function(e){var t=this.__data__;return Yr?void 0!==t[e]:en.call(t,e)};var rn=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Yr&&void 0===t?"__lodash_hash_undefined__":t,this};function nn(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}nn.prototype.clear=Kr,nn.prototype.delete=Qr,nn.prototype.get=Zr,nn.prototype.has=tn,nn.prototype.set=rn;var an=nn;var on=function(){this.size=0,this.__data__={hash:new an,map:new(Jr||dr),string:new an}};var cn=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var sn=function(e,t){var r=e.__data__;return cn(t)?r["string"==typeof t?"string":"hash"]:r.map};var un=function(e){var t=sn(this,e).delete(e);return this.size-=t?1:0,t};var ln=function(e){return sn(this,e).get(e)};var mn=function(e){return sn(this,e).has(e)};var fn=function(e,t){var r=sn(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function dn(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}dn.prototype.clear=on,dn.prototype.delete=un,dn.prototype.get=ln,dn.prototype.has=mn,dn.prototype.set=fn;var pn=dn;var hn=function(e,t){var r=this.__data__;if(r instanceof dr){var n=r.__data__;if(!Jr||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new pn(n)}return r.set(e,t),this.size=r.size,this};function vn(e){var t=this.__data__=new dr(e);this.size=t.size}vn.prototype.clear=pr,vn.prototype.delete=hr,vn.prototype.get=vr,vn.prototype.has=gr,vn.prototype.set=hn;var gn=vn;var bn=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this};var yn=function(e){return this.__data__.has(e)};function wn(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new pn;++t<r;)this.add(e[t])}wn.prototype.add=wn.prototype.push=bn,wn.prototype.has=yn;var _n=wn;var En=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1};var jn=function(e,t){return e.has(t)};var kn=function(e,t,r,n,a,o){var i=1&r,c=e.length,s=t.length;if(c!=s&&!(i&&s>c))return!1;var u=o.get(e),l=o.get(t);if(u&&l)return u==t&&l==e;var m=-1,f=!0,d=2&r?new _n:void 0;for(o.set(e,t),o.set(t,e);++m<c;){var p=e[m],h=t[m];if(n)var v=i?n(h,p,m,t,e,o):n(p,h,m,e,t,o);if(void 0!==v){if(v)continue;f=!1;break}if(d){if(!En(t,(function(e,t){if(!jn(d,t)&&(p===e||a(p,e,r,n,o)))return d.push(t)}))){f=!1;break}}else if(p!==h&&!a(p,h,r,n,o)){f=!1;break}}return o.delete(e),o.delete(t),f},xn=wr.Uint8Array;var On=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r};var Pn=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r},Cn=_r?_r.prototype:void 0,Sn=Cn?Cn.valueOf:void 0;var An=function(e,t,r,n,a,o,i){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new xn(e),new xn(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return or(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var c=On;case"[object Set]":var s=1&n;if(c||(c=Pn),e.size!=t.size&&!s)return!1;var u=i.get(e);if(u)return u==t;n|=2,i.set(e,t);var l=kn(c(e),c(t),n,a,o,i);return i.delete(e),l;case"[object Symbol]":if(Sn)return Sn.call(e)==Sn.call(t)}return!1};var In=function(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e},Tn=Array.isArray;var Rn=function(e,t,r){var n=t(e);return Tn(e)?n:In(n,r(e))};var Nn=function(e,t){for(var r=-1,n=null==e?0:e.length,a=0,o=[];++r<n;){var i=e[r];t(i,r,e)&&(o[a++]=i)}return o};var Un=function(){return[]},zn=Object.prototype.propertyIsEnumerable,Ln=Object.getOwnPropertySymbols,Wn=Ln?function(e){return null==e?[]:(e=Object(e),Nn(Ln(e),(function(t){return zn.call(e,t)})))}:Un;var Vn=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n};var Dn=function(e){return null!=e&&"object"==typeof e};var Fn=function(e){return Dn(e)&&"[object Arguments]"==Ar(e)},Bn=Object.prototype,Mn=Bn.hasOwnProperty,$n=Bn.propertyIsEnumerable,qn=Fn(function(){return arguments}())?Fn:function(e){return Dn(e)&&Mn.call(e,"callee")&&!$n.call(e,"callee")};var Gn=function(){return!1},Hn=Ge((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,a=n&&n.exports===r?wr.Buffer:void 0,o=(a?a.isBuffer:void 0)||Gn;e.exports=o})),Jn=/^(?:0|[1-9]\d*)$/;var Yn=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&Jn.test(e))&&e>-1&&e%1==0&&e<t};var Kn=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},Qn={};Qn["[object Float32Array]"]=Qn["[object Float64Array]"]=Qn["[object Int8Array]"]=Qn["[object Int16Array]"]=Qn["[object Int32Array]"]=Qn["[object Uint8Array]"]=Qn["[object Uint8ClampedArray]"]=Qn["[object Uint16Array]"]=Qn["[object Uint32Array]"]=!0,Qn["[object Arguments]"]=Qn["[object Array]"]=Qn["[object ArrayBuffer]"]=Qn["[object Boolean]"]=Qn["[object DataView]"]=Qn["[object Date]"]=Qn["[object Error]"]=Qn["[object Function]"]=Qn["[object Map]"]=Qn["[object Number]"]=Qn["[object Object]"]=Qn["[object RegExp]"]=Qn["[object Set]"]=Qn["[object String]"]=Qn["[object WeakMap]"]=!1;var Xn=function(e){return Dn(e)&&Kn(e.length)&&!!Qn[Ar(e)]};var Zn=function(e){return function(t){return e(t)}},ea=Ge((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,a=n&&n.exports===r&&br.process,o=function(){try{var e=n&&n.require&&n.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=o})),ta=ea&&ea.isTypedArray,ra=ta?Zn(ta):Xn,na=Object.prototype.hasOwnProperty;var aa=function(e,t){var r=Tn(e),n=!r&&qn(e),a=!r&&!n&&Hn(e),o=!r&&!n&&!a&&ra(e),i=r||n||a||o,c=i?Vn(e.length,String):[],s=c.length;for(var u in e)!t&&!na.call(e,u)||i&&("length"==u||a&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Yn(u,s))||c.push(u);return c},oa=Object.prototype;var ia=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||oa)};var ca=function(e,t){return function(r){return e(t(r))}}(Object.keys,Object),sa=Object.prototype.hasOwnProperty;var ua=function(e){if(!ia(e))return ca(e);var t=[];for(var r in Object(e))sa.call(e,r)&&"constructor"!=r&&t.push(r);return t};var la=function(e){return null!=e&&Kn(e.length)&&!Rr(e)};var ma=function(e){return la(e)?aa(e):ua(e)};var fa=function(e){return Rn(e,ma,Wn)},da=Object.prototype.hasOwnProperty;var pa=function(e,t,r,n,a,o){var i=1&r,c=fa(e),s=c.length;if(s!=fa(t).length&&!i)return!1;for(var u=s;u--;){var l=c[u];if(!(i?l in t:da.call(t,l)))return!1}var m=o.get(e),f=o.get(t);if(m&&f)return m==t&&f==e;var d=!0;o.set(e,t),o.set(t,e);for(var p=i;++u<s;){var h=e[l=c[u]],v=t[l];if(n)var g=i?n(v,h,l,t,e,o):n(h,v,l,e,t,o);if(!(void 0===g?h===v||a(h,v,r,n,o):g)){d=!1;break}p||(p="constructor"==l)}if(d&&!p){var b=e.constructor,y=t.constructor;b==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof y&&y instanceof y||(d=!1)}return o.delete(e),o.delete(t),d},ha=Hr(wr,"DataView"),va=Hr(wr,"Promise"),ga=Hr(wr,"Set"),ba=Hr(wr,"WeakMap"),ya=Wr(ha),wa=Wr(Jr),_a=Wr(va),Ea=Wr(ga),ja=Wr(ba),ka=Ar;(ha&&"[object DataView]"!=ka(new ha(new ArrayBuffer(1)))||Jr&&"[object Map]"!=ka(new Jr)||va&&"[object Promise]"!=ka(va.resolve())||ga&&"[object Set]"!=ka(new ga)||ba&&"[object WeakMap]"!=ka(new ba))&&(ka=function(e){var t=Ar(e),r="[object Object]"==t?e.constructor:void 0,n=r?Wr(r):"";if(n)switch(n){case ya:return"[object DataView]";case wa:return"[object Map]";case _a:return"[object Promise]";case Ea:return"[object Set]";case ja:return"[object WeakMap]"}return t});var xa=ka,Oa="[object Object]",Pa=Object.prototype.hasOwnProperty;var Ca=function(e,t,r,n,a,o){var i=Tn(e),c=Tn(t),s=i?"[object Array]":xa(e),u=c?"[object Array]":xa(t),l=(s="[object Arguments]"==s?Oa:s)==Oa,m=(u="[object Arguments]"==u?Oa:u)==Oa,f=s==u;if(f&&Hn(e)){if(!Hn(t))return!1;i=!0,l=!1}if(f&&!l)return o||(o=new gn),i||ra(e)?kn(e,t,r,n,a,o):An(e,t,s,r,n,a,o);if(!(1&r)){var d=l&&Pa.call(e,"__wrapped__"),p=m&&Pa.call(t,"__wrapped__");if(d||p){var h=d?e.value():e,v=p?t.value():t;return o||(o=new gn),a(h,v,r,n,o)}}return!!f&&(o||(o=new gn),pa(e,t,r,n,a,o))};var Sa=function e(t,r,n,a,o){return t===r||(null==t||null==r||!Dn(t)&&!Dn(r)?t!=t&&r!=r:Ca(t,r,n,a,e,o))};var Aa=function(e,t){return Sa(e,t)},Ia={},Ta={"{}":void 0},Ra=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ia,t=JSON.stringify(e),r=S({permissions:Ta[t]}),o=ze(r,2),i=o[0],c=o[1],s=U(),u=a((function(){return s(e).then((function(e){Aa(e,i.permissions)||(Ta[t]=e,c({permissions:e}))})).catch((function(e){c({error:e})}))}),[t,e,s]);return n((function(){u()}),[t]),Ae(Ae({},i),{},{refetch:u})},Na={auth:{dialog:{container_permissions:"Permissions sur le container",resource_permissions:"Permissions sur la resource"},action:{permissions:"Permissions",signup:"S'inscrire"},right:{resource:{read:"Lire",append:"Enrichir",write:"Modifier",control:"Administrer"},container:{read:"Lister",append:"Ajouter",write:"Ajouter",control:"Administrer"}},agent:{anonymous:"Tous les utilisateurs",authenticated:"Utilisateurs connectés"},input:{agent_select:"Ajouter un utilisateur...",name:"Prénom",username:"Identifiant unique",email:"Adresse e-mail",username_or_email:"Identifiant ou adresse e-mail"},message:{resource_show_forbidden:"Vous n'avez pas la permission de voir cette ressource",resource_edit_forbidden:"Vous n'avez pas la permission d'éditer cette ressource",resource_delete_forbidden:"Vous n'avez pas la permission d'effacer cette ressource",resource_control_forbidden:"Vous n'avez pas la permission d'administrer cette ressource",container_create_forbidden:"Vous n'avez pas la permission de créer des ressources",container_list_forbidden:"Vous n'avez pas la permission de voir ces ressources",user_not_allowed_to_login:"Vous n'avez pas le droit de vous connecter avec ce compte",user_email_not_found:"Aucun compte trouvé avec cette adresse mail",user_email_exist:"Un compte existe déjà avec cette adresse mail",username_exist:"Un compte existe déjà avec cet identifiant",username_invalid:"Cet identifiant n'est pas valide. Seuls les lettres minuscules, les chiffres, les points et les tirets sont autorisés",new_user_created:"Votre compte a été créé avec succès",user_connected:"Vous êtes maintenant connecté",user_disconnected:"Vous êtes maintenant déconnecté",bad_request:"Requête erronée (Message d'erreur renvoyé par le serveur: %{error})"}}};export{jt as DeleteButtonWithPermissions,Et as EditActions,xt as EditToolbarWithPermissions,Ct as EditWithPermissions,At as ListWithPermissions,Jt as LocalLoginPage,Ut as LoginPage,Yt as LogoutButton,wt as PermissionsButton,Qt as ResourceWithPermissions,Tt as ShowActions,Rt as ShowWithPermissions,Ut as SsoLoginPage,nr as UserMenu,et as authProvider,Na as frenchMessages,gt as useAgents,Ot as useCheckAuthenticated,Pt as useCheckPermissions,Ra as usePermissionsWithRefetch,Ft as useSignup};
//# sourceMappingURL=index.es.js.map
