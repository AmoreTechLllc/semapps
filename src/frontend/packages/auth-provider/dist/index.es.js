import e,{useState as t,useEffect as r,useCallback as n,createElement as a,useMemo as o,forwardRef as i}from"react";import{useTranslate as c,useGetList as s,useDataProvider as u,Loading as l,Error as m,usePermissionsOptimized as f,useAuthProvider as d,Button as p,ListButton as h,ShowButton as v,useRecordContext as g,DeleteButton as b,Toolbar as y,SaveButton as w,useGetIdentity as _,useNotify as j,useRedirect as E,Edit as k,EditButton as O,Show as x,useLogin as P,Notification as C,useSafeSetState as S,LoginForm as A,useLogout as I,Resource as T,MenuItemLink as R,UserMenu as N,useGetPermissions as U}from"react-admin";import{TopToolbar as z,List as L,ListActions as W}from"@semapps/archipelago-layout";import V from"@material-ui/icons/Share";import{useCreateContainer as D}from"@semapps/semantic-data-provider";import{makeStyles as F,TextField as M,List as B,ListItem as $,ListItemAvatar as q,Avatar as G,ListItemText as H,ListItemSecondaryAction as J,IconButton as Y,Menu as K,MenuItem as Q,ListItemIcon as X,Dialog as Z,DialogTitle as ee,DialogContent as te,DialogActions as re,Card as ne,Typography as ae,CardActions as oe,Button as ie,CircularProgress as ce,createMuiTheme as se,ThemeProvider as ue}from"@material-ui/core";import le from"@material-ui/lab/Autocomplete";import me from"@material-ui/icons/Person";import fe from"@material-ui/icons/Edit";import de from"@material-ui/icons/Check";import pe from"@material-ui/icons/Public";import he from"@material-ui/icons/VpnLock";import ve from"@material-ui/icons/Group";import{useLocation as ge,Redirect as be,Link as ye}from"react-router-dom";import{ThemeProvider as we}from"@material-ui/styles";import{makeStyles as _e,createMuiTheme as je}from"@material-ui/core/styles";import Ee from"@material-ui/icons/Lock";import{Form as ke,Field as Oe}from"react-final-form";import xe from"@material-ui/core/MenuItem";import Pe from"@material-ui/icons/PowerSettingsNew";import Ce from"@material-ui/icons/AccountCircle";function Se(e,t,r,n,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void r(e)}c.done?t(s):Promise.resolve(s).then(n,a)}function Ae(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){Se(o,n,a,i,c,"next",e)}function c(e){Se(o,n,a,i,c,"throw",e)}i(void 0)}))}}function Ie(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Te(){return(Te=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ne(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(r),!0).forEach((function(t){Ie(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Re(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ue(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ze(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(n=(i=c.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}return r}(e,t)||We(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Le(e){return function(e){if(Array.isArray(e))return Ve(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||We(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function We(e,t){if(e){if("string"==typeof e)return Ve(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ve(e,t):void 0}}function Ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function De(e){this.message=e}De.prototype=new Error,De.prototype.name="InvalidCharacterError";var Fe="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new De("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,n,a=0,o=0,i="";n=t.charAt(o++);~n&&(r=a%4?64*r+n:n,a++%4)?i+=String.fromCharCode(255&r>>(-2*a&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return i};function Me(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(Fe(e).replace(/(.)/g,(function(e,t){var r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r})))}(t)}catch(e){return Fe(t)}}function Be(e){this.message=e}function $e(e,t){if("string"!=typeof e)throw new Be("Invalid token specified");var r=!0===(t=t||{}).header?0:1;try{return JSON.parse(Me(e.split(".")[r]))}catch(e){throw new Be("Invalid token specified: "+e.message)}}Be.prototype=new Error,Be.prototype.name="InvalidTokenError";var qe="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Ge(e,t){return e(t={exports:{}},t.exports),t.exports}var He,Je,Ye=Ge((function(e){var t,r;t=qe,r=function(){function e(e){var t=[];if(0===e.length)return"";if("string"!=typeof e[0])throw new TypeError("Url must be a string. Received "+e[0]);if(e[0].match(/^[^/:]+:\/*$/)&&e.length>1){var r=e.shift();e[0]=r+e[0]}e[0].match(/^file:\/\/\//)?e[0]=e[0].replace(/^([^/:]+):\/*/,"$1:///"):e[0]=e[0].replace(/^([^/:]+):\/*/,"$1://");for(var n=0;n<e.length;n++){var a=e[n];if("string"!=typeof a)throw new TypeError("Url must be a string. Received "+a);""!==a&&(n>0&&(a=a.replace(/^[\/]+/,"")),a=n<e.length-1?a.replace(/[\/]+$/,""):a.replace(/[\/]+$/,"/"),t.push(a))}var o=t.join("/"),i=(o=o.replace(/\/(\?|&|#[^!])/g,"$1")).split("?");return o=i.shift()+(i.length>0?"?":"")+i.join("&")}return function(){return e("object"==typeof arguments[0]?arguments[0]:[].slice.call(arguments))}},e.exports?e.exports=r():t.urljoin=r()})),Ke=function(e){return e?Array.isArray(e)?e:[e]:void 0},Qe=function(e,t){var r=new URL(t);return Ye(r.origin,"_acl",r.pathname)},Xe=function(e){return{"@base":e,acl:"http://www.w3.org/ns/auth/acl#",foaf:"http://xmlns.com/foaf/0.1/","acl:agent":{"@type":"@id"},"acl:agentGroup":{"@type":"@id"},"acl:agentClass":{"@type":"@id"},"acl:mode":{"@type":"@id"},"acl:accessTo":{"@type":"@id"}}},Ze=function(e){var t,r,n,a,o,i,c,s,u=e.middlewareUri,l=e.allowAnonymous,m=void 0===l||l,f=e.localAccounts,d=void 0!==f&&f,p=e.checkUser,h=e.httpClient,v=e.checkPermissions;return{login:(s=Ae(regeneratorRuntime.mark((function e(t){var r,n,a,o,i,c,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=new URL(window.location.href),n=u||t.domain&&"https://".concat(t.domain,"/")){e.next=4;break}throw new Error("You must specify a middlewareUri in the authProvider config, or specify a domain when calling the login method");case 4:if(!d){e.next=21;break}return a=t.username,o=t.password,e.prev=6,e.next=9,h("".concat(n,"auth/login"),{method:"POST",body:JSON.stringify({username:a.trim(),password:o.trim()}),headers:new Headers({"Content-Type":"application/json"})});case 9:i=e.sent,c=i.json,s=c.token,localStorage.setItem("token",s),window.location.reload(),e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(6),new Error("ra.auth.sign_in_error");case 19:e.next=22;break;case 21:window.location.href="".concat(n,"auth?redirectUrl=")+encodeURIComponent(r.origin+"/login?login=true");case 22:case"end":return e.stop()}}),e,null,[[6,16]])}))),function(e){return s.apply(this,arguments)}),signup:(c=Ae(regeneratorRuntime.mark((function e(t){var r,n,a,o,i,c,s,l,m,f,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u||t.domain&&"https://".concat(t.domain,"/")){e.next=3;break}throw new Error("You must specify a middlewareUri in the authProvider config, or specify a domain when calling the signup method");case 3:if(!d){e.next=25;break}return n=t.username,a=t.email,o=t.password,i=t.domain,c=Ue(t,["username","email","password","domain"]),e.prev=5,e.next=8,h("".concat(r||"https://".concat(i),"auth/signup"),{method:"POST",body:JSON.stringify(Ne({username:n.trim(),email:a.trim(),password:o.trim()},c)),headers:new Headers({"Content-Type":"application/json"})});case 8:return s=e.sent,l=s.json,m=l.token,localStorage.setItem("token",m),f=$e(m),p=f.webId,e.abrupt("return",p);case 16:if(e.prev=16,e.t0=e.catch(5),"email.already.exists"!==e.t0.message){e.next=22;break}throw new Error("auth.message.user_email_exist");case 22:throw new Error(e.t0.message||"ra.auth.sign_in_error");case 23:e.next=26;break;case 25:window.location.href="".concat(r,"auth?redirectUrl=")+encodeURIComponent(url.origin+"/login?login=true");case 26:case"end":return e.stop()}}),e,null,[[5,16]])}))),function(e){return c.apply(this,arguments)}),logout:(i=Ae(regeneratorRuntime.mark((function e(){var t,r,n,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u?t=u:(r=localStorage.getItem("token"))&&(n=$e(r),a=n.webId,t=new URL(a).origin+"/"),localStorage.removeItem("token"),d?(window.location.reload(),window.location.href="/"):t&&(o=new URL(window.location.href),window.location.href=m?"".concat(t,"auth/logout?redirectUrl=")+encodeURIComponent(o.origin+"/login?logout=true"):"".concat(t,"auth/logout?redirectUrl=")+encodeURIComponent(o.origin+"/login")),e.abrupt("return","/");case 4:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)}),checkAuth:(o=Ae(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(localStorage.getItem("token")||m){e.next=3;break}throw new Error;case 3:case"end":return e.stop()}}),e)}))),function(){return o.apply(this,arguments)}),checkUser:function(e){return!p||p(e)},checkError:function(e){return Promise.resolve()},getPermissions:(a=Ae(regeneratorRuntime.mark((function e(t){var r,n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v){e.next=2;break}return e.abrupt("return",!0);case 2:if(t&&t.startsWith("http")){e.next=4;break}throw new Error("The first parameter passed to getPermissions must be an URL");case 4:return r=Qe(),e.next=7,h(r);case 7:return n=e.sent,a=n.json,e.abrupt("return",a["@graph"]);case 10:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),addPermission:(n=Ae(regeneratorRuntime.mark((function e(t,r,n,a){var o,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Qe(),t&&t.startsWith("http")){e.next=3;break}throw new Error("The first parameter passed to addPermission must be an URL");case 3:return Ie(o={"@id":"#"+a.replace("acl:",""),"@type":"acl:Authorization"},n,r),Ie(o,"acl:accessTo",resourceUri),Ie(o,"acl:mode",a),c=o,e.next=6,h(i,{method:"PATCH",body:JSON.stringify({"@context":Xe(i),"@graph":[c]})});case 6:case"end":return e.stop()}}),e)}))),function(e,t,r,a){return n.apply(this,arguments)}),removePermission:(r=Ae(regeneratorRuntime.mark((function e(t,r,n,a){var o,i,c,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.startsWith("http")){e.next=2;break}throw new Error("The first parameter passed to removePermission must be an URL");case 2:return o=Qe(),e.next=5,h(o);case 5:return i=e.sent,c=i.json,s=c["@graph"].filter((function(e){return!e["@id"].includes("#Default")})).map((function(e){var t=Ke(e["acl:mode"]),o=Ke(e[n]);return a&&t.includes(a)&&o&&o.includes(r)&&(o=o.filter((function(e){return e!==r}))),Ne(Ne({},e),{},Ie({},n,o))})),e.next=10,h(o,{method:"PUT",body:JSON.stringify({"@context":Xe(o),"@graph":s})});case 10:case"end":return e.stop()}}),e)}))),function(e,t,n,a){return r.apply(this,arguments)}),getIdentity:(t=Ae(regeneratorRuntime.mark((function e(){var t,r,n,a,o,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=localStorage.getItem("token"))){e.next=17;break}return r=$e(t),n=r.webId,e.next=5,h(n);case 5:if(a=e.sent,!(o=a.json).url){e.next=13;break}return e.next=10,h(o.url);case 10:e.t0=e.sent,e.next=14;break;case 13:e.t0={};case 14:return i=e.t0,c=i.json,e.abrupt("return",{id:n,fullName:(null==c?void 0:c["pair:label"])||o["foaf:name"],profileData:c,webIdData:o});case 17:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}},et="acl:agentClass",tt=["acl:Append","acl:Write","acl:Control"],rt=["acl:Append","acl:Write","acl:Control"],nt=["acl:Write","acl:Control"],at=["acl:Control"],ot={show:["acl:Read","acl:Append","acl:Write","acl:Control"],list:["acl:Read","acl:Append","acl:Write","acl:Control"],create:tt,edit:rt,delete:nt,control:at},it={show:"auth.message.resource_show_forbidden",edit:"auth.message.resource_edit_forbidden",delete:"auth.message.resource_delete_forbidden",control:"auth.message.resource_control_forbidden",list:"auth.message.container_list_forbidden",create:"auth.message.container_create_forbidden"},ct=(Ie(He={},"acl:Read","auth.right.resource.read"),Ie(He,"acl:Append","auth.right.resource.append"),Ie(He,"acl:Write","auth.right.resource.write"),Ie(He,"acl:Control","auth.right.resource.control"),He),st=(Ie(Je={},"acl:Read","auth.right.container.read"),Ie(Je,"acl:Write","auth.right.container.write"),Ie(Je,"acl:Control","auth.right.container.control"),Je),ut=F((function(){return{list:{padding:0,width:"100%"},option:{padding:0}}})),lt=function(n){var a=n.agents,o=n.addPermission,i=ut(),u=c(),l=ze(t(null),2),m=l[0],f=l[1],d=ze(t(""),2),p=d[0],h=d[1],v=ze(t([]),2),g=v[0],b=v[1],y=s("Person",{page:1,perPage:100},{field:"pair:label",order:"ASC"},{q:p},{enabled:p.length>0}),w=y.ids,_=y.data;return r((function(){b(w.length>0?Object.values(_):[])}),[w,_]),e.createElement(le,{classes:{option:i.option},getOptionLabel:function(e){return e["pair:label"]},filterOptions:function(e){return e.filter((function(e){return!Object.keys(a).includes(e.id)}))},options:g,noOptionsText:u("ra.navigation.no_results"),autoComplete:!0,blurOnSelect:!0,clearOnBlur:!0,disableClearable:!0,value:m,onChange:function(e,t){o(t.id||t["@id"],"acl:agent","acl:Read"),f(null),h(""),b([])},onInputChange:function(e,t){h(t)},renderInput:function(t){return e.createElement(M,Te({},t,{label:u("auth.input.agent_select"),variant:"filled",margin:"dense",fullWidth:!0}))},renderOption:function(t){return e.createElement(B,{dense:!0,className:i.list},e.createElement($,{button:!0},e.createElement(q,null,e.createElement(G,{src:t.image},e.createElement(me,null))),e.createElement(H,{primary:t["pair:label"]})))}})},mt=function(t){var r=t.agent;switch(r.predicate){case et:return"foaf:Agent"===r.id?e.createElement(pe,null):e.createElement(he,null);case"acl:agent":return e.createElement(me,null);case"acl:agentGroup":return e.createElement(ve,null);default:throw new Error("Unknown agent predicate: "+r.predicate)}},ft=F((function(){return{listItem:{paddingLeft:4,paddingRight:36},primaryText:{width:"30%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},secondaryText:{textAlign:"center",width:"60%",fontStyle:"italic",color:"grey"}}})),dt=function(n){var a=n.isContainer,o=n.agent,i=n.addPermission,s=n.removePermission,f=ft(),d=c(),p=u(),h=ze(e.useState(null),2),v=h[0],g=h[1],b=ze(t(),2),y=b[0],w=b[1],_=ze(t(!0),2),j=_[0],E=_[1],k=ze(t(),2),O=k[0],x=k[1];if(r((function(){"acl:agent"===o.predicate?p.getOne("Person",{id:o.id}).then((function(e){var t=e.data;w(t),E(!1)})).catch((function(e){x(e),E(!1)})):E(!1)}),[o.id,o.predicate]),"acl:agentGroup"===o.predicate)return null;var P=function(){return g(null)},C=a?st:ct;return j?e.createElement(l,null):O?e.createElement(m,null):e.createElement($,{className:f.listItem},e.createElement(q,null,e.createElement(G,{src:null==y?void 0:y.image},e.createElement(mt,{agent:o}))),e.createElement(H,{className:f.primaryText,primary:y?y["pair:label"]:d("foaf:Agent"===o.id?"auth.agent.anonymous":"auth.agent.authenticated")}),e.createElement(H,{className:f.secondaryText,primary:o.permissions&&o.permissions.map((function(e){return d(C[e])})).join(", ")}),e.createElement(J,null,e.createElement(Y,{onClick:function(e){return g(e.currentTarget)}},e.createElement(fe,null)),e.createElement(K,{anchorEl:v,keepMounted:!0,open:Boolean(v),onClose:P},Object.entries(C).map((function(t){var r=ze(t,2),n=r[0],a=r[1],c=o.permissions&&o.permissions.includes(n);return e.createElement(Q,{key:n,onClick:function(){c?s(o.id,o.predicate,n):i(o.id,o.predicate,n),P()}},e.createElement(X,null,c?e.createElement(de,null):null),e.createElement(H,{primary:d(a)}))})))))},pt=F((function(e){return{list:{width:"100%",maxWidth:"100%",backgroundColor:e.palette.background.paper}}})),ht=function(t){var r=t.isContainer,n=t.agents,a=t.addPermission,o=t.removePermission,i=pt();return e.createElement(B,{dense:!0,className:i.list},Object.entries(n).map((function(t){var n=ze(t,2),i=n[0],c=n[1];return e.createElement(dt,{key:i,isContainer:r,agent:c,addPermission:a,removePermission:o})})))},vt=function(e){var a=f(e).permissions,o=d(),i=ze(t({}),2),c=i[0],s=i[1];r((function(){var e,t=(Ie(e={},"foaf:Agent",{id:"foaf:Agent",predicate:et,permissions:[]}),Ie(e,"acl:AuthenticatedAgent",{id:"acl:AuthenticatedAgent",predicate:et,permissions:[]}),e),r=function(e,r,n){t[e]?t[e].permissions.push(n):t[e]={id:e,predicate:r,permissions:[n]}};if(a){var n,o=function(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=We(e))){var t=0,r=function(){};return{s:r,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a,o=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw a}}}}(a);try{var i=function(){var e=n.value;e[et]&&Ke(e[et]).forEach((function(t){return r(t,et,e["acl:mode"])})),e["acl:agent"]&&Ke(e["acl:agent"]).forEach((function(t){return r(t,"acl:agent",e["acl:mode"])})),e["acl:agentGroup"]&&Ke(e["acl:agentGroup"]).forEach((function(t){return r(t,"acl:agentGroup",e["acl:mode"])}))};for(o.s();!(n=o.n()).done;)i()}catch(e){o.e(e)}finally{o.f()}s(t)}}),[a]);var u=n((function(t,r,n){var a,i=Ne({},c);s(Ne(Ne({},c),{},Ie({},t,{id:t,predicate:r,permissions:c[t]?[].concat(Le(null===(a=c[t])||void 0===a?void 0:a.permissions),[n]):[n]}))),o.addPermission(e,t,r,n).catch((function(e){s(i)}))}),[c,s,e,o]),l=n((function(t,r,n){var a=Ne({},c);s(Object.fromEntries(Object.entries(c).map((function(e){var r=ze(e,2),a=r[0],o=r[1];return o.id===t&&(o.permissions=o.permissions.filter((function(e){return e!==n}))),[a,o]})).filter((function(e){var t=ze(e,2),r=(t[0],t[1]);return r.predicate===et||r.permissions.length>0})))),o.removePermission(e,t,r,n).catch((function(e){s(a)}))}),[c,s,e,o]);return{agents:c,addPermission:u,removePermission:l}},gt=F((function(){return{title:{paddingBottom:8},actions:{padding:15},addForm:{paddingTop:0},listForm:{paddingTop:0,paddingBottom:0,paddingRight:0,maxHeight:210}}})),bt=function(t){var r=t.open,n=t.onClose,a=t.uri,o=t.isContainer,i=gt(),s=c(),u=vt(a),l=u.agents,m=u.addPermission,f=u.removePermission;return e.createElement(Z,{fullWidth:!0,open:r,onClose:n},e.createElement(ee,{className:i.title},s(o?"auth.dialog.container_permissions":"auth.dialog.resource_permissions")),e.createElement(te,{className:i.addForm},e.createElement(lt,{agents:l,addPermission:m})),e.createElement(te,{className:i.listForm},e.createElement(ht,{isContainer:o,agents:l,addPermission:m,removePermission:f})),e.createElement(re,{className:i.actions},e.createElement(p,{label:"ra.action.close",variant:"text",onClick:n})))},yt=function(r){var n=r.record,a=r.resource,o=ze(t(!1),2),i=o[0],c=o[1],s=D(a),u=!!a,l=u?s:n.id||n["@id"];return e.createElement(e.Fragment,null,e.createElement(p,{label:"auth.action.permissions",onClick:function(){return c(!0)}},e.createElement(V,null)),e.createElement(bt,{uri:l,isContainer:!!u,open:i,onClose:function(){return c(!1)}}))},wt=function(t){var r=t.basePath,n=t.className,a=t.data,o=t.hasList,i=t.hasShow,c=t.hasControl,s=Ue(t,["basePath","className","data","hasList","hasShow","hasControl"]);return e.createElement(z,Te({className:n},s),o&&e.createElement(h,{basePath:r,record:a}),i&&e.createElement(v,{basePath:r,record:a}),a&&c&&e.createElement(yt,{basePath:r,record:a}))},_t=function(t){var r=g(),n=f(r.id).permissions;return n&&n.some((function(e){return nt.includes(e["acl:mode"])}))?e.createElement(b,t):null},jt=F((function(){return{toolbar:{flex:1,display:"flex",justifyContent:"space-between"}}})),Et=function(t){var r=jt();return e.createElement(y,Te({},t,{className:r.toolbar}),e.createElement(w,null),e.createElement(_t,{undoable:!1}),"}")},kt=function(){var e=_(),t=e.identity,n=e.loading,a=j(),o=E(),i=ge();return r((function(){n||(null==t?void 0:t.id)||(a("ra.auth.auth_check_error","error"),o("/login?redirect="+encodeURIComponent(i.pathname)))}),[n,t,o,a,i]),{identity:t,loading:n}},Ot=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",a=kt(),o=a.identity,i=f(e),c=i.permissions,s=j(),u=E();return r((function(){(null==o?void 0:o.id)&&c&&!c.some((function(e){return ot[t].includes(e["acl:mode"])}))&&(s(it[t],"error"),u(n))}),[c,o,u,s]),c},xt=function(t){var r=Ot(t.id,"edit");return e.createElement(k,Te({actions:e.createElement(wt,{hasControl:!!r&&r.some((function(e){return at.includes(e["acl:mode"])}))})},t,{permissions:r}),e.cloneElement(t.children,Ne({toolbar:e.createElement(Et,null)},t.children.props)))},Pt=function(t){var r=t.actions,n=t.resource,a=t.hasCreate,o=Ue(t,["actions","resource","hasCreate"]),i=D(n),c=f(i).permissions;return e.createElement(L,Te({},o,{resource:n,hasCreate:a&&!!c&&c.some((function(e){return tt.includes(e["acl:mode"])})),actions:r&&c&&c.some((function(e){return at.includes(e["acl:mode"])}))?e.cloneElement(r,{bulkActions:e.createElement(yt,null)}):r}))};Pt.defaultProps={actions:e.createElement(W,null)};var Ct=function(t){var r=t.basePath,n=t.className,a=t.data,o=t.hasList,i=t.hasEdit,c=t.hasControl,s=Ue(t,["basePath","className","data","hasList","hasEdit","hasControl"]);return e.createElement(z,Te({className:n},s),o&&e.createElement(h,{basePath:r,record:a}),i&&e.createElement(O,{basePath:r,record:a}),a&&c&&e.createElement(yt,{basePath:r,record:a}))},St=function(t){var r=f(t.id).permissions;return e.createElement(x,Te({actions:e.createElement(Ct,{hasControl:!!r&&r.some((function(e){return at.includes(e["acl:mode"])}))})},t,{permissions:r,hasEdit:t.hasEdit&&!!r&&r.some((function(e){return rt.includes(e["acl:mode"])}))}))},At=_e((function(e){return{main:{display:"flex",flexDirection:"column",minHeight:"100vh",alignItems:"center",justifyContent:"flex-start",backgroundColor:e.palette.grey[300]},text:{maxWidth:300,textAlign:"center",padding:"4px 8px 8px"},card:{minWidth:300,marginTop:"6em"},lockIconAvatar:{margin:"1em",display:"flex",justifyContent:"center"},lockIcon:{backgroundColor:e.palette.grey[500]}}})),It=function(t){var n=t.theme,a=t.history,o=t.location,i=t.buttons,c=t.userResource,s=t.text,l=At(),m=j(),f=P(),p=u(),h=d();return r((function(){Ae(regeneratorRuntime.mark((function e(){var t,r,n,i,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=new URLSearchParams(o.search)).has("login")){e.next=14;break}if(!t.has("error")){e.next=6;break}"registration.not-allowed"===t.get("error")?m("auth.message.user_email_not_found","error"):m("auth.message.bad_request","error",{error:t.get("error")}),e.next=14;break;case 6:if(!t.has("token")){e.next=14;break}return r=t.get("token"),n=$e(r),i=n.webId,e.next=11,p.getOne("Person",{id:i});case 11:s=e.sent,u=s.data,h.checkUser(u)?(localStorage.setItem("token",r),t.has("new")&&"true"===t.get("new")?(m("auth.message.new_user_created","info"),a.push("/"+c+"/"+encodeURIComponent(i)+"/edit")):(m("auth.message.user_connected","info"),a.push("/"))):(m("auth.message.user_not_allowed_to_login","error"),a.replace("/login"));case 14:t.has("logout")&&(localStorage.removeItem("token"),m("auth.message.user_disconnected","info"),a.push("/"));case 15:case"end":return e.stop()}}),e)})))()}),[o.search]),e.createElement(we,{theme:je(n)},e.createElement("div",{className:l.main},e.createElement(ne,{className:l.card},e.createElement("div",{className:l.lockIconAvatar},e.createElement(G,{className:l.lockIcon},e.createElement(Ee,null))),s&&e.createElement(ae,{variant:"body2",className:l.text},s),i&&i.map((function(t,r){return e.createElement(oe,{key:r},e.cloneElement(t,{fullWidth:!0,variant:"outlined",type:"submit",onClick:function(){return f({},"/login")}}))})))),e.createElement(C,null))};It.defaultProps={buttons:[e.createElement(ie,{startIcon:e.createElement(G,{src:"/lescommuns.jpg"})},"Les Communs")],userResource:"Person"};function Tt(){}function Rt(){}Rt.resetWarningCache=Tt;var Nt=Ge((function(e){e.exports=function(){function e(e,t,r,n,a,o){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==o){var i=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw i.name="Invariant Violation",i}}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:Rt,resetWarningCache:Tt};return r.PropTypes=r,r}()})),Ut=Ge((function(e){
/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){var t={}.hasOwnProperty;function r(){for(var e=[],n=0;n<arguments.length;n++){var a=arguments[n];if(a){var o=typeof a;if("string"===o||"number"===o)e.push(a);else if(Array.isArray(a)){if(a.length){var i=r.apply(null,a);i&&e.push(i)}}else if("object"===o)if(a.toString===Object.prototype.toString)for(var c in a)t.call(a,c)&&a[c]&&e.push(c);else e.push(a.toString())}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):window.classNames=r}()})),zt=function(){var e=d();return n((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.signup(t)}),[e])},Lt=F((function(e){return{form:{padding:"0 1em 1em 1em"},input:{marginTop:"1em"},button:{width:"100%"},icon:{marginRight:e.spacing(1)}}})),Wt=function(e){var t=e.meta,r=t.touched,n=t.error,o=e.input,i=Ue(e,["meta","input"]);return a(M,Te({error:!(!r||!n),helperText:r&&n},o,i,{fullWidth:!0}))},Vt=function(e){var t=e.redirectTo,r=e.delayBeforeRedirect,n=ze(S(!1),2),o=n[0],i=n[1],s=zt(),u=c(),l=j(),m=Lt(),f=ge(),d=new URLSearchParams(f.search);return a(ke,{onSubmit:function(e){i(!0),s(e).then((function(e){r?setTimeout((function(){window.location.reload(),window.location.href=t||"/",i(!1)}),r):(window.location.reload(),window.location.href=t||"/",i(!1)),l("auth.message.new_user_created","info")})).catch((function(e){i(!1),l("string"==typeof e?e:void 0!==e&&e.message?e.message:"ra.auth.sign_in_error","warning",{_:"string"==typeof e?e:e&&e.message?e.message:void 0})}))},validate:function(e){var t={email:void 0,password:void 0};return e.email||(t.email=u("ra.validation.required")),e.password||(t.password=u("ra.validation.required")),t},initialValues:{name:d.get("name"),email:d.get("email")},render:function(e){var t=e.handleSubmit;return a("form",{onSubmit:t,noValidate:!0},a("div",{className:m.form},a("div",{className:m.input},a(Oe,{autoFocus:!0,id:"name",name:"name",component:Wt,label:u("auth.input.name"),disabled:o})),a("div",{className:m.input},a(Oe,{id:"username",name:"username",component:Wt,label:u("auth.input.username"),disabled:o})),a("div",{className:m.input},a(Oe,{id:"email",name:"email",component:Wt,label:u("auth.input.email"),disabled:o||d.has("email")&&d.has("force-email")})),a("div",{className:m.input},a(Oe,{id:"password",name:"password",component:Wt,label:u("ra.auth.password"),type:"password",disabled:o}))),a(oe,null,a(ie,{variant:"contained",type:"submit",color:"primary",disabled:o,className:m.button},o&&a(ce,{className:m.icon,size:18,thickness:2}),u("auth.action.signup"))))}})};Vt.propTypes={redirectTo:Nt.string};var Dt=F((function(e){return{main:{display:"flex",flexDirection:"column",minHeight:"100vh",height:"1px",alignItems:"center",justifyContent:"flex-start",backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundImage:"radial-gradient(circle at 50% 14em, #313264 0%, #00023b 60%, #00023b 100%)"},card:{minWidth:300,marginTop:"6em"},avatar:{margin:"1em",display:"flex",justifyContent:"center"},icon:{backgroundColor:e.palette.secondary[500]},switch:{margin:"1em",display:"flex",justifyContent:"center"}}})),Ft=function(t){var r=t.theme,n=(t.title,t.classes,t.className),a=Ue(t,["theme","title","classes","className"]),i=Dt(t),c=ge(),s=o((function(){return se(r)}),[r]),u=new URLSearchParams(c.search),l=u.has("signup"),m=u.get("redirect"),f=_(),d=f.identity;return f.loading?null:(null==d?void 0:d.id)?e.createElement(be,{to:m||"/"}):e.createElement(ue,{theme:s},e.createElement("div",Te({className:Ut(i.main,n)},a),e.createElement(ne,{className:i.card},e.createElement("div",{className:i.avatar},e.createElement(G,{className:i.icon},e.createElement(Ee,null))),l?e.createElement(Vt,{redirectTo:m,delayBeforeRedirect:3e3}):e.createElement(A,{redirectTo:m}),e.createElement("div",{className:i.switch},l?e.createElement(ye,{to:"/login"},e.createElement(ae,{variant:"body2"},"Se connecter avec un compte")):e.createElement(ye,{to:"/login?signup=true"},e.createElement(ae,{variant:"body2"},"Créer un nouveau compte")))),e.createElement(C,null)))};Ft.propTypes={children:Nt.node,classes:Nt.object,className:Nt.string,theme:Nt.object};var Mt=i((function(t,r){var n=I();return e.createElement(xe,{onClick:function(){return n()},ref:r},e.createElement(Pe,null),"   Se déconnecter")})),Bt=function(t){var r=t.name,n=t.create,a=Ue(t,["name","create"]),o=D(r),i=f(o).permissions;return e.createElement(T,Te({},a,{name:r,create:i&&i.some((function(e){return tt.includes(e["acl:mode"])}))?n:void 0}))},$t=i((function(t,r){var n=t.onClick,a=t.webId;return e.createElement(R,{ref:r,to:"/Person/".concat(encodeURIComponent(a),"/show"),primaryText:"Voir mon profil",leftIcon:e.createElement(Ce,null),onClick:n})})),qt=i((function(t,r){var n=t.onClick,a=t.webId;return e.createElement(R,{ref:r,to:"/Person/".concat(encodeURIComponent(a),"/edit"),primaryText:"Editer mon profil",leftIcon:e.createElement(fe,null),onClick:n})})),Gt=i((function(t,r){var n=t.onClick;return e.createElement(R,{ref:r,to:"/login",primaryText:"Se connecter",onClick:n})})),Ht=i((function(t,r){var n=t.onClick;return e.createElement(R,{ref:r,to:"/login?signup=true",primaryText:"Créer un compte",onClick:n})})),Jt=function(t){var r=t.logout,n=Ue(t,["logout"]),a=_().identity;return e.createElement(N,n,a&&""!==a.id?[e.createElement($t,{webId:a.id,key:"view"}),e.createElement(qt,{webId:a.id,key:"edit"}),e.cloneElement(r,{key:"logout"})]:[e.createElement(Ht,{key:"signup"}),e.createElement(Gt,{key:"login"})])};var Yt=function(){this.__data__=[],this.size=0};var Kt=function(e,t){return e===t||e!=e&&t!=t};var Qt=function(e,t){for(var r=e.length;r--;)if(Kt(e[r][0],t))return r;return-1},Xt=Array.prototype.splice;var Zt=function(e){var t=this.__data__,r=Qt(t,e);return!(r<0)&&(r==t.length-1?t.pop():Xt.call(t,r,1),--this.size,!0)};var er=function(e){var t=this.__data__,r=Qt(t,e);return r<0?void 0:t[r][1]};var tr=function(e){return Qt(this.__data__,e)>-1};var rr=function(e,t){var r=this.__data__,n=Qt(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function nr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}nr.prototype.clear=Yt,nr.prototype.delete=Zt,nr.prototype.get=er,nr.prototype.has=tr,nr.prototype.set=rr;var ar=nr;var or=function(){this.__data__=new ar,this.size=0};var ir=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r};var cr=function(e){return this.__data__.get(e)};var sr=function(e){return this.__data__.has(e)},ur="object"==typeof qe&&qe&&qe.Object===Object&&qe,lr="object"==typeof self&&self&&self.Object===Object&&self,mr=ur||lr||Function("return this")(),fr=mr.Symbol,dr=Object.prototype,pr=dr.hasOwnProperty,hr=dr.toString,vr=fr?fr.toStringTag:void 0;var gr=function(e){var t=pr.call(e,vr),r=e[vr];try{e[vr]=void 0;var n=!0}catch(e){}var a=hr.call(e);return n&&(t?e[vr]=r:delete e[vr]),a},br=Object.prototype.toString;var yr=function(e){return br.call(e)},wr=fr?fr.toStringTag:void 0;var _r=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":wr&&wr in Object(e)?gr(e):yr(e)};var jr=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};var Er,kr=function(e){if(!jr(e))return!1;var t=_r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},Or=mr["__core-js_shared__"],xr=(Er=/[^.]+$/.exec(Or&&Or.keys&&Or.keys.IE_PROTO||""))?"Symbol(src)_1."+Er:"";var Pr=function(e){return!!xr&&xr in e},Cr=Function.prototype.toString;var Sr=function(e){if(null!=e){try{return Cr.call(e)}catch(e){}try{return e+""}catch(e){}}return""},Ar=/^\[object .+?Constructor\]$/,Ir=Function.prototype,Tr=Object.prototype,Rr=Ir.toString,Nr=Tr.hasOwnProperty,Ur=RegExp("^"+Rr.call(Nr).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var zr=function(e){return!(!jr(e)||Pr(e))&&(kr(e)?Ur:Ar).test(Sr(e))};var Lr=function(e,t){return null==e?void 0:e[t]};var Wr=function(e,t){var r=Lr(e,t);return zr(r)?r:void 0},Vr=Wr(mr,"Map"),Dr=Wr(Object,"create");var Fr=function(){this.__data__=Dr?Dr(null):{},this.size=0};var Mr=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Br=Object.prototype.hasOwnProperty;var $r=function(e){var t=this.__data__;if(Dr){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return Br.call(t,e)?t[e]:void 0},qr=Object.prototype.hasOwnProperty;var Gr=function(e){var t=this.__data__;return Dr?void 0!==t[e]:qr.call(t,e)};var Hr=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Dr&&void 0===t?"__lodash_hash_undefined__":t,this};function Jr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Jr.prototype.clear=Fr,Jr.prototype.delete=Mr,Jr.prototype.get=$r,Jr.prototype.has=Gr,Jr.prototype.set=Hr;var Yr=Jr;var Kr=function(){this.size=0,this.__data__={hash:new Yr,map:new(Vr||ar),string:new Yr}};var Qr=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var Xr=function(e,t){var r=e.__data__;return Qr(t)?r["string"==typeof t?"string":"hash"]:r.map};var Zr=function(e){var t=Xr(this,e).delete(e);return this.size-=t?1:0,t};var en=function(e){return Xr(this,e).get(e)};var tn=function(e){return Xr(this,e).has(e)};var rn=function(e,t){var r=Xr(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function nn(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}nn.prototype.clear=Kr,nn.prototype.delete=Zr,nn.prototype.get=en,nn.prototype.has=tn,nn.prototype.set=rn;var an=nn;var on=function(e,t){var r=this.__data__;if(r instanceof ar){var n=r.__data__;if(!Vr||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new an(n)}return r.set(e,t),this.size=r.size,this};function cn(e){var t=this.__data__=new ar(e);this.size=t.size}cn.prototype.clear=or,cn.prototype.delete=ir,cn.prototype.get=cr,cn.prototype.has=sr,cn.prototype.set=on;var sn=cn;var un=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this};var ln=function(e){return this.__data__.has(e)};function mn(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new an;++t<r;)this.add(e[t])}mn.prototype.add=mn.prototype.push=un,mn.prototype.has=ln;var fn=mn;var dn=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1};var pn=function(e,t){return e.has(t)};var hn=function(e,t,r,n,a,o){var i=1&r,c=e.length,s=t.length;if(c!=s&&!(i&&s>c))return!1;var u=o.get(e);if(u&&o.get(t))return u==t;var l=-1,m=!0,f=2&r?new fn:void 0;for(o.set(e,t),o.set(t,e);++l<c;){var d=e[l],p=t[l];if(n)var h=i?n(p,d,l,t,e,o):n(d,p,l,e,t,o);if(void 0!==h){if(h)continue;m=!1;break}if(f){if(!dn(t,(function(e,t){if(!pn(f,t)&&(d===e||a(d,e,r,n,o)))return f.push(t)}))){m=!1;break}}else if(d!==p&&!a(d,p,r,n,o)){m=!1;break}}return o.delete(e),o.delete(t),m},vn=mr.Uint8Array;var gn=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r};var bn=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r},yn=fr?fr.prototype:void 0,wn=yn?yn.valueOf:void 0;var _n=function(e,t,r,n,a,o,i){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new vn(e),new vn(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Kt(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var c=gn;case"[object Set]":var s=1&n;if(c||(c=bn),e.size!=t.size&&!s)return!1;var u=i.get(e);if(u)return u==t;n|=2,i.set(e,t);var l=hn(c(e),c(t),n,a,o,i);return i.delete(e),l;case"[object Symbol]":if(wn)return wn.call(e)==wn.call(t)}return!1};var jn=function(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e},En=Array.isArray;var kn=function(e,t,r){var n=t(e);return En(e)?n:jn(n,r(e))};var On=function(e,t){for(var r=-1,n=null==e?0:e.length,a=0,o=[];++r<n;){var i=e[r];t(i,r,e)&&(o[a++]=i)}return o};var xn=function(){return[]},Pn=Object.prototype.propertyIsEnumerable,Cn=Object.getOwnPropertySymbols,Sn=Cn?function(e){return null==e?[]:(e=Object(e),On(Cn(e),(function(t){return Pn.call(e,t)})))}:xn;var An=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n};var In=function(e){return null!=e&&"object"==typeof e};var Tn=function(e){return In(e)&&"[object Arguments]"==_r(e)},Rn=Object.prototype,Nn=Rn.hasOwnProperty,Un=Rn.propertyIsEnumerable,zn=Tn(function(){return arguments}())?Tn:function(e){return In(e)&&Nn.call(e,"callee")&&!Un.call(e,"callee")};var Ln=function(){return!1},Wn=Ge((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,a=n&&n.exports===r?mr.Buffer:void 0,o=(a?a.isBuffer:void 0)||Ln;e.exports=o})),Vn=/^(?:0|[1-9]\d*)$/;var Dn=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&Vn.test(e))&&e>-1&&e%1==0&&e<t};var Fn=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},Mn={};Mn["[object Float32Array]"]=Mn["[object Float64Array]"]=Mn["[object Int8Array]"]=Mn["[object Int16Array]"]=Mn["[object Int32Array]"]=Mn["[object Uint8Array]"]=Mn["[object Uint8ClampedArray]"]=Mn["[object Uint16Array]"]=Mn["[object Uint32Array]"]=!0,Mn["[object Arguments]"]=Mn["[object Array]"]=Mn["[object ArrayBuffer]"]=Mn["[object Boolean]"]=Mn["[object DataView]"]=Mn["[object Date]"]=Mn["[object Error]"]=Mn["[object Function]"]=Mn["[object Map]"]=Mn["[object Number]"]=Mn["[object Object]"]=Mn["[object RegExp]"]=Mn["[object Set]"]=Mn["[object String]"]=Mn["[object WeakMap]"]=!1;var Bn=function(e){return In(e)&&Fn(e.length)&&!!Mn[_r(e)]};var $n=function(e){return function(t){return e(t)}},qn=Ge((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,a=n&&n.exports===r&&ur.process,o=function(){try{var e=n&&n.require&&n.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=o})),Gn=qn&&qn.isTypedArray,Hn=Gn?$n(Gn):Bn,Jn=Object.prototype.hasOwnProperty;var Yn=function(e,t){var r=En(e),n=!r&&zn(e),a=!r&&!n&&Wn(e),o=!r&&!n&&!a&&Hn(e),i=r||n||a||o,c=i?An(e.length,String):[],s=c.length;for(var u in e)!t&&!Jn.call(e,u)||i&&("length"==u||a&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Dn(u,s))||c.push(u);return c},Kn=Object.prototype;var Qn=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Kn)};var Xn=function(e,t){return function(r){return e(t(r))}}(Object.keys,Object),Zn=Object.prototype.hasOwnProperty;var ea=function(e){if(!Qn(e))return Xn(e);var t=[];for(var r in Object(e))Zn.call(e,r)&&"constructor"!=r&&t.push(r);return t};var ta=function(e){return null!=e&&Fn(e.length)&&!kr(e)};var ra=function(e){return ta(e)?Yn(e):ea(e)};var na=function(e){return kn(e,ra,Sn)},aa=Object.prototype.hasOwnProperty;var oa=function(e,t,r,n,a,o){var i=1&r,c=na(e),s=c.length;if(s!=na(t).length&&!i)return!1;for(var u=s;u--;){var l=c[u];if(!(i?l in t:aa.call(t,l)))return!1}var m=o.get(e);if(m&&o.get(t))return m==t;var f=!0;o.set(e,t),o.set(t,e);for(var d=i;++u<s;){var p=e[l=c[u]],h=t[l];if(n)var v=i?n(h,p,l,t,e,o):n(p,h,l,e,t,o);if(!(void 0===v?p===h||a(p,h,r,n,o):v)){f=!1;break}d||(d="constructor"==l)}if(f&&!d){var g=e.constructor,b=t.constructor;g==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof g&&g instanceof g&&"function"==typeof b&&b instanceof b||(f=!1)}return o.delete(e),o.delete(t),f},ia=Wr(mr,"DataView"),ca=Wr(mr,"Promise"),sa=Wr(mr,"Set"),ua=Wr(mr,"WeakMap"),la=Sr(ia),ma=Sr(Vr),fa=Sr(ca),da=Sr(sa),pa=Sr(ua),ha=_r;(ia&&"[object DataView]"!=ha(new ia(new ArrayBuffer(1)))||Vr&&"[object Map]"!=ha(new Vr)||ca&&"[object Promise]"!=ha(ca.resolve())||sa&&"[object Set]"!=ha(new sa)||ua&&"[object WeakMap]"!=ha(new ua))&&(ha=function(e){var t=_r(e),r="[object Object]"==t?e.constructor:void 0,n=r?Sr(r):"";if(n)switch(n){case la:return"[object DataView]";case ma:return"[object Map]";case fa:return"[object Promise]";case da:return"[object Set]";case pa:return"[object WeakMap]"}return t});var va=ha,ga=Object.prototype.hasOwnProperty;var ba=function(e,t,r,n,a,o){var i=En(e),c=En(t),s=i?"[object Array]":va(e),u=c?"[object Array]":va(t),l="[object Object]"==(s="[object Arguments]"==s?"[object Object]":s),m="[object Object]"==(u="[object Arguments]"==u?"[object Object]":u),f=s==u;if(f&&Wn(e)){if(!Wn(t))return!1;i=!0,l=!1}if(f&&!l)return o||(o=new sn),i||Hn(e)?hn(e,t,r,n,a,o):_n(e,t,s,r,n,a,o);if(!(1&r)){var d=l&&ga.call(e,"__wrapped__"),p=m&&ga.call(t,"__wrapped__");if(d||p){var h=d?e.value():e,v=p?t.value():t;return o||(o=new sn),a(h,v,r,n,o)}}return!!f&&(o||(o=new sn),oa(e,t,r,n,a,o))};var ya=function e(t,r,n,a,o){return t===r||(null==t||null==r||!In(t)&&!In(r)?t!=t&&r!=r:ba(t,r,n,a,e,o))};var wa=function(e,t){return ya(e,t)},_a={},ja={"{}":void 0},Ea=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_a,t=JSON.stringify(e),a=S({permissions:ja[t]}),o=ze(a,2),i=o[0],c=o[1],s=U(),u=n((function(){return s(e).then((function(e){wa(e,i.permissions)||(ja[t]=e,c({permissions:e}))})).catch((function(e){c({error:e})}))}),[t,e,s]);return r((function(){u()}),[t]),Ne(Ne({},i),{},{refetch:u})},ka={auth:{dialog:{container_permissions:"Permissions sur le container",resource_permissions:"Permissions sur la resource"},action:{permissions:"Permissions",signup:"S'inscrire"},right:{resource:{read:"Lire",append:"Enrichir",write:"Modifier",control:"Administrer"},container:{read:"Lister",append:"Ajouter",write:"Ajouter",control:"Administrer"}},agent:{anonymous:"Tous les utilisateurs",authenticated:"Utilisateurs connectés"},input:{agent_select:"Ajouter un utilisateur...",name:"Prénom",username:"Nom utilisateur",email:"Adresse e-mail"},message:{resource_show_forbidden:"Vous n'avez pas la permission de voir cette ressource",resource_edit_forbidden:"Vous n'avez pas la permission d'éditer cette ressource",resource_delete_forbidden:"Vous n'avez pas la permission d'effacer cette ressource",resource_control_forbidden:"Vous n'avez pas la permission d'administrer cette ressource",container_create_forbidden:"Vous n'avez pas la permission de créer des ressources",container_list_forbidden:"Vous n'avez pas la permission de voir ces ressources",user_not_allowed_to_login:"Vous n'avez pas le droit de vous connecter avec ce compte",user_email_not_found:"Aucun compte trouvé avec cette adresse mail",user_email_exist:"Un compte existe déjà avec cette adresse mail",new_user_created:"Votre compte a été créé avec succès",user_connected:"Vous êtes maintenant connecté",user_disconnected:"Vous êtes maintenant déconnecté",bad_request:"Requête erronée (Message d'erreur renvoyé par le serveur: %{error})"}}};export{_t as DeleteButtonWithPermissions,wt as EditActions,Et as EditToolbarWithPermissions,xt as EditWithPermissions,Pt as ListWithPermissions,Ft as LocalLoginPage,It as LoginPage,Mt as LogoutButton,yt as PermissionsButton,Bt as ResourceWithPermissions,Ct as ShowActions,St as ShowWithPermissions,It as SsoLoginPage,Jt as UserMenu,Ze as authProvider,ka as frenchMessages,vt as useAgents,kt as useCheckAuthenticated,Ot as useCheckPermissions,Ea as usePermissionsWithRefetch,zt as useSignup};
//# sourceMappingURL=index.es.js.map
