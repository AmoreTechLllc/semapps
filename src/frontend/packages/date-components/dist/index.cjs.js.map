{"version":3,"file":"index.cjs.js","sources":["../src/utils.js","../src/Picker.js","../src/useFullCalendarProps.js","../src/CalendarList.js","../src/DaysList.js","../src/index.js"],"sourcesContent":["const leftPad = (nb = 2) => value => ('0'.repeat(nb) + value).slice(-nb);\nconst leftPad4 = leftPad(4);\nconst leftPad2 = leftPad(2);\n\n// yyyy-MM-ddThh:mm\nconst dateTimeRegex = /^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}$/;\n\n/**\n * @param {Date} value value to convert\n * @returns {String} A standardized datetime (yyyy-MM-ddThh:mm), to be passed to an <input type=\"datetime-local\" />\n */\nconst convertDateToString = value => {\n  if (!(value instanceof Date) || isNaN(value.getDate())) {\n    return '';\n  }\n\n  const yy = leftPad4(value.getFullYear());\n  const MM = leftPad2(value.getMonth() + 1);\n  const dd = leftPad2(value.getDate());\n  const hh = leftPad2(value.getHours());\n  const mm = leftPad2(value.getMinutes());\n  return `${yy}-${MM}-${dd}T${hh}:${mm}`;\n};\n\n/**\n * Converts a date from the Redux store, with timezone, to a date string\n * without timezone for use in an <input type=\"datetime-local\" />.\n *\n * @param {Date | String} value date string or object\n */\nexport const dateTimeFormatter = value => {\n  // null, undefined and empty string values should not go through convertDateToString\n  // otherwise, it returns undefined and will make the input an uncontrolled one.\n  if (value == null || value === '') {\n    return '';\n  }\n\n  if (value instanceof Date) {\n    return convertDateToString(value);\n  }\n\n  // valid dates should not be converted\n  if (dateTimeRegex.test(value)) {\n    return value;\n  }\n\n  return convertDateToString(new Date(value));\n};\n\n/**\n * Converts a datetime string without timezone to a date object\n * with timezone, using the browser timezone.\n *\n * @param {String} value Date string, formatted as yyyy-MM-ddThh:mm\n * @return {Date}\n */\nexport const dateTimeParser = value => (value ? new Date(value) : '');\n","import React, { useCallback } from 'react';\nimport { useInput, useTranslate, FieldTitle, InputHelperText } from 'react-admin';\nimport { IconButton } from '@mui/material';\nimport LocalizationProvider from '@mui/lab/LocalizationProvider';\nimport DateFnsUtils from '@date-io/date-fns';\nimport { dateTimeFormatter, dateTimeParser } from './utils';\nimport ClearIcon from '@mui/icons-material/Clear';\n\nconst sanitizeRestProps = ({\n  allowEmpty,\n  alwaysOn,\n  basePath,\n  component,\n  defaultValue,\n  format,\n  formClassName,\n  initialValue,\n  initializeForm,\n  input,\n  isRequired,\n  label,\n  limitChoicesToValue,\n  locale,\n  meta,\n  options,\n  optionText,\n  optionValue,\n  parse,\n  record,\n  resource,\n  source,\n  textAlign,\n  translate,\n  translateChoice,\n  labelTime,\n  ...rest\n}) => rest;\n\nconst Picker = ({\n  PickerComponent,\n  format = dateTimeFormatter,\n  label,\n  options,\n  source,\n  resource,\n  helperText,\n  margin = 'dense',\n  onBlur,\n  onChange,\n  onFocus,\n  parse = dateTimeParser,\n  validate,\n  variant = 'filled',\n  defaultValue,\n  providerOptions: { utils, locale },\n  pickerVariant = 'dialog',\n  stringFormat = 'ISO',\n  allowClear,\n  ...rest\n}) => {\n  const translate = useTranslate();\n  const {\n    id,\n    input,\n    isRequired,\n    meta: { error, touched }\n  } = useInput({\n    format,\n    onBlur,\n    onChange,\n    onFocus,\n    parse,\n    resource,\n    source,\n    validate,\n    /* type: 'datetime-local', */\n    ...rest\n  });\n\n  const handleChange = useCallback(value => {\n    Date.parse(value)\n      ? input.onChange(stringFormat === 'ISO' ? value.toISOString() : value.toString())\n      : input.onChange(null);\n  }, []);\n\n  const handleClear = useCallback(e => {\n    e.stopPropagation();\n    input.onChange(null);\n  }, []);\n\n  return (\n    <LocalizationProvider utils={utils || DateFnsUtils} locale={locale}>\n      <PickerComponent\n        id={id}\n        InputLabelProps={{\n          shrink: true\n        }}\n        InputProps={{\n          endAdornment: allowClear ? (\n            <IconButton onClick={handleClear} size=\"large\">\n              <ClearIcon />\n            </IconButton>\n          ) : (\n            undefined\n          )\n        }}\n        label={<FieldTitle label={label} source={source} resource={resource} isRequired={isRequired} />}\n        variant={pickerVariant}\n        inputVariant={variant}\n        margin={margin}\n        error={!!(touched && error)}\n        helperText={<InputHelperText touched={touched} error={error} helperText={helperText} />}\n        clearLabel={translate('ra.action.clear_input_value')}\n        cancelLabel={translate('ra.action.cancel')}\n        {...options}\n        {...sanitizeRestProps(rest)}\n        value={input.value ? new Date(input.value) : null}\n        onChange={handleChange}\n        onBlur={() =>\n          input.onBlur(\n            input.value\n              ? stringFormat === 'ISO'\n                ? new Date(input.value).toISOString()\n                : new Date(input.value).toString()\n              : null\n          )\n        }\n      />\n    </LocalizationProvider>\n  );\n};\n\nPicker.defaultProps = {\n  isRequired: false,\n  meta: { touched: false, error: false },\n  options: {},\n  providerOptions: {\n    utils: DateFnsUtils,\n    locale: undefined\n  },\n  // Avoid saving an empty string in the dataset\n  parse: value => (value === '' ? null : value)\n};\n\nexport default Picker;\n","import React, { useMemo, useCallback } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useListContext, linkToRecord } from 'react-admin';\n\nconst useFullCalendarProps = ({ label, startDate, endDate, linkType }) => {\n  const navigate = useNavigate();\n  const { ids, data, basePath } = useListContext();\n\n  let query = new URLSearchParams(navigate.location.search);\n\n  // Bypass the link in order to use React-Router\n  const eventClick = useCallback(({ event, jsEvent }) => {\n    jsEvent.preventDefault();\n    navigate.push(event.url);\n  }, []);\n\n  // Change the query string when month change\n  const datesSet = useCallback(\n    ({ view }) => {\n      query.set('month', view.currentStart.getMonth() + 1);\n      query.set('year', view.currentStart.getFullYear());\n      navigate.replace({ pathname: navigate.location.pathname, search: '?' + query.toString() });\n    },\n    [query]\n  );\n\n  const events = useMemo(\n    () =>\n      ids\n        .filter(id => data[id])\n        .map(id => ({\n          id,\n          title: typeof label === 'string' ? data[id][label] : label(data[id]),\n          start: typeof startDate === 'string' ? data[id][startDate] : startDate(data[id]),\n          end: typeof endDate === 'string' ? data[id][endDate] : endDate(data[id]),\n          url: linkToRecord(basePath, id) + '/' + linkType\n        })),\n    [data, ids, basePath]\n  );\n\n  return {\n    initialDate: query.has('month') ? new Date(query.get('year'), query.get('month') - 1) : new Date(),\n    events,\n    datesSet,\n    eventClick\n  };\n};\n\nexport default useFullCalendarProps;\n","import React from 'react';\nimport FullCalendar from '@fullcalendar/react';\nimport dayGridPlugin from '@fullcalendar/daygrid';\nimport { useTheme } from '@mui/material';\nimport makeStyles from '@mui/styles/makeStyles';\nimport useFullCalendarProps from './useFullCalendarProps';\n\nconst useGlobalStyles = makeStyles(theme => ({\n  '@global': {\n    '.fc-button': {\n      backgroundColor: theme.palette.primary.main + ' !important',\n      border: 'none !important',\n      opacity: '1 !important'\n    },\n    '.fc-day-today': {\n      backgroundColor: theme.palette.secondary.light + ' !important'\n    },\n    // Overwrite violet color of links\n    'a.fc-daygrid-dot-event': {\n      color: 'black !important'\n    }\n  }\n}));\n\nconst CalendarList = props => {\n  const theme = useTheme();\n  const fullCalendarProps = useFullCalendarProps(props);\n  useGlobalStyles();\n\n  return (\n    <FullCalendar\n      plugins={[dayGridPlugin]}\n      locale={props.locale}\n      initialView=\"dayGridMonth\"\n      eventBackgroundColor={theme.palette.primary.main}\n      {...fullCalendarProps}\n    />\n  );\n};\n\nCalendarList.defaultProps = {\n  linkType: 'edit'\n};\n\nexport default CalendarList;\n","import React from 'react';\nimport FullCalendar from '@fullcalendar/react';\nimport listPlugin from '@fullcalendar/list';\nimport makeStyles from '@mui/styles/makeStyles';\nimport useFullCalendarProps from './useFullCalendarProps';\n\nconst useGlobalStyles = makeStyles(theme => ({\n  '@global': {\n    '.fc-button': {\n      backgroundColor: theme.palette.primary.main + ' !important',\n      border: 'none !important',\n      opacity: '1 !important'\n    }\n  }\n}));\n\nconst DaysList = props => {\n  const fullCalendarProps = useFullCalendarProps(props);\n  useGlobalStyles();\n\n  return <FullCalendar plugins={[listPlugin]} locale={props.locale} initialView=\"listMonth\" {...fullCalendarProps} />;\n};\n\nDaysList.defaultProps = {\n  linkType: 'edit'\n};\n\nexport default DaysList;\n","import React from 'react';\nimport Picker from './Picker';\nimport { \n  DatePicker,\n  DateTimePicker,\n  TimePicker\n } from '@mui/lab';\n\nconst DateInput = props => <Picker PickerComponent={DatePicker} {...props} />;\nconst TimeInput = props => <Picker PickerComponent={TimePicker} {...props} />;\nconst DateTimeInput = props => <Picker PickerComponent={DateTimePicker} {...props} />;\nconst KeyboardDateInput = props => <Picker PickerComponent={DatePicker} {...props} />;\nconst KeyboardDateTimeInput = props => <Picker PickerComponent={DateTimePicker} {...props} />;\nconst KeyboardTimeInput = props => <Picker PickerComponent={TimePicker} {...props} />;\n\nexport { DateInput, TimeInput, DateTimeInput, KeyboardDateInput, KeyboardDateTimeInput, KeyboardTimeInput };\n\nexport { default as CalendarList } from './CalendarList';\nexport { default as DaysList } from './DaysList';\nexport { default as useFullCalendarProps } from './useFullCalendarProps';\n"],"names":["leftPad","nb","value","repeat","slice","leftPad4","leftPad2","dateTimeRegex","convertDateToString","Date","isNaN","getDate","yy","getFullYear","MM","getMonth","dd","hh","getHours","mm","getMinutes","concat","dateTimeFormatter","test","dateTimeParser","Picker","_ref2","PickerComponent","_ref2$format","format","label","options","source","resource","helperText","_ref2$margin","margin","onBlur","onChange","onFocus","_ref2$parse","parse","validate","_ref2$variant","variant","defaultValue","_ref","_ref2$providerOptions","providerOptions","utils","locale","_ref2$pickerVariant","pickerVariant","_ref2$stringFormat","stringFormat","allowClear","rest","_objectWithoutProperties","_excluded2","translate","useTranslate","_useInput","useInput","_objectSpread","id","input","isRequired","_useInput$meta","meta","error","touched","handleChange","useCallback","toISOString","toString","handleClear","e","stopPropagation","React","LocalizationProvider","DateFnsUtils","_extends","InputLabelProps","shrink","InputProps","endAdornment","createElement","IconButton","onClick","size","ClearIcon","undefined","FieldTitle","inputVariant","InputHelperText","clearLabel","cancelLabel","allowEmpty","alwaysOn","basePath","component","formClassName","initialValue","initializeForm","limitChoicesToValue","optionText","optionValue","record","textAlign","translateChoice","labelTime","_excluded","defaultProps","useFullCalendarProps","startDate","endDate","linkType","navigate","useNavigate","_useListContext","useListContext","ids","data","query","URLSearchParams","location","search","eventClick","event","jsEvent","preventDefault","push","url","datesSet","_ref3","view","set","currentStart","replace","pathname","events","useMemo","filter","map","title","start","end","linkToRecord","initialDate","has","get","useGlobalStyles","makeStyles","theme","@global",".fc-button","backgroundColor","palette","primary","main","border","opacity",".fc-day-today","secondary","light","a.fc-daygrid-dot-event","color","CalendarList","props","useTheme","fullCalendarProps","FullCalendar","plugins","dayGridPlugin","initialView","eventBackgroundColor","DaysList","listPlugin","DatePicker","DateTimePicker","TimePicker"],"mappings":"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"}